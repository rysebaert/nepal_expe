<!DOCTYPE html>
<html xmlns="http://www.w3.org/1999/xhtml" lang="en" xml:lang="en"><head>

<meta charset="utf-8">
<meta name="generator" content="quarto-1.5.56">

<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=yes">


<title>View data â€“ Nepal expeditions</title>
<style>
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
div.columns{display: flex; gap: min(4vw, 1.5em);}
div.column{flex: auto; overflow-x: auto;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
ul.task-list li input[type="checkbox"] {
  width: 0.8em;
  margin: 0 0.8em 0.2em -1em; /* quarto-specific, see https://github.com/quarto-dev/quarto-cli/issues/4556 */ 
  vertical-align: middle;
}
/* CSS for syntax highlighting */
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { display: inline-block; text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
  { counter-reset: source-line 0; }
pre.numberSource code > span
  { position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
  { content: counter(source-line);
    position: relative; left: -1em; text-align: right; vertical-align: baseline;
    border: none; display: inline-block;
    -webkit-touch-callout: none; -webkit-user-select: none;
    -khtml-user-select: none; -moz-user-select: none;
    -ms-user-select: none; user-select: none;
    padding: 0 4px; width: 4em;
  }
pre.numberSource { margin-left: 3em;  padding-left: 4px; }
div.sourceCode
  {   }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
</style>


<script src="site_libs/quarto-nav/quarto-nav.js"></script>
<script src="site_libs/quarto-nav/headroom.min.js"></script>
<script src="site_libs/clipboard/clipboard.min.js"></script>
<script src="site_libs/quarto-search/autocomplete.umd.js"></script>
<script src="site_libs/quarto-search/fuse.min.js"></script>
<script src="site_libs/quarto-search/quarto-search.js"></script>
<meta name="quarto:offset" content="./">
<script src="site_libs/quarto-html/quarto.js"></script>
<script src="site_libs/quarto-html/popper.min.js"></script>
<script src="site_libs/quarto-html/tippy.umd.min.js"></script>
<script src="site_libs/quarto-html/anchor.min.js"></script>
<link href="site_libs/quarto-html/tippy.css" rel="stylesheet">
<link href="site_libs/quarto-html/quarto-syntax-highlighting.css" rel="stylesheet" id="quarto-text-highlighting-styles">
<script src="site_libs/bootstrap/bootstrap.min.js"></script>
<link href="site_libs/bootstrap/bootstrap-icons.css" rel="stylesheet">
<link href="site_libs/bootstrap/bootstrap.min.css" rel="stylesheet" id="quarto-bootstrap" data-mode="light">
<script src="site_libs/quarto-dashboard/quarto-dashboard.js"></script>
<script src="site_libs/quarto-dashboard/stickythead.js"></script>
<script src="site_libs/quarto-dashboard/datatables.min.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/pdfmake.min.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/vfs_fonts.js" kdttablesentinel="true"></script>
<script src="site_libs/quarto-dashboard/web-components.js" type="module"></script>
<script src="site_libs/quarto-dashboard/components.js"></script>
<link href="site_libs/quarto-dashboard/datatables.min.css" rel="stylesheet" kdttablesentinel="true">
<script id="quarto-search-options" type="application/json">{
  "location": "navbar",
  "copy-button": false,
  "collapse-after": 3,
  "panel-placement": "end",
  "type": "overlay",
  "limit": 50,
  "keyboard-shortcut": [
    "f",
    "/",
    "s"
  ],
  "show-item-context": false,
  "language": {
    "search-no-results-text": "No results",
    "search-matching-documents-text": "matching documents",
    "search-copy-link-title": "Copy link to search",
    "search-hide-matches-text": "Hide additional matches",
    "search-more-match-text": "more match in this document",
    "search-more-matches-text": "more matches in this document",
    "search-clear-button-title": "Clear",
    "search-text-placeholder": "",
    "search-detached-cancel-button-title": "Cancel",
    "search-submit-button-title": "Submit",
    "search-label": "Search"
  }
}</script>
<script type="module" src="site_libs/quarto-ojs/quarto-ojs-runtime.js"></script>
<link href="site_libs/quarto-ojs/quarto-ojs.css" rel="stylesheet">


</head>

<body class="quarto-dashboard nav-fixed dashboard-fill fullcontent">


<div id="quarto-search-results"></div>
  <header id="quarto-header" class="headroom fixed-top">
    <nav class="navbar navbar-expand-lg " data-bs-theme="dark">
      <div class="navbar-container container-fluid">
      <div class="navbar-brand-container mx-auto">
    <a class="navbar-brand" href="./index.html">
    <span class="navbar-title">Nepal expeditions</span>
    </a>
  </div>
            <div id="quarto-search" class="" title="Search"></div>
          <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#navbarCollapse" aria-controls="navbarCollapse" role="menu" aria-expanded="false" aria-label="Toggle navigation" onclick="if (window.quartoToggleHeadroom) { window.quartoToggleHeadroom(); }">
  <span class="navbar-toggler-icon"></span>
</button>
          <div class="collapse navbar-collapse" id="navbarCollapse">
            <ul class="navbar-nav navbar-nav-scroll me-auto">
  <li class="nav-item">
    <a class="nav-link" href="./index.html"> 
<span class="menu-text">Home</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link active" href="./dashboard.html" aria-current="page"> 
<span class="menu-text">View data</span></a>
  </li>  
  <li class="nav-item">
    <a class="nav-link" href="./about.html"> 
<span class="menu-text">About</span></a>
  </li>  
</ul>
          </div> <!-- /navcollapse -->
            <div class="quarto-navbar-tools">
</div>
      </div> <!-- /container-fluid -->
    </nav>
<header id="quarto-dashboard-header">
<nav class="navbar navbar-expand-md slim" data-bs-theme="dark">
  <div class="navbar-container container-fluid">
    <button class="navbar-toggler" type="button" data-bs-toggle="collapse" data-bs-target="#dashboard-collapse" aria-controls="dashboard-collapse" aria-expanded="false" aria-label="Toggle navigation">
      <span class="navbar-toggler-icon"></span>
    </button>    


    <div class="navbar-brand-container">       

      <div class="navbar-title">
        <div class="navbar-title-text"><a href="#">View data</a></div>
        
        
      </div>
    </div>
<div id="dashboard-collapse" class="navbar-collapse collapse"><ul class="navbar-nav navbar-nav-scroll me-auto" role="tablist"><li class="nav-item" role="presentation"><a id="tab-by-peaks" class="nav-link active" data-bs-toggle="tab" role="tab" data-bs-target="#by-peaks" data-scrolling="false" href="#by-peaks" aria-controls="by-peaks" aria-selected="true"><span class="nav-link-text">By peaks</span></a></li><li class="nav-item" role="presentation"><a id="tab-peaks-table" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#peaks-table" data-scrolling="false" href="#peaks-table" aria-controls="peaks-table" aria-selected="false"><span class="nav-link-text">Peaks table</span></a></li><li class="nav-item" role="presentation"><a id="tab-by-country" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#by-country" data-scrolling="false" href="#by-country" aria-controls="by-country" aria-selected="false"><span class="nav-link-text">By country</span></a></li><li class="nav-item" role="presentation"><a id="tab-country-table" class="nav-link" data-bs-toggle="tab" role="tab" data-bs-target="#country-table" data-scrolling="true" href="#country-table" aria-controls="country-table" aria-selected="false"><span class="nav-link-text">Country table</span></a></li></ul></div></div>
</nav>
</header></header>
<!-- content -->
<div id="quarto-content" class="quarto-container page-layout-custom page-navbar quarto-dashboard-content bslib-gap-spacing html-fill-container bslib-page-fill quarto-dashboard-pages">
<!-- sidebar -->
<!-- margin-sidebar -->
<!-- main -->

<div class="bslib-grid-item html-fill-item tab-content bslib-grid" data-layout="fill" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div id="by-peaks" class="dashboard-page tab-pane show active html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-by-peaks">
<div class="html-fill-item html-fill-container dashboard-toolbar-container"><div class="toolbar html-fill-container" data-layout="flow">
<div class="sourceCode cell-code hidden" id="cb1" data-startfrom="11" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 10;"><span id="cb1-11"><a href="#cb1-11" aria-hidden="true" tabindex="-1"></a>viewof prop_ind <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(<span class="kw">new</span> <span class="bu">Map</span>(metadata<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"stock"</span>)<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">description</span><span class="op">,</span> d<span class="op">.</span><span class="at">id</span>]))<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">"Indicator 1 : Circles"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"pos"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-1" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb2" data-startfrom="16" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 15;"><span id="cb2-16"><a href="#cb2-16" aria-hidden="true" tabindex="-1"></a>viewof choro_ind <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(<span class="kw">new</span> <span class="bu">Map</span>(metadata<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"ratio"</span>)<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">description</span><span class="op">,</span> d<span class="op">.</span><span class="at">id</span>]))<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">"Indicator 2: Color palette"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"HEIGHTM"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-2" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb3" data-startfrom="21" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 20;"><span id="cb3-21"><a href="#cb3-21" aria-hidden="true" tabindex="-1"></a>viewof tiles <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>([<span class="st">"worldStreet"</span><span class="op">,</span> <span class="st">"openstreetmap"</span><span class="op">,</span> <span class="st">"worldimagery"</span><span class="op">,</span> <span class="st">"opentopomap"</span>]<span class="op">,</span> {</span>
<span id="cb3-22"><a href="#cb3-22" aria-hidden="true" tabindex="-1"></a>  <span class="dt">label</span><span class="op">:</span> <span class="st">"Tiles"</span><span class="op">,</span></span>
<span id="cb3-23"><a href="#cb3-23" aria-hidden="true" tabindex="-1"></a>  <span class="dt">value</span><span class="op">:</span> <span class="st">"worldimagery"</span></span>
<span id="cb3-24"><a href="#cb3-24" aria-hidden="true" tabindex="-1"></a>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-3" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb4" data-startfrom="29" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 28;"><span id="cb4-29"><a href="#cb4-29" aria-hidden="true" tabindex="-1"></a>viewof k <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">4</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Circle size"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span><span class="dv">30</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-4" data-nodetype="declaration">

</div>
</div>
</div><div class="toolbar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" data-width="200%" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<center><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb5" data-startfrom="39" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 38;"><span id="cb5-39"><a href="#cb5-39" aria-hidden="true" tabindex="-1"></a>svg <span class="op">=</span> viz<span class="op">.</span><span class="fu">create</span>({</span>
<span id="cb5-40"><a href="#cb5-40" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">800</span><span class="op">,</span> </span>
<span id="cb5-41"><a href="#cb5-41" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> peaks<span class="op">,</span> </span>
<span id="cb5-42"><a href="#cb5-42" aria-hidden="true" tabindex="-1"></a>    <span class="dt">margin</span><span class="op">:</span> <span class="dv">150</span><span class="op">,</span></span>
<span id="cb5-43"><a href="#cb5-43" aria-hidden="true" tabindex="-1"></a>    <span class="dt">projection</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">geoMercator</span>()<span class="op">,</span></span>
<span id="cb5-44"><a href="#cb5-44" aria-hidden="true" tabindex="-1"></a>    <span class="dt">zoomable</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb5-45"><a href="#cb5-45" aria-hidden="true" tabindex="-1"></a>tile <span class="op">=</span> svg<span class="op">.</span><span class="fu">tile</span>({<span class="dt">url</span><span class="op">:</span> tiles<span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">"tile"</span> })</span>
<span id="cb5-46"><a href="#cb5-46" aria-hidden="true" tabindex="-1"></a>symb <span class="op">=</span> svg<span class="op">.</span><span class="fu">plot</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"propchoro"</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">"symb"</span><span class="op">,</span></span>
<span id="cb5-47"><a href="#cb5-47" aria-hidden="true" tabindex="-1"></a>            <span class="dt">data</span><span class="op">:</span> peaks<span class="op">,</span></span>
<span id="cb5-48"><a href="#cb5-48" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var1</span><span class="op">:</span> prop_ind<span class="op">,</span></span>
<span id="cb5-49"><a href="#cb5-49" aria-hidden="true" tabindex="-1"></a>            <span class="dt">var2</span><span class="op">:</span> choro_ind<span class="op">,</span></span>
<span id="cb5-50"><a href="#cb5-50" aria-hidden="true" tabindex="-1"></a>            <span class="dt">breaks</span><span class="op">:</span> bks<span class="op">,</span></span>
<span id="cb5-51"><a href="#cb5-51" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fixmax</span><span class="op">:</span> valmax<span class="op">,</span></span>
<span id="cb5-52"><a href="#cb5-52" aria-hidden="true" tabindex="-1"></a>            <span class="dt">colors</span><span class="op">:</span> <span class="st">"Sunset"</span><span class="op">,</span></span>
<span id="cb5-53"><a href="#cb5-53" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tip</span><span class="op">:</span> <span class="vs">`$PKCONSO`</span><span class="op">,</span></span>
<span id="cb5-54"><a href="#cb5-54" aria-hidden="true" tabindex="-1"></a>            k<span class="op">,</span></span>
<span id="cb5-55"><a href="#cb5-55" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg1_title</span><span class="op">:</span> <span class="st">"Indicator 1"</span><span class="op">,</span></span>
<span id="cb5-56"><a href="#cb5-56" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg1_frame</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-57"><a href="#cb5-57" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg1_frame_fill</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-58"><a href="#cb5-58" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg1_frame_stroke</span><span class="op">:</span> <span class="st">"#ffffff50"</span><span class="op">,</span></span>
<span id="cb5-59"><a href="#cb5-59" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg2_title</span><span class="op">:</span> <span class="st">"Indicator 2"</span><span class="op">,</span></span>
<span id="cb5-60"><a href="#cb5-60" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg2_frame</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb5-61"><a href="#cb5-61" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg2_frame_fill</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb5-62"><a href="#cb5-62" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg2_frame_stroke</span><span class="op">:</span> <span class="st">"#ffffff50"</span>})<span class="op">;</span></span>
<span id="cb5-63"><a href="#cb5-63" aria-hidden="true" tabindex="-1"></a>scale <span class="op">=</span> svg<span class="op">.</span><span class="fu">scalebar</span>({<span class="dt">id</span><span class="op">:</span> <span class="st">"scale"</span>})<span class="op">;</span></span>
<span id="cb5-64"><a href="#cb5-64" aria-hidden="true" tabindex="-1"></a>svg<span class="op">.</span><span class="fu">render</span>({<span class="dt">order</span><span class="op">:</span> [tile<span class="op">,</span> symb<span class="op">,</span> scale]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-5-5" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div></center>
</div>
</div>
</div></div>
</div>
<div id="peaks-table" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-peaks-table">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb6" data-startfrom="71" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 70;"><span id="cb6-71"><a href="#cb6-71" aria-hidden="true" tabindex="-1"></a><span class="co">// fig-height: 10</span></span>
<span id="cb6-72"><a href="#cb6-72" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb6-73"><a href="#cb6-73" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb6-74"><a href="#cb6-74" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"10pt"</span>)</span>
<span id="cb6-75"><a href="#cb6-75" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> <span class="dv">800</span>])<span class="op">;</span></span>
<span id="cb6-76"><a href="#cb6-76" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-77"><a href="#cb6-77" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="fu">append</span>(svg<span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb6-78"><a href="#cb6-78" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb6-79"><a href="#cb6-79" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">SVGTable</span>(svg)</span>
<span id="cb6-80"><a href="#cb6-80" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">size</span>([width<span class="op">,</span> <span class="dv">800</span>])</span>
<span id="cb6-81"><a href="#cb6-81" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fixedRows</span>(<span class="dv">0</span>)</span>
<span id="cb6-82"><a href="#cb6-82" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rowsPerPage</span>(<span class="dv">75</span>)</span>
<span id="cb6-83"><a href="#cb6-83" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fixedColumns</span>(<span class="dv">1</span>)</span>
<span id="cb6-84"><a href="#cb6-84" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">defaultNumberFormat</span>(<span class="st">",.1d"</span>)</span>
<span id="cb6-85"><a href="#cb6-85" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>({ <span class="dt">border</span><span class="op">:</span> <span class="kw">false</span> })</span>
<span id="cb6-86"><a href="#cb6-86" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data_peaks)  </span>
<span id="cb6-87"><a href="#cb6-87" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">onhighlight</span>(context <span class="kw">=&gt;</span> { <span class="co">/* do something */</span> })</span>
<span id="cb6-88"><a href="#cb6-88" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">render</span>()<span class="op">;</span>    </span>
<span id="cb6-89"><a href="#cb6-89" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb6-90"><a href="#cb6-90" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb6-91"><a href="#cb6-91" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb6-92"><a href="#cb6-92" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
</div>
</div>
<div id="by-country" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-orientation="rows" aria-labelledby="tab-by-country">
<div class="html-fill-item html-fill-container dashboard-toolbar-container"><div class="toolbar html-fill-container" data-layout="flow">
<div class="sourceCode cell-code hidden" id="cb7" data-startfrom="101" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 100;"><span id="cb7-101"><a href="#cb7-101" aria-hidden="true" tabindex="-1"></a>viewof prop_ind2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(<span class="kw">new</span> <span class="bu">Map</span>(metadata_world<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"stock"</span>)<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">description</span><span class="op">,</span> d<span class="op">.</span><span class="at">id</span>]))<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">"Indicator 1 : Circles"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"TOT_ALL"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-7" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb8" data-startfrom="106" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 105;"><span id="cb8-106"><a href="#cb8-106" aria-hidden="true" tabindex="-1"></a>viewof choro_ind2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">select</span>(<span class="kw">new</span> <span class="bu">Map</span>(metadata_world<span class="op">.</span><span class="fu">filter</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">type</span> <span class="op">==</span> <span class="st">"ratio"</span>)<span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> [d<span class="op">.</span><span class="at">description</span><span class="op">,</span> d<span class="op">.</span><span class="at">id</span>]))<span class="op">,</span> {<span class="dt">label</span><span class="op">:</span><span class="st">"Indicator 2: Color palette"</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span> <span class="st">"RT_POP"</span>})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-8" data-nodetype="declaration">

</div>
</div>
<div class="sourceCode cell-code hidden" id="cb9" data-startfrom="111" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 110;"><span id="cb9-111"><a href="#cb9-111" aria-hidden="true" tabindex="-1"></a>viewof k2 <span class="op">=</span> Inputs<span class="op">.</span><span class="fu">range</span>([<span class="dv">4</span><span class="op">,</span> <span class="dv">50</span>]<span class="op">,</span> { <span class="dt">label</span><span class="op">:</span> <span class="st">"Circle size"</span><span class="op">,</span> <span class="dt">step</span><span class="op">:</span> <span class="dv">1</span><span class="op">,</span> <span class="dt">value</span><span class="op">:</span><span class="dv">30</span> })</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display">
<div id="ojs-cell-9" data-nodetype="declaration">

</div>
</div>
</div><div class="toolbar-content html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="html-fill-item html-fill-container bslib-grid" data-width="100%" style="display: grid; grid-template-columns: minmax(3em, 1fr);
grid-auto-rows: minmax(0, 1fr);">
<center><div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb10" data-startfrom="121" data-source-offset="-0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 120;"><span id="cb10-121"><a href="#cb10-121" aria-hidden="true" tabindex="-1"></a>svg2 <span class="op">=</span> viz<span class="op">.</span><span class="fu">create</span>({</span>
<span id="cb10-122"><a href="#cb10-122" aria-hidden="true" tabindex="-1"></a>    <span class="dt">width</span><span class="op">:</span> <span class="dv">900</span><span class="op">,</span> </span>
<span id="cb10-123"><a href="#cb10-123" aria-hidden="true" tabindex="-1"></a>    <span class="dt">domain</span><span class="op">:</span> world<span class="op">,</span> </span>
<span id="cb10-124"><a href="#cb10-124" aria-hidden="true" tabindex="-1"></a>    <span class="dt">margin</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span></span>
<span id="cb10-125"><a href="#cb10-125" aria-hidden="true" tabindex="-1"></a>    <span class="dt">projection</span><span class="op">:</span> d3<span class="op">.</span><span class="fu">geoNaturalEarth1</span>()<span class="op">,</span></span>
<span id="cb10-126"><a href="#cb10-126" aria-hidden="true" tabindex="-1"></a>    <span class="dt">zoomable</span><span class="op">:</span> <span class="kw">true</span>})</span>
<span id="cb10-127"><a href="#cb10-127" aria-hidden="true" tabindex="-1"></a>outline <span class="op">=</span> svg2<span class="op">.</span><span class="fu">outline</span>({<span class="dt">id</span><span class="op">:</span><span class="st">"outline"</span>})<span class="op">;</span></span>
<span id="cb10-128"><a href="#cb10-128" aria-hidden="true" tabindex="-1"></a>countries <span class="op">=</span> svg2<span class="op">.</span><span class="fu">path</span>({ <span class="dt">datum</span><span class="op">:</span> world<span class="op">,</span> <span class="dt">fill</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span> <span class="dt">fillOpacity</span><span class="op">:</span> <span class="fl">0.3</span><span class="op">,</span> <span class="dt">id</span><span class="op">:</span> <span class="st">"countries"</span> })<span class="op">;</span></span>
<span id="cb10-129"><a href="#cb10-129" aria-hidden="true" tabindex="-1"></a>choro <span class="op">=</span> svg2<span class="op">.</span><span class="fu">plot</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"choro"</span><span class="op">,</span> </span>
<span id="cb10-130"><a href="#cb10-130" aria-hidden="true" tabindex="-1"></a>             <span class="dt">id</span><span class="op">:</span><span class="st">"choro"</span><span class="op">,</span></span>
<span id="cb10-131"><a href="#cb10-131" aria-hidden="true" tabindex="-1"></a>            <span class="dt">data</span><span class="op">:</span> world<span class="op">,</span></span>
<span id="cb10-132"><a href="#cb10-132" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span><span class="op">:</span> choro_ind2<span class="op">,</span></span>
<span id="cb10-133"><a href="#cb10-133" aria-hidden="true" tabindex="-1"></a>            <span class="dt">colors</span><span class="op">:</span> <span class="st">"Sunset"</span><span class="op">,</span></span>
<span id="cb10-134"><a href="#cb10-134" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tip</span><span class="op">:</span> <span class="vs">`$NAMEen`</span><span class="op">,</span></span>
<span id="cb10-135"><a href="#cb10-135" aria-hidden="true" tabindex="-1"></a>            <span class="dt">breaks</span><span class="op">:</span> bks2<span class="op">,</span></span>
<span id="cb10-136"><a href="#cb10-136" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_pos</span><span class="op">:</span> [<span class="dv">0</span><span class="op">,</span><span class="dv">250</span>]<span class="op">,</span></span>
<span id="cb10-137"><a href="#cb10-137" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Indicator 2"</span><span class="op">,</span></span>
<span id="cb10-138"><a href="#cb10-138" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_frame</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb10-139"><a href="#cb10-139" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_missing_text</span><span class="op">:</span> <span class="st">"No ascent"</span><span class="op">,</span></span>
<span id="cb10-140"><a href="#cb10-140" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_frame_fill</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb10-141"><a href="#cb10-141" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_frame_stroke</span><span class="op">:</span> <span class="st">"#ffffff50"</span>})<span class="op">;</span></span>
<span id="cb10-142"><a href="#cb10-142" aria-hidden="true" tabindex="-1"></a>prop <span class="op">=</span>  svg2<span class="op">.</span><span class="fu">plot</span>({<span class="dt">type</span><span class="op">:</span> <span class="st">"prop"</span><span class="op">,</span> </span>
<span id="cb10-143"><a href="#cb10-143" aria-hidden="true" tabindex="-1"></a>            <span class="dt">id</span><span class="op">:</span><span class="st">"prop"</span><span class="op">,</span></span>
<span id="cb10-144"><a href="#cb10-144" aria-hidden="true" tabindex="-1"></a>            <span class="dt">data</span><span class="op">:</span> world<span class="op">,</span></span>
<span id="cb10-145"><a href="#cb10-145" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span><span class="op">:</span> prop_ind2<span class="op">,</span></span>
<span id="cb10-146"><a href="#cb10-146" aria-hidden="true" tabindex="-1"></a>            <span class="dt">tip</span><span class="op">:</span> <span class="vs">`$NAMEen`</span><span class="op">,</span></span>
<span id="cb10-147"><a href="#cb10-147" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fill</span><span class="op">:</span> <span class="st">"#ffffff50"</span><span class="op">,</span></span>
<span id="cb10-148"><a href="#cb10-148" aria-hidden="true" tabindex="-1"></a>            <span class="dt">k</span><span class="op">:</span> k2<span class="op">,</span></span>
<span id="cb10-149"><a href="#cb10-149" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fixmax</span><span class="op">:</span> valmax2<span class="op">,</span></span>
<span id="cb10-150"><a href="#cb10-150" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_title</span><span class="op">:</span> <span class="st">"Indicator 1"</span><span class="op">,</span></span>
<span id="cb10-151"><a href="#cb10-151" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_frame</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb10-152"><a href="#cb10-152" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_frame_fill</span> <span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb10-153"><a href="#cb10-153" aria-hidden="true" tabindex="-1"></a>            <span class="dt">leg_frame_stroke</span><span class="op">:</span> <span class="st">"#ffffff80"</span>})<span class="op">;</span></span>
<span id="cb10-154"><a href="#cb10-154" aria-hidden="true" tabindex="-1"></a>svg2<span class="op">.</span><span class="fu">render</span>({<span class="dt">order</span><span class="op">:</span>[outline<span class="op">,</span> countries<span class="op">,</span> choro<span class="op">,</span> prop]})</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-10-6" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div></center>
</div>
</div>
</div></div>
</div>
<div id="country-table" class="dashboard-page tab-pane grid-skip html-fill-item html-fill-container" data-scrolling="true" data-orientation="rows" aria-labelledby="tab-country-table">
<div class="html-fill-item html-fill-container bslib-grid" style="display: grid; grid-template-rows: minmax(3em, 1fr) minmax(3em, 1fr) minmax(3em, 1fr); grid-auto-columns: minmax(0, 1fr);">
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb11" data-startfrom="162" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 161;"><span id="cb11-162"><a href="#cb11-162" aria-hidden="true" tabindex="-1"></a><span class="co">// fig-height: 10</span></span>
<span id="cb11-163"><a href="#cb11-163" aria-hidden="true" tabindex="-1"></a>{</span>
<span id="cb11-164"><a href="#cb11-164" aria-hidden="true" tabindex="-1"></a>  <span class="kw">const</span> svg <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg"</span>)</span>
<span id="cb11-165"><a href="#cb11-165" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-size"</span><span class="op">,</span> <span class="st">"10pt"</span>)</span>
<span id="cb11-166"><a href="#cb11-166" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"viewBox"</span><span class="op">,</span> [<span class="dv">0</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> width<span class="op">,</span> <span class="dv">800</span>])<span class="op">;</span></span>
<span id="cb11-167"><a href="#cb11-167" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-168"><a href="#cb11-168" aria-hidden="true" tabindex="-1"></a>  <span class="bu">document</span><span class="op">.</span><span class="at">body</span><span class="op">.</span><span class="fu">append</span>(svg<span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb11-169"><a href="#cb11-169" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb11-170"><a href="#cb11-170" aria-hidden="true" tabindex="-1"></a>  <span class="kw">new</span> <span class="fu">SVGTable</span>(svg)</span>
<span id="cb11-171"><a href="#cb11-171" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">size</span>([width<span class="op">,</span> <span class="dv">800</span>])</span>
<span id="cb11-172"><a href="#cb11-172" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fixedRows</span>(<span class="dv">0</span>)</span>
<span id="cb11-173"><a href="#cb11-173" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">rowsPerPage</span>(<span class="dv">75</span>)</span>
<span id="cb11-174"><a href="#cb11-174" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">fixedColumns</span>(<span class="dv">1</span>)</span>
<span id="cb11-175"><a href="#cb11-175" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">defaultNumberFormat</span>(<span class="st">",.1d"</span>)</span>
<span id="cb11-176"><a href="#cb11-176" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">style</span>({ <span class="dt">border</span><span class="op">:</span> <span class="kw">false</span> })</span>
<span id="cb11-177"><a href="#cb11-177" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">data</span>(data_world)  </span>
<span id="cb11-178"><a href="#cb11-178" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">onhighlight</span>(context <span class="kw">=&gt;</span> { <span class="co">/* do something */</span> })</span>
<span id="cb11-179"><a href="#cb11-179" aria-hidden="true" tabindex="-1"></a>    <span class="op">.</span><span class="fu">render</span>()<span class="op">;</span>    </span>
<span id="cb11-180"><a href="#cb11-180" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb11-181"><a href="#cb11-181" aria-hidden="true" tabindex="-1"></a>  svg<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb11-182"><a href="#cb11-182" aria-hidden="true" tabindex="-1"></a>  <span class="cf">return</span> svg<span class="op">.</span><span class="fu">node</span>()<span class="op">;</span></span>
<span id="cb11-183"><a href="#cb11-183" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-11" data-nodetype="expression" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="cell hidden html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb12" data-startfrom="192" data-source-offset="-36"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 191;"><span id="cb12-192"><a href="#cb12-192" aria-hidden="true" tabindex="-1"></a>bks <span class="op">=</span> metadata</span>
<span id="cb12-193"><a href="#cb12-193" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> choro_ind)</span>
<span id="cb12-194"><a href="#cb12-194" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">breaks</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">"["</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb12-195"><a href="#cb12-195" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">replace</span>(<span class="st">"]"</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb12-196"><a href="#cb12-196" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)</span>
<span id="cb12-197"><a href="#cb12-197" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="pp">parseFloat</span>(d))</span>
<span id="cb12-198"><a href="#cb12-198" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb12-199"><a href="#cb12-199" aria-hidden="true" tabindex="-1"></a>valmax <span class="op">=</span> metadata</span>
<span id="cb12-200"><a href="#cb12-200" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> prop_ind)</span>
<span id="cb12-201"><a href="#cb12-201" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">breaks</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">"["</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb12-202"><a href="#cb12-202" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">replace</span>(<span class="st">"]"</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb12-203"><a href="#cb12-203" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)</span>
<span id="cb12-204"><a href="#cb12-204" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="pp">parseFloat</span>(d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-12-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="cell hidden html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb13" data-startfrom="212" data-source-offset="-35"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 211;"><span id="cb13-212"><a href="#cb13-212" aria-hidden="true" tabindex="-1"></a>bks2 <span class="op">=</span> metadata_world</span>
<span id="cb13-213"><a href="#cb13-213" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> choro_ind2)</span>
<span id="cb13-214"><a href="#cb13-214" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">breaks</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">"["</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb13-215"><a href="#cb13-215" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">replace</span>(<span class="st">"]"</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb13-216"><a href="#cb13-216" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)</span>
<span id="cb13-217"><a href="#cb13-217" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="pp">parseFloat</span>(d))</span>
<span id="cb13-218"><a href="#cb13-218" aria-hidden="true" tabindex="-1"></a>  </span>
<span id="cb13-219"><a href="#cb13-219" aria-hidden="true" tabindex="-1"></a>valmax2 <span class="op">=</span> metadata_world</span>
<span id="cb13-220"><a href="#cb13-220" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">find</span>((d) <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">id</span> <span class="op">==</span> prop_ind2)</span>
<span id="cb13-221"><a href="#cb13-221" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="at">breaks</span><span class="op">.</span><span class="fu">replace</span>(<span class="st">"["</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb13-222"><a href="#cb13-222" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">replace</span>(<span class="st">"]"</span><span class="op">,</span> <span class="st">""</span>)</span>
<span id="cb13-223"><a href="#cb13-223" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)</span>
<span id="cb13-224"><a href="#cb13-224" aria-hidden="true" tabindex="-1"></a>  <span class="op">.</span><span class="fu">map</span>((d) <span class="kw">=&gt;</span> <span class="pp">parseFloat</span>(d))</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-13-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="cell hidden html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb14" data-startfrom="233" data-source-offset="-12"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 232;"><span id="cb14-233"><a href="#cb14-233" aria-hidden="true" tabindex="-1"></a>viz <span class="op">=</span> <span class="pp">require</span>(<span class="st">"geoviz@0.7.2"</span>)</span>
<span id="cb14-234"><a href="#cb14-234" aria-hidden="true" tabindex="-1"></a>dicopal <span class="op">=</span> <span class="im">import</span>(<span class="st">"dicopal@0.8.1"</span>)</span>
<span id="cb14-235"><a href="#cb14-235" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-236"><a href="#cb14-236" aria-hidden="true" tabindex="-1"></a><span class="co">// paramaters</span></span>
<span id="cb14-237"><a href="#cb14-237" aria-hidden="true" tabindex="-1"></a>fixmax <span class="op">=</span> d3<span class="op">.</span><span class="fu">max</span>(peaks<span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> <span class="op">+</span>d[indicator]))</span>
<span id="cb14-238"><a href="#cb14-238" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-239"><a href="#cb14-239" aria-hidden="true" tabindex="-1"></a><span class="co">// peaks</span></span>
<span id="cb14-240"><a href="#cb14-240" aria-hidden="true" tabindex="-1"></a>t_peaks <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data_conso/peak_6700_t_data.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()</span>
<span id="cb14-241"><a href="#cb14-241" aria-hidden="true" tabindex="-1"></a>metadata <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data_conso/metadata.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()</span>
<span id="cb14-242"><a href="#cb14-242" aria-hidden="true" tabindex="-1"></a>data_peaks <span class="op">=</span> peaks<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb14-243"><a href="#cb14-243" aria-hidden="true" tabindex="-1"></a>peaks <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data_conso/peak_6700_geoloc_data.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span>
<span id="cb14-244"><a href="#cb14-244" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-245"><a href="#cb14-245" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb14-246"><a href="#cb14-246" aria-hidden="true" tabindex="-1"></a><span class="co">// World data</span></span>
<span id="cb14-247"><a href="#cb14-247" aria-hidden="true" tabindex="-1"></a>metadata_world <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data_conso/metadata_world.csv"</span>)<span class="op">.</span><span class="fu">csv</span>()</span>
<span id="cb14-248"><a href="#cb14-248" aria-hidden="true" tabindex="-1"></a>data_world <span class="op">=</span> world<span class="op">.</span><span class="at">features</span><span class="op">.</span><span class="fu">map</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">properties</span>)</span>
<span id="cb14-249"><a href="#cb14-249" aria-hidden="true" tabindex="-1"></a>world <span class="op">=</span> <span class="fu">FileAttachment</span>(<span class="st">"data_conso/world_data.geojson"</span>)<span class="op">.</span><span class="fu">json</span>()</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-1" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-2" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-3" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-4" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-5" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-6" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-7" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-8" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-9" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div class="html-fill-item html-fill-container">
<div id="ojs-cell-14-10" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
</div>
<div class="cell hidden html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb15" data-startfrom="254" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 253;"><span id="cb15-254"><a href="#cb15-254" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/analyzer2004/svgtable</span></span>
<span id="cb15-255"><a href="#cb15-255" aria-hidden="true" tabindex="-1"></a><span class="co">// Copyright 2020 Eric Lo</span></span>
<span id="cb15-256"><a href="#cb15-256" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> SVGTable {</span>
<span id="cb15-257"><a href="#cb15-257" aria-hidden="true" tabindex="-1"></a>    <span class="fu">constructor</span>(svg<span class="op">,</span> container) {</span>
<span id="cb15-258"><a href="#cb15-258" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_svg</span> <span class="op">=</span> svg<span class="op">;</span></span>
<span id="cb15-259"><a href="#cb15-259" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_container</span> <span class="op">=</span> container <span class="op">||</span> svg<span class="op">;</span></span>
<span id="cb15-260"><a href="#cb15-260" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_g</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-261"><a href="#cb15-261" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span> <span class="op">=</span> { <span class="dt">x</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">y</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">width</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb15-262"><a href="#cb15-262" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-263"><a href="#cb15-263" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_autoSizeCell</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb15-264"><a href="#cb15-264" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_defaultColumnWidth</span> <span class="op">=</span> <span class="dv">100</span><span class="op">;</span></span>
<span id="cb15-265"><a href="#cb15-265" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeight</span> <span class="op">=</span> <span class="dv">24</span><span class="op">;</span> <span class="co">// user setting</span></span>
<span id="cb15-266"><a href="#cb15-266" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">=</span> <span class="dv">24</span><span class="op">;</span> <span class="co">// actual cell height = cellHeight + cellPaddingV * 2</span></span>
<span id="cb15-267"><a href="#cb15-267" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span> <span class="op">=</span> <span class="dv">10</span><span class="op">;</span></span>
<span id="cb15-268"><a href="#cb15-268" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingV</span> <span class="op">=</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb15-269"><a href="#cb15-269" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-270"><a href="#cb15-270" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-271"><a href="#cb15-271" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-272"><a href="#cb15-272" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_left</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-273"><a href="#cb15-273" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-274"><a href="#cb15-274" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">=</span> <span class="dv">400</span><span class="op">;</span></span>
<span id="cb15-275"><a href="#cb15-275" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">=</span> <span class="dv">300</span><span class="op">;</span></span>
<span id="cb15-276"><a href="#cb15-276" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_widthA</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-277"><a href="#cb15-277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_heightA</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-278"><a href="#cb15-278" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span> <span class="op">=</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb15-279"><a href="#cb15-279" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span> <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb15-280"><a href="#cb15-280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-281"><a href="#cb15-281" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_xf</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// horizontal content to scroll factor</span></span>
<span id="cb15-282"><a href="#cb15-282" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_yf</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span> <span class="co">// vertical content to scroll factor</span></span>
<span id="cb15-283"><a href="#cb15-283" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_minY</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> <span class="co">// minimum y of the content can be scrolled</span></span>
<span id="cb15-284"><a href="#cb15-284" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-285"><a href="#cb15-285" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-286"><a href="#cb15-286" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-287"><a href="#cb15-287" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_data</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-288"><a href="#cb15-288" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-289"><a href="#cb15-289" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb15-290"><a href="#cb15-290" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-291"><a href="#cb15-291" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_defaultNumberFormat</span> <span class="op">=</span> <span class="st">"$,.2f"</span><span class="op">;</span></span>
<span id="cb15-292"><a href="#cb15-292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-293"><a href="#cb15-293" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb15-294"><a href="#cb15-294" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapPalette</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span> <span class="co">// interpolator or array of colors</span></span>
<span id="cb15-295"><a href="#cb15-295" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapColor</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-296"><a href="#cb15-296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-297"><a href="#cb15-297" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-298"><a href="#cb15-298" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorPos</span> <span class="op">=</span> <span class="st">"top"</span><span class="op">;</span></span>
<span id="cb15-299"><a href="#cb15-299" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_rowCount</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-300"><a href="#cb15-300" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currPageNum</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-301"><a href="#cb15-301" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span> <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb15-302"><a href="#cb15-302" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-303"><a href="#cb15-303" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_endIndex</span> <span class="op">=</span> <span class="dv">49</span><span class="op">;</span></span>
<span id="cb15-304"><a href="#cb15-304" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPageSelections</span> <span class="op">=</span> [<span class="dv">25</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">75</span>]<span class="op">;</span></span>
<span id="cb15-305"><a href="#cb15-305" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-306"><a href="#cb15-306" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span> <span class="op">=</span> {</span>
<span id="cb15-307"><a href="#cb15-307" aria-hidden="true" tabindex="-1"></a>            <span class="dt">horizontal</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb15-308"><a href="#cb15-308" aria-hidden="true" tabindex="-1"></a>            <span class="dt">vertical</span><span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb15-309"><a href="#cb15-309" aria-hidden="true" tabindex="-1"></a>            <span class="dt">visible</span><span class="op">:</span> [<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>]</span>
<span id="cb15-310"><a href="#cb15-310" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb15-311"><a href="#cb15-311" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-312"><a href="#cb15-312" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_style</span> <span class="op">=</span> {</span>
<span id="cb15-313"><a href="#cb15-313" aria-hidden="true" tabindex="-1"></a>            <span class="dt">border</span><span class="op">:</span> <span class="kw">true</span><span class="op">,</span></span>
<span id="cb15-314"><a href="#cb15-314" aria-hidden="true" tabindex="-1"></a>            <span class="dt">borderColor</span><span class="op">:</span> <span class="st">"#aaa"</span><span class="op">,</span></span>
<span id="cb15-315"><a href="#cb15-315" aria-hidden="true" tabindex="-1"></a>            <span class="dt">textColor</span><span class="op">:</span> <span class="st">"black"</span><span class="op">,</span></span>
<span id="cb15-316"><a href="#cb15-316" aria-hidden="true" tabindex="-1"></a>            <span class="dt">background</span><span class="op">:</span> <span class="st">"white"</span><span class="op">,</span></span>
<span id="cb15-317"><a href="#cb15-317" aria-hidden="true" tabindex="-1"></a>            <span class="dt">headerBackground</span><span class="op">:</span> <span class="st">"#ddd"</span><span class="op">,</span></span>
<span id="cb15-318"><a href="#cb15-318" aria-hidden="true" tabindex="-1"></a>            <span class="dt">fixedBackground</span><span class="op">:</span> <span class="st">"#eee"</span><span class="op">,</span></span>
<span id="cb15-319"><a href="#cb15-319" aria-hidden="true" tabindex="-1"></a>            <span class="dt">highlight</span><span class="op">:</span> <span class="st">"cross"</span><span class="op">,</span> <span class="co">// none, cell, cross</span></span>
<span id="cb15-320"><a href="#cb15-320" aria-hidden="true" tabindex="-1"></a>            <span class="dt">highlightBackground</span><span class="op">:</span> <span class="st">"#fff3b0"</span></span>
<span id="cb15-321"><a href="#cb15-321" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb15-322"><a href="#cb15-322" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-323"><a href="#cb15-323" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_table</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-324"><a href="#cb15-324" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_header</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-325"><a href="#cb15-325" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_body</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-326"><a href="#cb15-326" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataArea</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-327"><a href="#cb15-327" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataHeader</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-328"><a href="#cb15-328" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-329"><a href="#cb15-329" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-330"><a href="#cb15-330" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onsort</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-331"><a href="#cb15-331" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onchangepage</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-332"><a href="#cb15-332" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onhighlight</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-333"><a href="#cb15-333" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onclick</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-334"><a href="#cb15-334" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_oncontextmenu</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-335"><a href="#cb15-335" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-336"><a href="#cb15-336" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_uniqueId</span> <span class="op">=</span> <span class="kw">new</span> <span class="bu">String</span>(<span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>() <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>())<span class="op">.</span><span class="fu">replace</span>(<span class="st">"."</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb15-337"><a href="#cb15-337" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-338"><a href="#cb15-338" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-339"><a href="#cb15-339" aria-hidden="true" tabindex="-1"></a>    <span class="fu">defaultColumnWidth</span>(_) {</span>
<span id="cb15-340"><a href="#cb15-340" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_defaultColumnWidth</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_defaultColumnWidth</span><span class="op">;</span></span>
<span id="cb15-341"><a href="#cb15-341" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-342"><a href="#cb15-342" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-343"><a href="#cb15-343" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cellHeight</span>(_) {</span>
<span id="cb15-344"><a href="#cb15-344" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_cellHeight</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeight</span><span class="op">;</span></span>
<span id="cb15-345"><a href="#cb15-345" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-346"><a href="#cb15-346" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-347"><a href="#cb15-347" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cellPaddingH</span>(_) {</span>
<span id="cb15-348"><a href="#cb15-348" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span><span class="op">;</span></span>
<span id="cb15-349"><a href="#cb15-349" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-350"><a href="#cb15-350" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-351"><a href="#cb15-351" aria-hidden="true" tabindex="-1"></a>    <span class="fu">cellPaddingV</span>(_) {</span>
<span id="cb15-352"><a href="#cb15-352" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingV</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingV</span><span class="op">;</span></span>
<span id="cb15-353"><a href="#cb15-353" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-354"><a href="#cb15-354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-355"><a href="#cb15-355" aria-hidden="true" tabindex="-1"></a>    <span class="fu">autoSizeCell</span>(_) {</span>
<span id="cb15-356"><a href="#cb15-356" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_autoSizeCell</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_autoSizeCell</span><span class="op">;</span></span>
<span id="cb15-357"><a href="#cb15-357" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-358"><a href="#cb15-358" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-359"><a href="#cb15-359" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fixedColumns</span>(_) {</span>
<span id="cb15-360"><a href="#cb15-360" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span><span class="op">;</span></span>
<span id="cb15-361"><a href="#cb15-361" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-362"><a href="#cb15-362" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-363"><a href="#cb15-363" aria-hidden="true" tabindex="-1"></a>    <span class="fu">fixedRows</span>(_) {</span>
<span id="cb15-364"><a href="#cb15-364" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span><span class="op">;</span></span>
<span id="cb15-365"><a href="#cb15-365" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-366"><a href="#cb15-366" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-367"><a href="#cb15-367" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowsPerPage</span>(_) {</span>
<span id="cb15-368"><a href="#cb15-368" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span> <span class="op">=</span> <span class="op">+</span>_<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span><span class="op">;</span></span>
<span id="cb15-369"><a href="#cb15-369" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-370"><a href="#cb15-370" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-371"><a href="#cb15-371" aria-hidden="true" tabindex="-1"></a>    <span class="fu">rowsPerPageSelections</span>(_) {</span>
<span id="cb15-372"><a href="#cb15-372" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPageSelections</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPageSelections</span><span class="op">;</span></span>
<span id="cb15-373"><a href="#cb15-373" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-374"><a href="#cb15-374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-375"><a href="#cb15-375" aria-hidden="true" tabindex="-1"></a>    <span class="fu">extent</span>(_) {</span>
<span id="cb15-376"><a href="#cb15-376" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (</span>
<span id="cb15-377"><a href="#cb15-377" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_left</span> <span class="op">=</span> <span class="op">+</span>_[<span class="dv">0</span>][<span class="dv">0</span>]<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">=</span> <span class="op">+</span>_[<span class="dv">0</span>][<span class="dv">1</span>]<span class="op">,</span></span>
<span id="cb15-378"><a href="#cb15-378" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">=</span> <span class="op">+</span>_[<span class="dv">1</span>][<span class="dv">0</span>]<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">=</span> <span class="op">+</span>_[<span class="dv">1</span>][<span class="dv">1</span>]<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> [[<span class="kw">this</span><span class="op">.</span><span class="at">_left</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_top</span>]<span class="op">,</span> [<span class="kw">this</span><span class="op">.</span><span class="at">_width</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span>]]<span class="op">;</span></span>
<span id="cb15-379"><a href="#cb15-379" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-380"><a href="#cb15-380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-381"><a href="#cb15-381" aria-hidden="true" tabindex="-1"></a>    <span class="fu">size</span>(_) {</span>
<span id="cb15-382"><a href="#cb15-382" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">=</span> <span class="op">+</span>_[<span class="dv">0</span>]<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">=</span> <span class="op">+</span>_[<span class="dv">1</span>]<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> [<span class="kw">this</span><span class="op">.</span><span class="at">_width</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span>]<span class="op">;</span></span>
<span id="cb15-383"><a href="#cb15-383" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-384"><a href="#cb15-384" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-385"><a href="#cb15-385" aria-hidden="true" tabindex="-1"></a>    <span class="fu">style</span>(_) {</span>
<span id="cb15-386"><a href="#cb15-386" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_style</span> <span class="op">=</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">assign</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">,</span> _)<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">;</span></span>
<span id="cb15-387"><a href="#cb15-387" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-388"><a href="#cb15-388" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-389"><a href="#cb15-389" aria-hidden="true" tabindex="-1"></a>    <span class="fu">heatmap</span>(_) {</span>
<span id="cb15-390"><a href="#cb15-390" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">arguments</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb15-391"><a href="#cb15-391" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span> <span class="op">=</span> _<span class="op">;</span></span>
<span id="cb15-392"><a href="#cb15-392" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_updateHeatmap</span>()<span class="op">;</span></span>
<span id="cb15-393"><a href="#cb15-393" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb15-394"><a href="#cb15-394" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-395"><a href="#cb15-395" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb15-396"><a href="#cb15-396" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span><span class="op">;</span></span>
<span id="cb15-397"><a href="#cb15-397" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-398"><a href="#cb15-398" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-399"><a href="#cb15-399" aria-hidden="true" tabindex="-1"></a>    <span class="fu">heatmapPalette</span>(_) {</span>
<span id="cb15-400"><a href="#cb15-400" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">arguments</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb15-401"><a href="#cb15-401" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapPalette</span> <span class="op">=</span> _<span class="op">;</span></span>
<span id="cb15-402"><a href="#cb15-402" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>) {</span>
<span id="cb15-403"><a href="#cb15-403" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="fu">_processHeatmap</span>()<span class="op">;</span></span>
<span id="cb15-404"><a href="#cb15-404" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_updateHeatmap</span>()<span class="op">;</span></span>
<span id="cb15-405"><a href="#cb15-405" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-406"><a href="#cb15-406" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb15-407"><a href="#cb15-407" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-408"><a href="#cb15-408" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb15-409"><a href="#cb15-409" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapPalette</span><span class="op">;</span></span>
<span id="cb15-410"><a href="#cb15-410" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-411"><a href="#cb15-411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-412"><a href="#cb15-412" aria-hidden="true" tabindex="-1"></a>    <span class="fu">data</span>(_) {</span>
<span id="cb15-413"><a href="#cb15-413" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_data</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">;</span></span>
<span id="cb15-414"><a href="#cb15-414" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-415"><a href="#cb15-415" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-416"><a href="#cb15-416" aria-hidden="true" tabindex="-1"></a>    <span class="fu">columns</span>(_) {</span>
<span id="cb15-417"><a href="#cb15-417" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">arguments</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb15-418"><a href="#cb15-418" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span> <span class="op">=</span> _<span class="op">;</span></span>
<span id="cb15-419"><a href="#cb15-419" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb15-420"><a href="#cb15-420" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-421"><a href="#cb15-421" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-422"><a href="#cb15-422" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="at">_columns</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_processColumns</span>()<span class="op">;</span></span>
<span id="cb15-423"><a href="#cb15-423" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">;</span></span>
<span id="cb15-424"><a href="#cb15-424" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-425"><a href="#cb15-425" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-426"><a href="#cb15-426" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-427"><a href="#cb15-427" aria-hidden="true" tabindex="-1"></a>    <span class="fu">defaultNumberFormat</span>(_) {</span>
<span id="cb15-428"><a href="#cb15-428" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_defaultNumberFormat</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_defaultNumberFormat</span><span class="op">;</span></span>
<span id="cb15-429"><a href="#cb15-429" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-430"><a href="#cb15-430" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-431"><a href="#cb15-431" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onsort</span>(_) {</span>
<span id="cb15-432"><a href="#cb15-432" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onsort</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onsort</span><span class="op">;</span></span>
<span id="cb15-433"><a href="#cb15-433" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-434"><a href="#cb15-434" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-435"><a href="#cb15-435" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onchangepage</span>(_) {</span>
<span id="cb15-436"><a href="#cb15-436" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onchangepage</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onchangepage</span><span class="op">;</span></span>
<span id="cb15-437"><a href="#cb15-437" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-438"><a href="#cb15-438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-439"><a href="#cb15-439" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onhighlight</span>(_) {</span>
<span id="cb15-440"><a href="#cb15-440" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onhighlight</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onhighlight</span><span class="op">;</span></span>
<span id="cb15-441"><a href="#cb15-441" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-442"><a href="#cb15-442" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-443"><a href="#cb15-443" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onclick</span>(_) {</span>
<span id="cb15-444"><a href="#cb15-444" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onclick</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onclick</span><span class="op">;</span></span>
<span id="cb15-445"><a href="#cb15-445" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-446"><a href="#cb15-446" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-447"><a href="#cb15-447" aria-hidden="true" tabindex="-1"></a>    <span class="fu">oncontextmenu</span>(_) {</span>
<span id="cb15-448"><a href="#cb15-448" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_oncontextmenu</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_oncontextmenu</span><span class="op">;</span></span>
<span id="cb15-449"><a href="#cb15-449" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-450"><a href="#cb15-450" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-451"><a href="#cb15-451" aria-hidden="true" tabindex="-1"></a>    <span class="fu">render</span>() {</span>
<span id="cb15-452"><a href="#cb15-452" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="fu">_validate</span>()) {</span>
<span id="cb15-453"><a href="#cb15-453" aria-hidden="true" tabindex="-1"></a>            <span class="co">// error</span></span>
<span id="cb15-454"><a href="#cb15-454" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-455"><a href="#cb15-455" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-456"><a href="#cb15-456" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_init</span>()<span class="op">;</span></span>
<span id="cb15-457"><a href="#cb15-457" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_initPaginator</span>()<span class="op">;</span></span>
<span id="cb15-458"><a href="#cb15-458" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_processColumns</span>()<span class="op">;</span></span>
<span id="cb15-459"><a href="#cb15-459" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_prepare</span>()<span class="op">;</span></span>
<span id="cb15-460"><a href="#cb15-460" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-461"><a href="#cb15-461" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_calcConstrains</span>()<span class="op">;</span></span>
<span id="cb15-462"><a href="#cb15-462" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_createClipPaths</span>()<span class="op">;</span></span>
<span id="cb15-463"><a href="#cb15-463" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-464"><a href="#cb15-464" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_processHeatmap</span>()<span class="op">;</span></span>
<span id="cb15-465"><a href="#cb15-465" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_createTable</span>()<span class="op">;</span></span>
<span id="cb15-466"><a href="#cb15-466" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderBody</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>)<span class="op">;</span></span>
<span id="cb15-467"><a href="#cb15-467" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderHeader</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>)<span class="op">;</span></span>
<span id="cb15-468"><a href="#cb15-468" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_addScrollbars</span>()<span class="op">;</span></span>
<span id="cb15-469"><a href="#cb15-469" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span><span class="op">.</span><span class="fu">render</span>()<span class="op">;</span></span>
<span id="cb15-470"><a href="#cb15-470" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-471"><a href="#cb15-471" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb15-472"><a href="#cb15-472" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-473"><a href="#cb15-473" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-474"><a href="#cb15-474" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getRowData</span>(index) {</span>
<span id="cb15-475"><a href="#cb15-475" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span>[index]<span class="op">;</span></span>
<span id="cb15-476"><a href="#cb15-476" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-477"><a href="#cb15-477" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-478"><a href="#cb15-478" aria-hidden="true" tabindex="-1"></a>    <span class="fu">getColumnData</span>(index) {</span>
<span id="cb15-479"><a href="#cb15-479" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> c <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>[index]<span class="op">;</span></span>
<span id="cb15-480"><a href="#cb15-480" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="fu">map</span>(_ <span class="kw">=&gt;</span> _[c<span class="op">.</span><span class="at">name</span>])<span class="op">;</span></span>
<span id="cb15-481"><a href="#cb15-481" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-482"><a href="#cb15-482" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-483"><a href="#cb15-483" aria-hidden="true" tabindex="-1"></a>    <span class="kw">get</span> <span class="fu">g</span>() { <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_g</span><span class="op">;</span> }</span>
<span id="cb15-484"><a href="#cb15-484" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-485"><a href="#cb15-485" aria-hidden="true" tabindex="-1"></a>    <span class="kw">get</span> <span class="fu">svg</span>() { <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_svg</span><span class="op">;</span> }</span>
<span id="cb15-486"><a href="#cb15-486" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-487"><a href="#cb15-487" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_init</span>() {</span>
<span id="cb15-488"><a href="#cb15-488" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_g</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_container</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb15-489"><a href="#cb15-489" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeight</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingV</span> <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb15-490"><a href="#cb15-490" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getBBox</span>(<span class="st">"Z"</span>)<span class="op">;</span></span>
<span id="cb15-491"><a href="#cb15-491" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-492"><a href="#cb15-492" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_widthA</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span><span class="op">;</span></span>
<span id="cb15-493"><a href="#cb15-493" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_heightA</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span><span class="op">;</span></span>
<span id="cb15-494"><a href="#cb15-494" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-495"><a href="#cb15-495" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-496"><a href="#cb15-496" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_initPaginator</span>() {</span>
<span id="cb15-497"><a href="#cb15-497" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span>) {</span>
<span id="cb15-498"><a href="#cb15-498" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">;</span></span>
<span id="cb15-499"><a href="#cb15-499" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_rowCount</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb15-500"><a href="#cb15-500" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_data</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span>)<span class="op">;</span></span>
<span id="cb15-501"><a href="#cb15-501" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_calcPageRange</span>(<span class="dv">1</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb15-502"><a href="#cb15-502" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-503"><a href="#cb15-503" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> pr <span class="op">=</span> <span class="kw">new</span> <span class="fu">Paginator</span>(<span class="kw">this</span>)<span class="op">;</span></span>
<span id="cb15-504"><a href="#cb15-504" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> ptop <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_top</span><span class="op">,</span> ph <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span><span class="op">.</span><span class="at">height</span> <span class="op">+</span> pr<span class="op">.</span><span class="fu">buttonPadding</span>() <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">3</span><span class="op">;</span> <span class="co">//3: margin</span></span>
<span id="cb15-505"><a href="#cb15-505" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">+=</span> ph<span class="op">;</span></span>
<span id="cb15-506"><a href="#cb15-506" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">-=</span> ph<span class="op">;</span></span>
<span id="cb15-507"><a href="#cb15-507" aria-hidden="true" tabindex="-1"></a>            <span class="co">// bottom</span></span>
<span id="cb15-508"><a href="#cb15-508" aria-hidden="true" tabindex="-1"></a>            <span class="co">// this._height -= ph - 5;</span></span>
<span id="cb15-509"><a href="#cb15-509" aria-hidden="true" tabindex="-1"></a>            <span class="co">// ptop = this._height + this._top + 5;</span></span>
<span id="cb15-510"><a href="#cb15-510" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-511"><a href="#cb15-511" aria-hidden="true" tabindex="-1"></a>            pr<span class="op">.</span><span class="fu">init</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowCount</span>)</span>
<span id="cb15-512"><a href="#cb15-512" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">options</span>({</span>
<span id="cb15-513"><a href="#cb15-513" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">position</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb15-514"><a href="#cb15-514" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">selector</span><span class="op">:</span> <span class="st">"right"</span><span class="op">,</span></span>
<span id="cb15-515"><a href="#cb15-515" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">buttonColor</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">.</span><span class="at">headerBackground</span></span>
<span id="cb15-516"><a href="#cb15-516" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb15-517"><a href="#cb15-517" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">position</span>([<span class="kw">this</span><span class="op">.</span><span class="at">_left</span><span class="op">,</span> ptop])</span>
<span id="cb15-518"><a href="#cb15-518" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">recordsPerPageSelections</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPageSelections</span>)</span>
<span id="cb15-519"><a href="#cb15-519" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">onPageNumberChange</span>((pnum<span class="op">,</span> begin<span class="op">,</span> end) <span class="kw">=&gt;</span> {</span>
<span id="cb15-520"><a href="#cb15-520" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="at">_currPageNum</span> <span class="op">=</span> pnum<span class="op">;</span></span>
<span id="cb15-521"><a href="#cb15-521" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_calcPageRange</span>(pnum<span class="op">,</span> begin)<span class="op">;</span></span>
<span id="cb15-522"><a href="#cb15-522" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_pageData</span>()<span class="op">;</span></span>
<span id="cb15-523"><a href="#cb15-523" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_rerender</span>()<span class="op">;</span></span>
<span id="cb15-524"><a href="#cb15-524" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onchangepage</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_onchangepage</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span>)<span class="op">;</span></span>
<span id="cb15-525"><a href="#cb15-525" aria-hidden="true" tabindex="-1"></a>                })</span>
<span id="cb15-526"><a href="#cb15-526" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">onRecordsPerPageChange</span>((rpp<span class="op">,</span> pnum<span class="op">,</span> begin<span class="op">,</span> end) <span class="kw">=&gt;</span> {</span>
<span id="cb15-527"><a href="#cb15-527" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span> <span class="op">=</span> rpp<span class="op">;</span></span>
<span id="cb15-528"><a href="#cb15-528" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="at">_currPageNum</span> <span class="op">=</span> pnum<span class="op">;</span></span>
<span id="cb15-529"><a href="#cb15-529" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_calcPageRange</span>(pnum<span class="op">,</span> begin)<span class="op">;</span></span>
<span id="cb15-530"><a href="#cb15-530" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_pageData</span>()<span class="op">;</span></span>
<span id="cb15-531"><a href="#cb15-531" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_rerender</span>()<span class="op">;</span></span>
<span id="cb15-532"><a href="#cb15-532" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onchangepage</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_onchangepage</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span>)<span class="op">;</span></span>
<span id="cb15-533"><a href="#cb15-533" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb15-534"><a href="#cb15-534" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-535"><a href="#cb15-535" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span> <span class="op">=</span> pr<span class="op">;</span></span>
<span id="cb15-536"><a href="#cb15-536" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-537"><a href="#cb15-537" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-538"><a href="#cb15-538" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-539"><a href="#cb15-539" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_calcPageRange</span>(pnum<span class="op">,</span> begin) {</span>
<span id="cb15-540"><a href="#cb15-540" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pnum <span class="op">===</span> <span class="dv">1</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span><span class="op">;</span></span>
<span id="cb15-541"><a href="#cb15-541" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span> <span class="op">=</span> begin <span class="op">-</span> (pnum <span class="op">-</span> <span class="dv">2</span>) <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span><span class="op">;</span></span>
<span id="cb15-542"><a href="#cb15-542" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-543"><a href="#cb15-543" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_endIndex</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span><span class="op">;</span></span>
<span id="cb15-544"><a href="#cb15-544" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-545"><a href="#cb15-545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-546"><a href="#cb15-546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_pageData</span>() {</span>
<span id="cb15-547"><a href="#cb15-547" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_data</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)</span>
<span id="cb15-548"><a href="#cb15-548" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">concat</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_beginIndex</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_endIndex</span>))<span class="op">;</span></span>
<span id="cb15-549"><a href="#cb15-549" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-550"><a href="#cb15-550" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-551"><a href="#cb15-551" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_rerender</span>() {</span>
<span id="cb15-552"><a href="#cb15-552" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_g</span><span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"clipPath"</span>)<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb15-553"><a href="#cb15-553" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_table</span><span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb15-554"><a href="#cb15-554" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">horizontal</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">horizontal</span><span class="op">.</span><span class="fu">dispose</span>()<span class="op">;</span></span>
<span id="cb15-555"><a href="#cb15-555" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">vertical</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">vertical</span><span class="op">.</span><span class="fu">dispose</span>()<span class="op">;</span></span>
<span id="cb15-556"><a href="#cb15-556" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-557"><a href="#cb15-557" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-558"><a href="#cb15-558" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_heightA</span><span class="op">;</span></span>
<span id="cb15-559"><a href="#cb15-559" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_widthA</span><span class="op">;</span></span>
<span id="cb15-560"><a href="#cb15-560" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">visible</span> <span class="op">=</span> [<span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>]<span class="op">;</span></span>
<span id="cb15-561"><a href="#cb15-561" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-562"><a href="#cb15-562" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> ph <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span><span class="op">.</span><span class="at">height</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span><span class="op">.</span><span class="fu">buttonPadding</span>() <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb15-563"><a href="#cb15-563" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">-=</span> ph<span class="op">;</span></span>
<span id="cb15-564"><a href="#cb15-564" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-565"><a href="#cb15-565" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_processColumns</span>()<span class="op">;</span></span>
<span id="cb15-566"><a href="#cb15-566" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_prepare</span>()<span class="op">;</span></span>
<span id="cb15-567"><a href="#cb15-567" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-568"><a href="#cb15-568" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_calcConstrains</span>()<span class="op">;</span></span>
<span id="cb15-569"><a href="#cb15-569" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createClipPaths</span>()<span class="op">;</span></span>
<span id="cb15-570"><a href="#cb15-570" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-571"><a href="#cb15-571" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createTable</span>()<span class="op">;</span></span>
<span id="cb15-572"><a href="#cb15-572" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_renderBody</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>)<span class="op">;</span></span>
<span id="cb15-573"><a href="#cb15-573" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_renderHeader</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_table</span>)<span class="op">;</span></span>
<span id="cb15-574"><a href="#cb15-574" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_addScrollbars</span>()<span class="op">;</span></span>
<span id="cb15-575"><a href="#cb15-575" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-576"><a href="#cb15-576" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-577"><a href="#cb15-577" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_validate</span>() {</span>
<span id="cb15-578"><a href="#cb15-578" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-579"><a href="#cb15-579" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-580"><a href="#cb15-580" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-581"><a href="#cb15-581" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_prepare</span>() {</span>
<span id="cb15-582"><a href="#cb15-582" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="op">;</span></span>
<span id="cb15-583"><a href="#cb15-583" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-584"><a href="#cb15-584" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> w <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sumWidth</span>()<span class="op">;</span></span>
<span id="cb15-585"><a href="#cb15-585" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> h <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span> <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="op">;</span></span>
<span id="cb15-586"><a href="#cb15-586" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-587"><a href="#cb15-587" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (w <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span> <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span>) {</span>
<span id="cb15-588"><a href="#cb15-588" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">=</span> w<span class="op">;</span></span>
<span id="cb15-589"><a href="#cb15-589" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">visible</span>[<span class="dv">0</span>] <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb15-590"><a href="#cb15-590" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-591"><a href="#cb15-591" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-592"><a href="#cb15-592" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">-=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span><span class="op">;</span></span>
<span id="cb15-593"><a href="#cb15-593" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-594"><a href="#cb15-594" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-595"><a href="#cb15-595" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (h <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span>) {</span>
<span id="cb15-596"><a href="#cb15-596" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">=</span> h <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="op">;</span> <span class="co">// includes header</span></span>
<span id="cb15-597"><a href="#cb15-597" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">visible</span>[<span class="dv">1</span>] <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb15-598"><a href="#cb15-598" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-599"><a href="#cb15-599" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-600"><a href="#cb15-600" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">-=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span><span class="op">;</span></span>
<span id="cb15-601"><a href="#cb15-601" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-602"><a href="#cb15-602" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-603"><a href="#cb15-603" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-604"><a href="#cb15-604" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_sumWidth</span>(n) {</span>
<span id="cb15-605"><a href="#cb15-605" aria-hidden="true" tabindex="-1"></a>        <span class="co">// n === 0 : do not calculate, usually it is _fixedColumns = 0</span></span>
<span id="cb15-606"><a href="#cb15-606" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (n <span class="op">===</span> <span class="dv">0</span>)</span>
<span id="cb15-607"><a href="#cb15-607" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-608"><a href="#cb15-608" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-609"><a href="#cb15-609" aria-hidden="true" tabindex="-1"></a>            <span class="co">// n === undefined : all columns</span></span>
<span id="cb15-610"><a href="#cb15-610" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> l <span class="op">=</span> n <span class="op">||</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb15-611"><a href="#cb15-611" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> w <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-612"><a href="#cb15-612" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> l<span class="op">;</span> i<span class="op">++</span>) w <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>[i]<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb15-613"><a href="#cb15-613" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> w<span class="op">;</span></span>
<span id="cb15-614"><a href="#cb15-614" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-615"><a href="#cb15-615" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-616"><a href="#cb15-616" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-617"><a href="#cb15-617" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_processColumns</span>() {</span>
<span id="cb15-618"><a href="#cb15-618" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span>[<span class="dv">0</span>]<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-619"><a href="#cb15-619" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_data</span>[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb15-620"><a href="#cb15-620" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-621"><a href="#cb15-621" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-622"><a href="#cb15-622" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>) {</span>
<span id="cb15-623"><a href="#cb15-623" aria-hidden="true" tabindex="-1"></a>            <span class="co">// CSV or JSON</span></span>
<span id="cb15-624"><a href="#cb15-624" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> keys <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">columns</span> <span class="op">?</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">columns</span> <span class="op">:</span> <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_data</span>[<span class="dv">0</span>])<span class="op">;</span></span>
<span id="cb15-625"><a href="#cb15-625" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-626"><a href="#cb15-626" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span> <span class="op">=</span> keys<span class="op">.</span><span class="fu">map</span>((c<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb15-627"><a href="#cb15-627" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> isNumber <span class="op">=</span> <span class="kw">typeof</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span>[<span class="dv">0</span>][c] <span class="op">===</span> <span class="st">"number"</span><span class="op">;</span></span>
<span id="cb15-628"><a href="#cb15-628" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> column <span class="op">=</span> {</span>
<span id="cb15-629"><a href="#cb15-629" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">name</span><span class="op">:</span> c<span class="op">,</span></span>
<span id="cb15-630"><a href="#cb15-630" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">isNumber</span><span class="op">:</span> isNumber<span class="op">,</span></span>
<span id="cb15-631"><a href="#cb15-631" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">format</span><span class="op">:</span> isNumber <span class="op">?</span> <span class="kw">this</span><span class="op">.</span><span class="at">_defaultNumberFormat</span> <span class="op">:</span> <span class="kw">null</span><span class="op">,</span></span>
<span id="cb15-632"><a href="#cb15-632" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">order</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="co">// 0: none, 1: ascending, 2: descending</span></span>
<span id="cb15-633"><a href="#cb15-633" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">x</span><span class="op">:</span> x<span class="op">,</span></span>
<span id="cb15-634"><a href="#cb15-634" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">tx</span><span class="op">:</span> x<span class="op">,</span> <span class="co">// x for translate</span></span>
<span id="cb15-635"><a href="#cb15-635" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">index</span><span class="op">:</span> i<span class="op">,</span></span>
<span id="cb15-636"><a href="#cb15-636" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">width</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_defaultColumnWidth</span></span>
<span id="cb15-637"><a href="#cb15-637" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb15-638"><a href="#cb15-638" aria-hidden="true" tabindex="-1"></a>                x <span class="op">+=</span> column<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb15-639"><a href="#cb15-639" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> column<span class="op">;</span></span>
<span id="cb15-640"><a href="#cb15-640" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb15-641"><a href="#cb15-641" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-642"><a href="#cb15-642" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-643"><a href="#cb15-643" aria-hidden="true" tabindex="-1"></a>            <span class="kw">let</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-644"><a href="#cb15-644" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">forEach</span>((column<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb15-645"><a href="#cb15-645" aria-hidden="true" tabindex="-1"></a>                column<span class="op">.</span><span class="at">width</span> <span class="op">=</span> column<span class="op">.</span><span class="at">width</span> <span class="op">||</span> <span class="kw">this</span><span class="op">.</span><span class="at">_defaultColumnWidth</span><span class="op">;</span></span>
<span id="cb15-646"><a href="#cb15-646" aria-hidden="true" tabindex="-1"></a>                column<span class="op">.</span><span class="at">x</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb15-647"><a href="#cb15-647" aria-hidden="true" tabindex="-1"></a>                column<span class="op">.</span><span class="at">tx</span> <span class="op">=</span> x<span class="op">;</span> <span class="co">// x for translate</span></span>
<span id="cb15-648"><a href="#cb15-648" aria-hidden="true" tabindex="-1"></a>                column<span class="op">.</span><span class="at">index</span> <span class="op">=</span> i<span class="op">;</span></span>
<span id="cb15-649"><a href="#cb15-649" aria-hidden="true" tabindex="-1"></a>                x <span class="op">+=</span> column<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb15-650"><a href="#cb15-650" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb15-651"><a href="#cb15-651" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-652"><a href="#cb15-652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-653"><a href="#cb15-653" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_autoSizeCell</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_calcSize</span>()<span class="op">;</span></span>
<span id="cb15-654"><a href="#cb15-654" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-655"><a href="#cb15-655" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sumWidth</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">;</span></span>
<span id="cb15-656"><a href="#cb15-656" aria-hidden="true" tabindex="-1"></a>        <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb15-657"><a href="#cb15-657" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> c <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>[i]<span class="op">;</span></span>
<span id="cb15-658"><a href="#cb15-658" aria-hidden="true" tabindex="-1"></a>            c<span class="op">.</span><span class="at">tx</span> <span class="op">=</span> c<span class="op">.</span><span class="at">x</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="op">;</span> <span class="co">// x for translate</span></span>
<span id="cb15-659"><a href="#cb15-659" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-660"><a href="#cb15-660" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-661"><a href="#cb15-661" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="at">resetOrder</span> <span class="op">=</span> (except) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">forEach</span>(c <span class="kw">=&gt;</span> { <span class="cf">if</span> (except <span class="op">&amp;&amp;</span> c <span class="op">!==</span> except <span class="op">||</span> <span class="op">!</span>except) c<span class="op">.</span><span class="at">order</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> })<span class="op">;</span></span>
<span id="cb15-662"><a href="#cb15-662" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-663"><a href="#cb15-663" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-664"><a href="#cb15-664" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_calcSize</span>() {</span>
<span id="cb15-665"><a href="#cb15-665" aria-hidden="true" tabindex="-1"></a>        <span class="co">// test if it is used in a generator</span></span>
<span id="cb15-666"><a href="#cb15-666" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span><span class="op">.</span><span class="at">width</span> <span class="op">&gt;</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span><span class="op">.</span><span class="at">height</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-667"><a href="#cb15-667" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-668"><a href="#cb15-668" aria-hidden="true" tabindex="-1"></a>            <span class="co">// overrides cellHeight</span></span>
<span id="cb15-669"><a href="#cb15-669" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeight</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span><span class="op">.</span><span class="at">height</span><span class="op">;</span></span>
<span id="cb15-670"><a href="#cb15-670" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_charBox</span><span class="op">.</span><span class="at">height</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingV</span> <span class="op">*</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb15-671"><a href="#cb15-671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-672"><a href="#cb15-672" aria-hidden="true" tabindex="-1"></a>            <span class="co">// prepare keys</span></span>
<span id="cb15-673"><a href="#cb15-673" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> keys <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb15-674"><a href="#cb15-674" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> longest <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">map</span>((column<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb15-675"><a href="#cb15-675" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span>) keys<span class="op">.</span><span class="fu">push</span>(i)<span class="op">;</span></span>
<span id="cb15-676"><a href="#cb15-676" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span> keys<span class="op">.</span><span class="fu">push</span>(column<span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb15-677"><a href="#cb15-677" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> column<span class="op">.</span><span class="at">name</span><span class="op">;</span></span>
<span id="cb15-678"><a href="#cb15-678" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb15-679"><a href="#cb15-679" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-680"><a href="#cb15-680" aria-hidden="true" tabindex="-1"></a>            <span class="co">// find the longest string for each column</span></span>
<span id="cb15-681"><a href="#cb15-681" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb15-682"><a href="#cb15-682" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> row <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span>[i]<span class="op">;</span></span>
<span id="cb15-683"><a href="#cb15-683" aria-hidden="true" tabindex="-1"></a>                <span class="cf">for</span> (<span class="kw">let</span> j <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> j <span class="op">&lt;</span> keys<span class="op">.</span><span class="at">length</span><span class="op">;</span> j<span class="op">++</span>) {</span>
<span id="cb15-684"><a href="#cb15-684" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">const</span> key <span class="op">=</span> keys[j]<span class="op">,</span> column <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>[j]<span class="op">;</span></span>
<span id="cb15-685"><a href="#cb15-685" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">const</span> val <span class="op">=</span> row[key]<span class="op">;</span></span>
<span id="cb15-686"><a href="#cb15-686" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (val) {</span>
<span id="cb15-687"><a href="#cb15-687" aria-hidden="true" tabindex="-1"></a>                      <span class="kw">const</span> curr <span class="op">=</span> column<span class="op">.</span><span class="at">isNumber</span> <span class="op">&amp;&amp;</span> column<span class="op">.</span><span class="at">format</span> <span class="op">?</span> d3<span class="op">.</span><span class="fu">format</span>(column<span class="op">.</span><span class="at">format</span>)(row[key]) <span class="op">:</span> row[key]<span class="op">;</span></span>
<span id="cb15-688"><a href="#cb15-688" aria-hidden="true" tabindex="-1"></a>                      <span class="cf">if</span> (curr<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> longest[j]<span class="op">.</span><span class="at">length</span>) longest[j] <span class="op">=</span> curr<span class="op">;</span></span>
<span id="cb15-689"><a href="#cb15-689" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb15-690"><a href="#cb15-690" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb15-691"><a href="#cb15-691" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-692"><a href="#cb15-692" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-693"><a href="#cb15-693" aria-hidden="true" tabindex="-1"></a>            <span class="co">// re-calculate column width for each column based on longest[]</span></span>
<span id="cb15-694"><a href="#cb15-694" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> x <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb15-695"><a href="#cb15-695" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> longest<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb15-696"><a href="#cb15-696" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> column <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>[i]<span class="op">;</span></span>
<span id="cb15-697"><a href="#cb15-697" aria-hidden="true" tabindex="-1"></a>                column<span class="op">.</span><span class="at">x</span> <span class="op">=</span> column<span class="op">.</span><span class="at">tx</span> <span class="op">=</span> x<span class="op">;</span></span>
<span id="cb15-698"><a href="#cb15-698" aria-hidden="true" tabindex="-1"></a>                column<span class="op">.</span><span class="at">width</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getBBox</span>(longest[i])<span class="op">.</span><span class="at">width</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span> <span class="op">*</span> <span class="dv">2</span> <span class="op">+</span> <span class="dv">20</span><span class="op">;</span></span>
<span id="cb15-699"><a href="#cb15-699" aria-hidden="true" tabindex="-1"></a>                x <span class="op">+=</span> column<span class="op">.</span><span class="at">width</span><span class="op">;</span></span>
<span id="cb15-700"><a href="#cb15-700" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-701"><a href="#cb15-701" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-702"><a href="#cb15-702" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-703"><a href="#cb15-703" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-704"><a href="#cb15-704" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_getBBox</span>(str) {</span>
<span id="cb15-705"><a href="#cb15-705" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> t<span class="op">;</span></span>
<span id="cb15-706"><a href="#cb15-706" aria-hidden="true" tabindex="-1"></a>        <span class="cf">try</span> {</span>
<span id="cb15-707"><a href="#cb15-707" aria-hidden="true" tabindex="-1"></a>            t <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_svg</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">text</span>(str)<span class="op">;</span></span>
<span id="cb15-708"><a href="#cb15-708" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> t<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">getBBox</span>()<span class="op">;</span></span>
<span id="cb15-709"><a href="#cb15-709" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-710"><a href="#cb15-710" aria-hidden="true" tabindex="-1"></a>        <span class="cf">finally</span> {</span>
<span id="cb15-711"><a href="#cb15-711" aria-hidden="true" tabindex="-1"></a>            t<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb15-712"><a href="#cb15-712" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-713"><a href="#cb15-713" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-714"><a href="#cb15-714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-715"><a href="#cb15-715" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_processHeatmap</span>() {</span>
<span id="cb15-716"><a href="#cb15-716" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="at">_heatmapPalette</span>) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb15-717"><a href="#cb15-717" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-718"><a href="#cb15-718" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> data <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span> <span class="op">||</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">;</span></span>
<span id="cb15-719"><a href="#cb15-719" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> all <span class="op">=</span> data<span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)<span class="op">.</span><span class="fu">flatMap</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb15-720"><a href="#cb15-720" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> r <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span></span>
<span id="cb15-721"><a href="#cb15-721" aria-hidden="true" tabindex="-1"></a>                d<span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>) <span class="op">:</span></span>
<span id="cb15-722"><a href="#cb15-722" aria-hidden="true" tabindex="-1"></a>                <span class="bu">Object</span><span class="op">.</span><span class="fu">keys</span>(d)<span class="op">.</span><span class="fu">map</span>(k <span class="kw">=&gt;</span> d[k])<span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">;</span></span>
<span id="cb15-723"><a href="#cb15-723" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-724"><a href="#cb15-724" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> values <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb15-725"><a href="#cb15-725" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> r<span class="op">.</span><span class="at">length</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb15-726"><a href="#cb15-726" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> col <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span>[i <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>]<span class="op">;</span></span>
<span id="cb15-727"><a href="#cb15-727" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (col<span class="op">.</span><span class="at">isNumber</span>) values<span class="op">.</span><span class="fu">push</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span> r[i] <span class="op">:</span> r[col<span class="op">.</span><span class="at">name</span>])<span class="op">;</span></span>
<span id="cb15-728"><a href="#cb15-728" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-729"><a href="#cb15-729" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> r<span class="op">;</span></span>
<span id="cb15-730"><a href="#cb15-730" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-731"><a href="#cb15-731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-732"><a href="#cb15-732" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> ext <span class="op">=</span> d3<span class="op">.</span><span class="fu">extent</span>(all)<span class="op">;</span></span>
<span id="cb15-733"><a href="#cb15-733" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> p <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapPalette</span><span class="op">;</span></span>
<span id="cb15-734"><a href="#cb15-734" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(p)) {</span>
<span id="cb15-735"><a href="#cb15-735" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Palette is an array</span></span>
<span id="cb15-736"><a href="#cb15-736" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapColor</span> <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleSequential</span>()</span>
<span id="cb15-737"><a href="#cb15-737" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">domain</span>(<span class="kw">this</span><span class="op">.</span><span class="fu">_series</span>(ext[<span class="dv">0</span>]<span class="op">,</span> ext[<span class="dv">1</span>]<span class="op">,</span> p<span class="op">.</span><span class="at">length</span>))</span>
<span id="cb15-738"><a href="#cb15-738" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">range</span>(p)<span class="op">;</span></span>
<span id="cb15-739"><a href="#cb15-739" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-740"><a href="#cb15-740" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (<span class="kw">typeof</span> p <span class="op">===</span> <span class="st">"function"</span>) {</span>
<span id="cb15-741"><a href="#cb15-741" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Palette is a color interpolator</span></span>
<span id="cb15-742"><a href="#cb15-742" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_heatmapColor</span> <span class="op">=</span> d3<span class="op">.</span><span class="fu">scaleSequential</span>(p)</span>
<span id="cb15-743"><a href="#cb15-743" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">domain</span>(ext)<span class="op">;</span></span>
<span id="cb15-744"><a href="#cb15-744" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-745"><a href="#cb15-745" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-746"><a href="#cb15-746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-747"><a href="#cb15-747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_series</span>(min<span class="op">,</span> max<span class="op">,</span> num) {</span>
<span id="cb15-748"><a href="#cb15-748" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> n <span class="op">=</span> num <span class="op">-</span> <span class="dv">1</span><span class="op">,</span> s <span class="op">=</span> [min]<span class="op">,</span> intrv <span class="op">=</span> max <span class="op">/</span> n<span class="op">;</span></span>
<span id="cb15-749"><a href="#cb15-749" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> i <span class="op">=</span> min<span class="op">;</span></span>
<span id="cb15-750"><a href="#cb15-750" aria-hidden="true" tabindex="-1"></a>        <span class="cf">while</span> (i <span class="op">&lt;</span> max <span class="op">&amp;&amp;</span> s<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> num) {</span>
<span id="cb15-751"><a href="#cb15-751" aria-hidden="true" tabindex="-1"></a>            i <span class="op">+=</span> intrv<span class="op">;</span></span>
<span id="cb15-752"><a href="#cb15-752" aria-hidden="true" tabindex="-1"></a>            s<span class="op">.</span><span class="fu">push</span>(i)<span class="op">;</span></span>
<span id="cb15-753"><a href="#cb15-753" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-754"><a href="#cb15-754" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-755"><a href="#cb15-755" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (s<span class="op">.</span><span class="at">length</span> <span class="op">&lt;</span> num)</span>
<span id="cb15-756"><a href="#cb15-756" aria-hidden="true" tabindex="-1"></a>            s<span class="op">.</span><span class="fu">push</span>(max)<span class="op">;</span></span>
<span id="cb15-757"><a href="#cb15-757" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb15-758"><a href="#cb15-758" aria-hidden="true" tabindex="-1"></a>            s[s<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="dv">1</span>] <span class="op">=</span> max<span class="op">;</span></span>
<span id="cb15-759"><a href="#cb15-759" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-760"><a href="#cb15-760" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> s<span class="op">;</span></span>
<span id="cb15-761"><a href="#cb15-761" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-762"><a href="#cb15-762" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-763"><a href="#cb15-763" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_createClipPaths</span>() {</span>
<span id="cb15-764"><a href="#cb15-764" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> addClipPath <span class="op">=</span> (id<span class="op">,</span> width<span class="op">,</span> height<span class="op">,</span> x<span class="op">,</span> y) <span class="kw">=&gt;</span> {</span>
<span id="cb15-765"><a href="#cb15-765" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> cp <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_g</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"clipPath"</span>)</span>
<span id="cb15-766"><a href="#cb15-766" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"id"</span><span class="op">,</span> <span class="vs">`</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_uniqueId</span><span class="sc">}</span><span class="vs">`</span>)</span>
<span id="cb15-767"><a href="#cb15-767" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb15-768"><a href="#cb15-768" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> width)</span>
<span id="cb15-769"><a href="#cb15-769" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> height)<span class="op">;</span></span>
<span id="cb15-770"><a href="#cb15-770" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-771"><a href="#cb15-771" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (x) cp<span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> x)<span class="op">;</span></span>
<span id="cb15-772"><a href="#cb15-772" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (y) cp<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> y)<span class="op">;</span></span>
<span id="cb15-773"><a href="#cb15-773" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-774"><a href="#cb15-774" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-775"><a href="#cb15-775" aria-hidden="true" tabindex="-1"></a>        <span class="fu">addClipPath</span>(<span class="st">"bodyClip"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span>)<span class="op">;</span></span>
<span id="cb15-776"><a href="#cb15-776" aria-hidden="true" tabindex="-1"></a>        <span class="fu">addClipPath</span>(<span class="st">"headerRowClip"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span> <span class="op">+</span> <span class="dv">1</span><span class="op">,</span> <span class="kw">null</span><span class="op">,</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb15-777"><a href="#cb15-777" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">forEach</span>((column<span class="op">,</span> i) <span class="kw">=&gt;</span> {</span>
<span id="cb15-778"><a href="#cb15-778" aria-hidden="true" tabindex="-1"></a>            <span class="fu">addClipPath</span>(<span class="st">"headerClip"</span> <span class="op">+</span> i<span class="op">,</span> column<span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span>)<span class="op">;</span></span>
<span id="cb15-779"><a href="#cb15-779" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (column<span class="op">.</span><span class="at">isNumber</span>)</span>
<span id="cb15-780"><a href="#cb15-780" aria-hidden="true" tabindex="-1"></a>                <span class="fu">addClipPath</span>(<span class="st">"cellClip"</span> <span class="op">+</span> i<span class="op">,</span> column<span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="op">,</span> <span class="op">-</span>(column<span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span>))<span class="op">;</span></span>
<span id="cb15-781"><a href="#cb15-781" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb15-782"><a href="#cb15-782" aria-hidden="true" tabindex="-1"></a>                <span class="fu">addClipPath</span>(<span class="st">"cellClip"</span> <span class="op">+</span> i<span class="op">,</span> column<span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span>)<span class="op">;</span></span>
<span id="cb15-783"><a href="#cb15-783" aria-hidden="true" tabindex="-1"></a>        })</span>
<span id="cb15-784"><a href="#cb15-784" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-785"><a href="#cb15-785" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-786"><a href="#cb15-786" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_clipPath</span>(id) {</span>
<span id="cb15-787"><a href="#cb15-787" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="vs">`url(#</span><span class="sc">${</span>id<span class="sc">}</span><span class="vs">.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_uniqueId</span><span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb15-788"><a href="#cb15-788" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-789"><a href="#cb15-789" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-790"><a href="#cb15-790" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_createTable</span>() {</span>
<span id="cb15-791"><a href="#cb15-791" aria-hidden="true" tabindex="-1"></a>        <span class="co">// table container</span></span>
<span id="cb15-792"><a href="#cb15-792" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_table</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_g</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb15-793"><a href="#cb15-793" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_left</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_top</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb15-794"><a href="#cb15-794" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"wheel"</span><span class="op">,</span> e <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_scroll</span>(e))</span>
<span id="cb15-795"><a href="#cb15-795" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mousewheel"</span><span class="op">,</span> e <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_scroll</span>(e))</span>
<span id="cb15-796"><a href="#cb15-796" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"DOMMouseScroll"</span><span class="op">,</span> e <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_scroll</span>(e))<span class="op">;</span></span>
<span id="cb15-797"><a href="#cb15-797" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-798"><a href="#cb15-798" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-799"><a href="#cb15-799" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_renderBody</span>() {</span>
<span id="cb15-800"><a href="#cb15-800" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> that <span class="op">=</span> <span class="kw">this</span><span class="op">,</span> style <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">,</span></span>
<span id="cb15-801"><a href="#cb15-801" aria-hidden="true" tabindex="-1"></a>            highlight <span class="op">=</span> style<span class="op">.</span><span class="at">highlight</span> <span class="op">!==</span> <span class="st">"none"</span><span class="op">,</span></span>
<span id="cb15-802"><a href="#cb15-802" aria-hidden="true" tabindex="-1"></a>            cross <span class="op">=</span> style<span class="op">.</span><span class="at">highlight</span> <span class="op">===</span> <span class="st">"cross"</span><span class="op">;</span></span>
<span id="cb15-803"><a href="#cb15-803" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-804"><a href="#cb15-804" aria-hidden="true" tabindex="-1"></a>        <span class="co">// table body container</span></span>
<span id="cb15-805"><a href="#cb15-805" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> bodyBox <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_table</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"clip-path"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_clipPath</span>(<span class="st">"bodyClip"</span>))<span class="op">;</span></span>
<span id="cb15-806"><a href="#cb15-806" aria-hidden="true" tabindex="-1"></a>        <span class="co">// inner container of the table body, y is controlled by vertical scrollbar and its content is clipped by bodyClip  </span></span>
<span id="cb15-807"><a href="#cb15-807" aria-hidden="true" tabindex="-1"></a>        <span class="co">// it contains two parts: dataArea which is horizontally moveable and fixed columns on the left</span></span>
<span id="cb15-808"><a href="#cb15-808" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> body <span class="op">=</span> bodyBox<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb15-809"><a href="#cb15-809" aria-hidden="true" tabindex="-1"></a>        <span class="co">// container of the moveable part of the body</span></span>
<span id="cb15-810"><a href="#cb15-810" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dataArea <span class="op">=</span> body<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb15-811"><a href="#cb15-811" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb15-812"><a href="#cb15-812" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-813"><a href="#cb15-813" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> rows <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)<span class="op">;</span></span>
<span id="cb15-814"><a href="#cb15-814" aria-hidden="true" tabindex="-1"></a>        <span class="co">//if (this._dataIsArray) rows.forEach(r =&gt; r[0].origin = r);</span></span>
<span id="cb15-815"><a href="#cb15-815" aria-hidden="true" tabindex="-1"></a>        <span class="co">// moveable part of the body, x is controlled by horizontal scrollbar</span></span>
<span id="cb15-816"><a href="#cb15-816" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> cell <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addRows</span>(</span>
<span id="cb15-817"><a href="#cb15-817" aria-hidden="true" tabindex="-1"></a>            dataArea<span class="op">,</span></span>
<span id="cb15-818"><a href="#cb15-818" aria-hidden="true" tabindex="-1"></a>            <span class="st">"row"</span><span class="op">,</span></span>
<span id="cb15-819"><a href="#cb15-819" aria-hidden="true" tabindex="-1"></a>            () <span class="kw">=&gt;</span> rows<span class="op">,</span></span>
<span id="cb15-820"><a href="#cb15-820" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">.</span><span class="fu">map</span>((c<span class="op">,</span> j) <span class="kw">=&gt;</span> {</span>
<span id="cb15-821"><a href="#cb15-821" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> {</span>
<span id="cb15-822"><a href="#cb15-822" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">rowIndex</span><span class="op">:</span> i <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span><span class="op">,</span></span>
<span id="cb15-823"><a href="#cb15-823" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">column</span><span class="op">:</span> c<span class="op">,</span></span>
<span id="cb15-824"><a href="#cb15-824" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">value</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span> d[c<span class="op">.</span><span class="at">index</span>] <span class="op">:</span> d[c<span class="op">.</span><span class="at">name</span>]</span>
<span id="cb15-825"><a href="#cb15-825" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb15-826"><a href="#cb15-826" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb15-827"><a href="#cb15-827" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`translate(0,</span><span class="sc">${</span>i <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb15-828"><a href="#cb15-828" aria-hidden="true" tabindex="-1"></a>            d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">tx</span><span class="sc">}</span><span class="vs">,0)`</span><span class="op">,</span></span>
<span id="cb15-829"><a href="#cb15-829" aria-hidden="true" tabindex="-1"></a>            g <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addCell</span>(g<span class="op">,</span> style<span class="op">.</span><span class="at">background</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>))</span>
<span id="cb15-830"><a href="#cb15-830" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> click)</span>
<span id="cb15-831"><a href="#cb15-831" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"contextmenu"</span><span class="op">,</span> contextmenu)</span>
<span id="cb15-832"><a href="#cb15-832" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseover"</span><span class="op">,</span> mouseover)</span>
<span id="cb15-833"><a href="#cb15-833" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"mouseleave"</span><span class="op">,</span> mouseleave)<span class="op">;</span></span>
<span id="cb15-834"><a href="#cb15-834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-835"><a href="#cb15-835" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> fixedCell<span class="op">;</span></span>
<span id="cb15-836"><a href="#cb15-836" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>) {</span>
<span id="cb15-837"><a href="#cb15-837" aria-hidden="true" tabindex="-1"></a>            <span class="co">// fixed columns on the left</span></span>
<span id="cb15-838"><a href="#cb15-838" aria-hidden="true" tabindex="-1"></a>            fixedCell <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addRows</span>(</span>
<span id="cb15-839"><a href="#cb15-839" aria-hidden="true" tabindex="-1"></a>                body<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">,</span></span>
<span id="cb15-840"><a href="#cb15-840" aria-hidden="true" tabindex="-1"></a>                <span class="st">"row"</span><span class="op">,</span></span>
<span id="cb15-841"><a href="#cb15-841" aria-hidden="true" tabindex="-1"></a>                () <span class="kw">=&gt;</span> rows<span class="op">.</span><span class="fu">map</span>((r<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">.</span><span class="fu">map</span>((c<span class="op">,</span> j) <span class="kw">=&gt;</span> ({</span>
<span id="cb15-842"><a href="#cb15-842" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">origin</span><span class="op">:</span> r<span class="op">,</span> <span class="co">// for sort to get the index of data</span></span>
<span id="cb15-843"><a href="#cb15-843" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">rowIndex</span><span class="op">:</span> i <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span><span class="op">,</span></span>
<span id="cb15-844"><a href="#cb15-844" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">column</span><span class="op">:</span> c<span class="op">,</span></span>
<span id="cb15-845"><a href="#cb15-845" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">value</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span> r[c<span class="op">.</span><span class="at">index</span>] <span class="op">:</span> r[c<span class="op">.</span><span class="at">name</span>]</span>
<span id="cb15-846"><a href="#cb15-846" aria-hidden="true" tabindex="-1"></a>                })))<span class="op">,</span></span>
<span id="cb15-847"><a href="#cb15-847" aria-hidden="true" tabindex="-1"></a>                d <span class="kw">=&gt;</span> d<span class="op">,</span></span>
<span id="cb15-848"><a href="#cb15-848" aria-hidden="true" tabindex="-1"></a>                (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`translate(0,</span><span class="sc">${</span>i <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb15-849"><a href="#cb15-849" aria-hidden="true" tabindex="-1"></a>                d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">tx</span><span class="sc">}</span><span class="vs">,0)`</span><span class="op">,</span></span>
<span id="cb15-850"><a href="#cb15-850" aria-hidden="true" tabindex="-1"></a>                g <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addCell</span>(g<span class="op">,</span> style<span class="op">.</span><span class="at">fixedBackground</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">true</span>))<span class="op">;</span></span>
<span id="cb15-851"><a href="#cb15-851" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-852"><a href="#cb15-852" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-853"><a href="#cb15-853" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_body</span> <span class="op">=</span> body<span class="op">;</span></span>
<span id="cb15-854"><a href="#cb15-854" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataArea</span> <span class="op">=</span> dataArea<span class="op">;</span></span>
<span id="cb15-855"><a href="#cb15-855" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-856"><a href="#cb15-856" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> test <span class="op">=</span> cross <span class="op">?</span></span>
<span id="cb15-857"><a href="#cb15-857" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> cell) <span class="kw">=&gt;</span> cell<span class="op">.</span><span class="at">rowIndex</span> <span class="op">===</span> d<span class="op">.</span><span class="at">rowIndex</span> <span class="op">||</span> cell<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span> <span class="op">===</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span> <span class="op">:</span></span>
<span id="cb15-858"><a href="#cb15-858" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> cell) <span class="kw">=&gt;</span> cell<span class="op">.</span><span class="at">rowIndex</span> <span class="op">===</span> d<span class="op">.</span><span class="at">rowIndex</span> <span class="op">&amp;&amp;</span> cell<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span> <span class="op">===</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span><span class="op">;</span></span>
<span id="cb15-859"><a href="#cb15-859" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-860"><a href="#cb15-860" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)<span class="op">.</span><span class="fu">on</span>(<span class="vs">`keydown.eric.svgtable.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_uniqueId</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> keypress)<span class="op">;</span></span>
<span id="cb15-861"><a href="#cb15-861" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-862"><a href="#cb15-862" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">keypress</span>(e) {</span>
<span id="cb15-863"><a href="#cb15-863" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (e<span class="op">.</span><span class="at">key</span> <span class="op">===</span> <span class="st">"Escape"</span>) that<span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-864"><a href="#cb15-864" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-865"><a href="#cb15-865" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-866"><a href="#cb15-866" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">click</span>(e<span class="op">,</span> d) {</span>
<span id="cb15-867"><a href="#cb15-867" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (that<span class="op">.</span><span class="at">_focus</span> <span class="op">!==</span> d) {</span>
<span id="cb15-868"><a href="#cb15-868" aria-hidden="true" tabindex="-1"></a>                that<span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-869"><a href="#cb15-869" aria-hidden="true" tabindex="-1"></a>                <span class="fu">mouseover</span>(e<span class="op">,</span> d)<span class="op">;</span></span>
<span id="cb15-870"><a href="#cb15-870" aria-hidden="true" tabindex="-1"></a>                that<span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb15-871"><a href="#cb15-871" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-872"><a href="#cb15-872" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb15-873"><a href="#cb15-873" aria-hidden="true" tabindex="-1"></a>                that<span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-874"><a href="#cb15-874" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-875"><a href="#cb15-875" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (that<span class="op">.</span><span class="at">_onclick</span>) that<span class="op">.</span><span class="fu">_onclick</span>(e<span class="op">,</span> d)<span class="op">;</span></span>
<span id="cb15-876"><a href="#cb15-876" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-877"><a href="#cb15-877" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-878"><a href="#cb15-878" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">contextmenu</span>(e<span class="op">,</span> d) {</span>
<span id="cb15-879"><a href="#cb15-879" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (that<span class="op">.</span><span class="at">_oncontextmenu</span>) {</span>
<span id="cb15-880"><a href="#cb15-880" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (that<span class="op">.</span><span class="at">_focus</span> <span class="op">!==</span> d) {</span>
<span id="cb15-881"><a href="#cb15-881" aria-hidden="true" tabindex="-1"></a>                    that<span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb15-882"><a href="#cb15-882" aria-hidden="true" tabindex="-1"></a>                    <span class="fu">mouseover</span>(e<span class="op">,</span> d)<span class="op">;</span></span>
<span id="cb15-883"><a href="#cb15-883" aria-hidden="true" tabindex="-1"></a>                    that<span class="op">.</span><span class="at">_focus</span> <span class="op">=</span> d<span class="op">;</span></span>
<span id="cb15-884"><a href="#cb15-884" aria-hidden="true" tabindex="-1"></a>                    that<span class="op">.</span><span class="fu">_oncontextmenu</span>(e<span class="op">,</span> d)<span class="op">;</span></span>
<span id="cb15-885"><a href="#cb15-885" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb15-886"><a href="#cb15-886" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb15-887"><a href="#cb15-887" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-888"><a href="#cb15-888" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-889"><a href="#cb15-889" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-890"><a href="#cb15-890" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">mouseover</span>(e<span class="op">,</span> d) {</span>
<span id="cb15-891"><a href="#cb15-891" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span>highlight <span class="op">||</span> that<span class="op">.</span><span class="at">_focus</span>) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb15-892"><a href="#cb15-892" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-893"><a href="#cb15-893" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> r <span class="op">=</span> cell<span class="op">.</span><span class="fu">select</span>(<span class="st">"rect"</span>)</span>
<span id="cb15-894"><a href="#cb15-894" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">datum</span>(cell <span class="kw">=&gt;</span> <span class="fu">test</span>(d<span class="op">,</span> cell) <span class="op">?</span> style<span class="op">.</span><span class="at">highlightBackground</span> <span class="op">:</span> that<span class="op">.</span><span class="fu">_cellColor</span>(cell<span class="op">,</span> style<span class="op">.</span><span class="at">background</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">false</span>))</span>
<span id="cb15-895"><a href="#cb15-895" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb15-896"><a href="#cb15-896" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span>that<span class="op">.</span><span class="at">_style</span><span class="op">.</span><span class="at">border</span>) r<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d)<span class="op">;</span></span>
<span id="cb15-897"><a href="#cb15-897" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-898"><a href="#cb15-898" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (fixedCell) fixedCell<span class="op">.</span><span class="fu">select</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> cell <span class="kw">=&gt;</span> cell<span class="op">.</span><span class="at">rowIndex</span> <span class="op">===</span> d<span class="op">.</span><span class="at">rowIndex</span> <span class="op">?</span> <span class="st">"bold"</span> <span class="op">:</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb15-899"><a href="#cb15-899" aria-hidden="true" tabindex="-1"></a>            that<span class="op">.</span><span class="at">_dataHeader</span><span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> cell <span class="kw">=&gt;</span> cell<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span> <span class="op">===</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span> <span class="op">?</span> <span class="st">"bold"</span> <span class="op">:</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb15-900"><a href="#cb15-900" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-901"><a href="#cb15-901" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (that<span class="op">.</span><span class="at">_onhighlight</span>) {</span>
<span id="cb15-902"><a href="#cb15-902" aria-hidden="true" tabindex="-1"></a>                that<span class="op">.</span><span class="fu">_onhighlight</span>(e<span class="op">,</span> {</span>
<span id="cb15-903"><a href="#cb15-903" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">cell</span><span class="op">:</span> d<span class="op">,</span></span>
<span id="cb15-904"><a href="#cb15-904" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">column</span><span class="op">:</span> d<span class="op">.</span><span class="at">column</span><span class="op">,</span></span>
<span id="cb15-905"><a href="#cb15-905" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">getRow</span><span class="op">:</span> () <span class="kw">=&gt;</span> that<span class="op">.</span><span class="fu">getRowData</span>(d<span class="op">.</span><span class="at">rowIndex</span>)<span class="op">,</span></span>
<span id="cb15-906"><a href="#cb15-906" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">getColumn</span><span class="op">:</span> () <span class="kw">=&gt;</span> that<span class="op">.</span><span class="fu">getColumnData</span>(d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span>)</span>
<span id="cb15-907"><a href="#cb15-907" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb15-908"><a href="#cb15-908" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-909"><a href="#cb15-909" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-910"><a href="#cb15-910" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-911"><a href="#cb15-911" aria-hidden="true" tabindex="-1"></a>        <span class="kw">function</span> <span class="fu">mouseleave</span>() {</span>
<span id="cb15-912"><a href="#cb15-912" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span>highlight <span class="op">||</span> that<span class="op">.</span><span class="at">_focus</span>) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb15-913"><a href="#cb15-913" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-914"><a href="#cb15-914" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> r <span class="op">=</span> cell<span class="op">.</span><span class="fu">select</span>(<span class="st">"rect"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> that<span class="op">.</span><span class="fu">_cellColor</span>(d<span class="op">,</span> style<span class="op">.</span><span class="at">background</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">false</span>))<span class="op">;</span></span>
<span id="cb15-915"><a href="#cb15-915" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span>that<span class="op">.</span><span class="at">_style</span><span class="op">.</span><span class="at">border</span>) r<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> that<span class="op">.</span><span class="fu">_cellColor</span>(d<span class="op">,</span> style<span class="op">.</span><span class="at">background</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">false</span>))<span class="op">;</span></span>
<span id="cb15-916"><a href="#cb15-916" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-917"><a href="#cb15-917" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (fixedCell) fixedCell<span class="op">.</span><span class="fu">select</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb15-918"><a href="#cb15-918" aria-hidden="true" tabindex="-1"></a>            that<span class="op">.</span><span class="at">_dataHeader</span><span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"font-weight"</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span></span>
<span id="cb15-919"><a href="#cb15-919" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-920"><a href="#cb15-920" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-921"><a href="#cb15-921" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-922"><a href="#cb15-922" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_updateHeatmap</span>() {</span>
<span id="cb15-923"><a href="#cb15-923" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> bg <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">.</span><span class="at">background</span><span class="op">;</span></span>
<span id="cb15-924"><a href="#cb15-924" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> rects <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataArea</span><span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)<span class="op">;</span></span>
<span id="cb15-925"><a href="#cb15-925" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span>) {</span>
<span id="cb15-926"><a href="#cb15-926" aria-hidden="true" tabindex="-1"></a>            rects<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_cellColor</span>(d<span class="op">,</span> bg<span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">false</span>))<span class="op">;</span></span>
<span id="cb15-927"><a href="#cb15-927" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">.</span><span class="at">border</span>) rects<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_cellColor</span>(d<span class="op">,</span> bg<span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">false</span>))<span class="op">;</span></span>
<span id="cb15-928"><a href="#cb15-928" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-929"><a href="#cb15-929" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-930"><a href="#cb15-930" aria-hidden="true" tabindex="-1"></a>            rects<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> bg)<span class="op">;</span></span>
<span id="cb15-931"><a href="#cb15-931" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span><span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">.</span><span class="at">border</span>) rects<span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> bg)<span class="op">;</span></span>
<span id="cb15-932"><a href="#cb15-932" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-933"><a href="#cb15-933" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-934"><a href="#cb15-934" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-935"><a href="#cb15-935" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_renderHeader</span>(g) {</span>
<span id="cb15-936"><a href="#cb15-936" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> style <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">;</span></span>
<span id="cb15-937"><a href="#cb15-937" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-938"><a href="#cb15-938" aria-hidden="true" tabindex="-1"></a>        <span class="co">// fixed rows sliced from this._data</span></span>
<span id="cb15-939"><a href="#cb15-939" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> rows <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)<span class="op">;</span></span>
<span id="cb15-940"><a href="#cb15-940" aria-hidden="true" tabindex="-1"></a>        <span class="co">// header container</span></span>
<span id="cb15-941"><a href="#cb15-941" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> header <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb15-942"><a href="#cb15-942" aria-hidden="true" tabindex="-1"></a>        <span class="co">// top-left cells which are always fixed if fixedColumns is specified</span></span>
<span id="cb15-943"><a href="#cb15-943" aria-hidden="true" tabindex="-1"></a>        header<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".column"</span>)</span>
<span id="cb15-944"><a href="#cb15-944" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Unify the the data structure make it compatible with addCell</span></span>
<span id="cb15-945"><a href="#cb15-945" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">data</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span> ({</span>
<span id="cb15-946"><a href="#cb15-946" aria-hidden="true" tabindex="-1"></a>                <span class="dt">column</span><span class="op">:</span> d</span>
<span id="cb15-947"><a href="#cb15-947" aria-hidden="true" tabindex="-1"></a>            })))</span>
<span id="cb15-948"><a href="#cb15-948" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb15-949"><a href="#cb15-949" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"column"</span>)</span>
<span id="cb15-950"><a href="#cb15-950" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">tx</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb15-951"><a href="#cb15-951" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addCell</span>(g<span class="op">,</span> style<span class="op">.</span><span class="at">headerBackground</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>))</span>
<span id="cb15-952"><a href="#cb15-952" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> (e<span class="op">,</span> d) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sort</span>(d))<span class="op">;</span></span>
<span id="cb15-953"><a href="#cb15-953" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-954"><a href="#cb15-954" aria-hidden="true" tabindex="-1"></a>        <span class="co">// fixed data cells in the fixed columns section</span></span>
<span id="cb15-955"><a href="#cb15-955" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>) {</span>
<span id="cb15-956"><a href="#cb15-956" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_addRows</span>(</span>
<span id="cb15-957"><a href="#cb15-957" aria-hidden="true" tabindex="-1"></a>                header<span class="op">,</span></span>
<span id="cb15-958"><a href="#cb15-958" aria-hidden="true" tabindex="-1"></a>                <span class="st">"fixedRow"</span><span class="op">,</span></span>
<span id="cb15-959"><a href="#cb15-959" aria-hidden="true" tabindex="-1"></a>                () <span class="kw">=&gt;</span> rows<span class="op">.</span><span class="fu">map</span>((r<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">.</span><span class="fu">map</span>((c<span class="op">,</span> j) <span class="kw">=&gt;</span> ({</span>
<span id="cb15-960"><a href="#cb15-960" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">rowIndex</span><span class="op">:</span> i<span class="op">,</span></span>
<span id="cb15-961"><a href="#cb15-961" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">column</span><span class="op">:</span> c<span class="op">,</span></span>
<span id="cb15-962"><a href="#cb15-962" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">value</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span> r[c<span class="op">.</span><span class="at">index</span>] <span class="op">:</span> r[c<span class="op">.</span><span class="at">name</span>]</span>
<span id="cb15-963"><a href="#cb15-963" aria-hidden="true" tabindex="-1"></a>                })))<span class="op">,</span></span>
<span id="cb15-964"><a href="#cb15-964" aria-hidden="true" tabindex="-1"></a>                d <span class="kw">=&gt;</span> d<span class="op">,</span></span>
<span id="cb15-965"><a href="#cb15-965" aria-hidden="true" tabindex="-1"></a>                (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`translate(0,</span><span class="sc">${</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb15-966"><a href="#cb15-966" aria-hidden="true" tabindex="-1"></a>                d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">tx</span><span class="sc">}</span><span class="vs">,0)`</span><span class="op">,</span></span>
<span id="cb15-967"><a href="#cb15-967" aria-hidden="true" tabindex="-1"></a>                g <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addCell</span>(g<span class="op">,</span> style<span class="op">.</span><span class="at">fixedBackground</span><span class="op">,</span> <span class="dv">0</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">true</span>))<span class="op">;</span></span>
<span id="cb15-968"><a href="#cb15-968" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-969"><a href="#cb15-969" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-970"><a href="#cb15-970" aria-hidden="true" tabindex="-1"></a>        <span class="co">// the container of the rest of the header cells, its content is clipped by headerClip</span></span>
<span id="cb15-971"><a href="#cb15-971" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> headerBox <span class="op">=</span> header<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb15-972"><a href="#cb15-972" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"clip-path"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_clipPath</span>(<span class="st">"headerRowClip"</span>))</span>
<span id="cb15-973"><a href="#cb15-973" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb15-974"><a href="#cb15-974" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-975"><a href="#cb15-975" aria-hidden="true" tabindex="-1"></a>        <span class="co">// horizontally moveable part of the header, x is controlled by and synchronized with horizontal scrollbar</span></span>
<span id="cb15-976"><a href="#cb15-976" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> dataHeader <span class="op">=</span> headerBox<span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb15-977"><a href="#cb15-977" aria-hidden="true" tabindex="-1"></a>        dataHeader<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".column"</span>)</span>
<span id="cb15-978"><a href="#cb15-978" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Unify the the data structure make it compatible with addCell</span></span>
<span id="cb15-979"><a href="#cb15-979" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">data</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">.</span><span class="fu">map</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span> ({</span>
<span id="cb15-980"><a href="#cb15-980" aria-hidden="true" tabindex="-1"></a>                <span class="dt">column</span><span class="op">:</span> d</span>
<span id="cb15-981"><a href="#cb15-981" aria-hidden="true" tabindex="-1"></a>            })))</span>
<span id="cb15-982"><a href="#cb15-982" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb15-983"><a href="#cb15-983" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"column"</span>)</span>
<span id="cb15-984"><a href="#cb15-984" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">tx</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb15-985"><a href="#cb15-985" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addCell</span>(g<span class="op">,</span> style<span class="op">.</span><span class="at">headerBackground</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> <span class="kw">true</span>))</span>
<span id="cb15-986"><a href="#cb15-986" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> (e<span class="op">,</span> d) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sort</span>(d))<span class="op">;</span></span>
<span id="cb15-987"><a href="#cb15-987" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-988"><a href="#cb15-988" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_addRows</span>(</span>
<span id="cb15-989"><a href="#cb15-989" aria-hidden="true" tabindex="-1"></a>            dataHeader<span class="op">,</span></span>
<span id="cb15-990"><a href="#cb15-990" aria-hidden="true" tabindex="-1"></a>            <span class="st">"fixedRow"</span><span class="op">,</span></span>
<span id="cb15-991"><a href="#cb15-991" aria-hidden="true" tabindex="-1"></a>            () <span class="kw">=&gt;</span> rows<span class="op">,</span></span>
<span id="cb15-992"><a href="#cb15-992" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">.</span><span class="fu">map</span>((c<span class="op">,</span> j) <span class="kw">=&gt;</span> {</span>
<span id="cb15-993"><a href="#cb15-993" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> {</span>
<span id="cb15-994"><a href="#cb15-994" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">rowIndex</span><span class="op">:</span> i<span class="op">,</span></span>
<span id="cb15-995"><a href="#cb15-995" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">column</span><span class="op">:</span> c<span class="op">,</span></span>
<span id="cb15-996"><a href="#cb15-996" aria-hidden="true" tabindex="-1"></a>                    <span class="dt">value</span><span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span> d[c<span class="op">.</span><span class="at">index</span>] <span class="op">:</span> d[c<span class="op">.</span><span class="at">name</span>]</span>
<span id="cb15-997"><a href="#cb15-997" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb15-998"><a href="#cb15-998" aria-hidden="true" tabindex="-1"></a>            })<span class="op">,</span></span>
<span id="cb15-999"><a href="#cb15-999" aria-hidden="true" tabindex="-1"></a>            (d<span class="op">,</span> i) <span class="kw">=&gt;</span> <span class="vs">`translate(0,</span><span class="sc">${</span>(i <span class="op">+</span> <span class="dv">1</span>) <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="sc">}</span><span class="vs">)`</span><span class="op">,</span></span>
<span id="cb15-1000"><a href="#cb15-1000" aria-hidden="true" tabindex="-1"></a>            d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">tx</span><span class="sc">}</span><span class="vs">,0)`</span><span class="op">,</span></span>
<span id="cb15-1001"><a href="#cb15-1001" aria-hidden="true" tabindex="-1"></a>            g <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addCell</span>(g<span class="op">,</span> style<span class="op">.</span><span class="at">fixedBackground</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> <span class="kw">true</span>)</span>
<span id="cb15-1002"><a href="#cb15-1002" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb15-1003"><a href="#cb15-1003" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1004"><a href="#cb15-1004" aria-hidden="true" tabindex="-1"></a>        <span class="co">// a fixed line for seperating header and body</span></span>
<span id="cb15-1005"><a href="#cb15-1005" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb15-1006"><a href="#cb15-1006" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> style<span class="op">.</span><span class="at">borderColor</span>)</span>
<span id="cb15-1007"><a href="#cb15-1007" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb15-1008"><a href="#cb15-1008" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span>)</span>
<span id="cb15-1009"><a href="#cb15-1009" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span>)</span>
<span id="cb15-1010"><a href="#cb15-1010" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span>)<span class="op">;</span></span>
<span id="cb15-1011"><a href="#cb15-1011" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1012"><a href="#cb15-1012" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_header</span> <span class="op">=</span> header<span class="op">;</span></span>
<span id="cb15-1013"><a href="#cb15-1013" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataHeader</span> <span class="op">=</span> dataHeader<span class="op">;</span></span>
<span id="cb15-1014"><a href="#cb15-1014" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1015"><a href="#cb15-1015" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1016"><a href="#cb15-1016" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_sort</span>(d) {</span>
<span id="cb15-1017"><a href="#cb15-1017" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> sorted <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sortData</span>(d<span class="op">.</span><span class="at">column</span>)<span class="op">;</span></span>
<span id="cb15-1018"><a href="#cb15-1018" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1019"><a href="#cb15-1019" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_rowsPerPage</span>) {</span>
<span id="cb15-1020"><a href="#cb15-1020" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> x <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getX</span>()<span class="op">,</span> y <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getY</span>()<span class="op">;</span></span>
<span id="cb15-1021"><a href="#cb15-1021" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_pageData</span>()<span class="op">;</span></span>
<span id="cb15-1022"><a href="#cb15-1022" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_rerender</span>()<span class="op">;</span></span>
<span id="cb15-1023"><a href="#cb15-1023" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_moveX</span>(x)<span class="op">;</span></span>
<span id="cb15-1024"><a href="#cb15-1024" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_moveY</span>(y)<span class="op">;</span></span>
<span id="cb15-1025"><a href="#cb15-1025" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onsort</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_onsort</span>(d<span class="op">.</span><span class="at">column</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span> <span class="op">!==</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb15-1026"><a href="#cb15-1026" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1027"><a href="#cb15-1027" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-1028"><a href="#cb15-1028" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> f <span class="op">=</span> <span class="dv">250</span> <span class="op">/</span> sorted<span class="op">.</span><span class="at">length</span><span class="op">;</span></span>
<span id="cb15-1029"><a href="#cb15-1029" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_table</span><span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".row"</span>)</span>
<span id="cb15-1030"><a href="#cb15-1030" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">transition</span>()</span>
<span id="cb15-1031"><a href="#cb15-1031" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">duration</span>((d<span class="op">,</span> i) <span class="kw">=&gt;</span> i <span class="op">*</span> f)</span>
<span id="cb15-1032"><a href="#cb15-1032" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">ease</span>(d3<span class="op">.</span><span class="at">easeBounce</span>)</span>
<span id="cb15-1033"><a href="#cb15-1033" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> {</span>
<span id="cb15-1034"><a href="#cb15-1034" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">const</span> i <span class="op">=</span> <span class="bu">Array</span><span class="op">.</span><span class="fu">isArray</span>(d) <span class="op">&amp;&amp;</span> d[<span class="dv">0</span>]<span class="op">.</span><span class="at">origin</span> <span class="op">!==</span> <span class="kw">undefined</span> <span class="op">?</span> sorted<span class="op">.</span><span class="fu">indexOf</span>(d[<span class="dv">0</span>]<span class="op">.</span><span class="at">origin</span>) <span class="op">:</span> sorted<span class="op">.</span><span class="fu">indexOf</span>(d)<span class="op">;</span></span>
<span id="cb15-1035"><a href="#cb15-1035" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">return</span> <span class="vs">`translate(0,</span><span class="sc">${</span>i <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="sc">}</span><span class="vs">)`</span><span class="op">;</span></span>
<span id="cb15-1036"><a href="#cb15-1036" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb15-1037"><a href="#cb15-1037" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1038"><a href="#cb15-1038" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1039"><a href="#cb15-1039" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> cg <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_header</span><span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".column"</span>)<span class="op">;</span></span>
<span id="cb15-1040"><a href="#cb15-1040" aria-hidden="true" tabindex="-1"></a>        cg<span class="op">.</span><span class="fu">select</span>(<span class="st">".asc"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> _ <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span> <span class="op">===</span> _<span class="op">.</span><span class="at">column</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">?</span> <span class="st">"#777"</span> <span class="op">:</span> <span class="st">"#bbb"</span>)<span class="op">;</span></span>
<span id="cb15-1041"><a href="#cb15-1041" aria-hidden="true" tabindex="-1"></a>        cg<span class="op">.</span><span class="fu">select</span>(<span class="st">".desc"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> _ <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span> <span class="op">===</span> _<span class="op">.</span><span class="at">column</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">2</span> <span class="op">?</span> <span class="st">"#777"</span> <span class="op">:</span> <span class="st">"#bbb"</span>)<span class="op">;</span></span>
<span id="cb15-1042"><a href="#cb15-1042" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1043"><a href="#cb15-1043" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1044"><a href="#cb15-1044" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_sortData</span>(column) {</span>
<span id="cb15-1045"><a href="#cb15-1045" aria-hidden="true" tabindex="-1"></a>        <span class="co">//var sorted = [...this._data].slice(this._fixedRows);</span></span>
<span id="cb15-1046"><a href="#cb15-1046" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> fixed<span class="op">,</span> sorted<span class="op">;</span></span>
<span id="cb15-1047"><a href="#cb15-1047" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_paginator</span>) {</span>
<span id="cb15-1048"><a href="#cb15-1048" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb15-1049"><a href="#cb15-1049" aria-hidden="true" tabindex="-1"></a>                fixed <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="fu">slice</span>(<span class="dv">0</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)<span class="op">;</span></span>
<span id="cb15-1050"><a href="#cb15-1050" aria-hidden="true" tabindex="-1"></a>                sorted <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)<span class="op">;</span></span>
<span id="cb15-1051"><a href="#cb15-1051" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-1052"><a href="#cb15-1052" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb15-1053"><a href="#cb15-1053" aria-hidden="true" tabindex="-1"></a>                sorted <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span><span class="op">;</span></span>
<span id="cb15-1054"><a href="#cb15-1054" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1055"><a href="#cb15-1055" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-1056"><a href="#cb15-1056" aria-hidden="true" tabindex="-1"></a>            sorted <span class="op">=</span> [<span class="op">...</span><span class="kw">this</span><span class="op">.</span><span class="at">_data</span>]<span class="op">.</span><span class="fu">slice</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>)<span class="op">;</span></span>
<span id="cb15-1057"><a href="#cb15-1057" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1058"><a href="#cb15-1058" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1059"><a href="#cb15-1059" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_columns</span><span class="op">.</span><span class="fu">resetOrder</span>(column)<span class="op">;</span></span>
<span id="cb15-1060"><a href="#cb15-1060" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (column<span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">0</span>)</span>
<span id="cb15-1061"><a href="#cb15-1061" aria-hidden="true" tabindex="-1"></a>            column<span class="op">.</span><span class="at">order</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb15-1062"><a href="#cb15-1062" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (column<span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">1</span>)</span>
<span id="cb15-1063"><a href="#cb15-1063" aria-hidden="true" tabindex="-1"></a>            column<span class="op">.</span><span class="at">order</span> <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb15-1064"><a href="#cb15-1064" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb15-1065"><a href="#cb15-1065" aria-hidden="true" tabindex="-1"></a>            column<span class="op">.</span><span class="at">order</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb15-1066"><a href="#cb15-1066" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1067"><a href="#cb15-1067" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> index <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_dataIsArray</span> <span class="op">?</span> column<span class="op">.</span><span class="at">index</span> <span class="op">:</span> column<span class="op">.</span><span class="at">name</span><span class="op">;</span></span>
<span id="cb15-1068"><a href="#cb15-1068" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1069"><a href="#cb15-1069" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (column<span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">0</span>) {</span>
<span id="cb15-1070"><a href="#cb15-1070" aria-hidden="true" tabindex="-1"></a>            sorted<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> <span class="op">-</span><span class="dv">1</span>)<span class="op">;</span></span>
<span id="cb15-1071"><a href="#cb15-1071" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1072"><a href="#cb15-1072" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (column<span class="op">.</span><span class="at">isNumber</span>) {</span>
<span id="cb15-1073"><a href="#cb15-1073" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (column<span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">1</span>)</span>
<span id="cb15-1074"><a href="#cb15-1074" aria-hidden="true" tabindex="-1"></a>                sorted<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a[index] <span class="op">-</span> b[index])<span class="op">;</span></span>
<span id="cb15-1075"><a href="#cb15-1075" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb15-1076"><a href="#cb15-1076" aria-hidden="true" tabindex="-1"></a>                sorted<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> b[index] <span class="op">-</span> a[index])<span class="op">;</span></span>
<span id="cb15-1077"><a href="#cb15-1077" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1078"><a href="#cb15-1078" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-1079"><a href="#cb15-1079" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (column<span class="op">.</span><span class="at">order</span> <span class="op">===</span> <span class="dv">1</span>)</span>
<span id="cb15-1080"><a href="#cb15-1080" aria-hidden="true" tabindex="-1"></a>                sorted<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> a[index]<span class="op">.</span><span class="fu">localeCompare</span>(b[index]))<span class="op">;</span></span>
<span id="cb15-1081"><a href="#cb15-1081" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb15-1082"><a href="#cb15-1082" aria-hidden="true" tabindex="-1"></a>                sorted<span class="op">.</span><span class="fu">sort</span>((a<span class="op">,</span> b) <span class="kw">=&gt;</span> b[index]<span class="op">.</span><span class="fu">localeCompare</span>(a[index]))<span class="op">;</span></span>
<span id="cb15-1083"><a href="#cb15-1083" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1084"><a href="#cb15-1084" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1085"><a href="#cb15-1085" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (fixed) <span class="kw">this</span><span class="op">.</span><span class="at">_fullData</span> <span class="op">=</span> fixed<span class="op">.</span><span class="fu">concat</span>(sorted)<span class="op">;</span></span>
<span id="cb15-1086"><a href="#cb15-1086" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1087"><a href="#cb15-1087" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> sorted<span class="op">;</span></span>
<span id="cb15-1088"><a href="#cb15-1088" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1089"><a href="#cb15-1089" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1090"><a href="#cb15-1090" aria-hidden="true" tabindex="-1"></a>    <span class="co">// rows: data function for rows</span></span>
<span id="cb15-1091"><a href="#cb15-1091" aria-hidden="true" tabindex="-1"></a>    <span class="co">// columns: data function for columns</span></span>
<span id="cb15-1092"><a href="#cb15-1092" aria-hidden="true" tabindex="-1"></a>    <span class="co">// rt: row translate function</span></span>
<span id="cb15-1093"><a href="#cb15-1093" aria-hidden="true" tabindex="-1"></a>    <span class="co">// ct: column translate function</span></span>
<span id="cb15-1094"><a href="#cb15-1094" aria-hidden="true" tabindex="-1"></a>    <span class="co">// cell: cell function</span></span>
<span id="cb15-1095"><a href="#cb15-1095" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addRows</span>(g<span class="op">,</span> className<span class="op">,</span> rows<span class="op">,</span> columns<span class="op">,</span> rt<span class="op">,</span> ct<span class="op">,</span> cell) {</span>
<span id="cb15-1096"><a href="#cb15-1096" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> g<span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"."</span> <span class="op">+</span> className)</span>
<span id="cb15-1097"><a href="#cb15-1097" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">data</span>(rows)</span>
<span id="cb15-1098"><a href="#cb15-1098" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb15-1099"><a href="#cb15-1099" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> className)</span>
<span id="cb15-1100"><a href="#cb15-1100" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> rt)</span>
<span id="cb15-1101"><a href="#cb15-1101" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">".cell"</span>)</span>
<span id="cb15-1102"><a href="#cb15-1102" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">data</span>(columns)</span>
<span id="cb15-1103"><a href="#cb15-1103" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">join</span>(<span class="st">"g"</span>)</span>
<span id="cb15-1104"><a href="#cb15-1104" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"cell"</span>)</span>
<span id="cb15-1105"><a href="#cb15-1105" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> ct)</span>
<span id="cb15-1106"><a href="#cb15-1106" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">call</span>(cell)</span>
<span id="cb15-1107"><a href="#cb15-1107" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1108"><a href="#cb15-1108" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1109"><a href="#cb15-1109" aria-hidden="true" tabindex="-1"></a>    <span class="co">// base: number of fixed cells on the same row</span></span>
<span id="cb15-1110"><a href="#cb15-1110" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addCell</span>(g<span class="op">,</span> fill<span class="op">,</span> base<span class="op">,</span> isHeader<span class="op">,</span> isFixed) {</span>
<span id="cb15-1111"><a href="#cb15-1111" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> style <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_style</span><span class="op">;</span></span>
<span id="cb15-1112"><a href="#cb15-1112" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1113"><a href="#cb15-1113" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> rect <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb15-1114"><a href="#cb15-1114" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">width</span>)</span>
<span id="cb15-1115"><a href="#cb15-1115" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span>)</span>
<span id="cb15-1116"><a href="#cb15-1116" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_cellColor</span>(d<span class="op">,</span> fill<span class="op">,</span> isHeader<span class="op">,</span> isFixed))</span>
<span id="cb15-1117"><a href="#cb15-1117" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke-width"</span><span class="op">,</span> <span class="fl">0.1</span>)</span>
<span id="cb15-1118"><a href="#cb15-1118" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> style<span class="op">.</span><span class="at">border</span> <span class="op">?</span> style<span class="op">.</span><span class="at">borderColor</span> <span class="op">:</span> fill)<span class="op">;</span></span>
<span id="cb15-1119"><a href="#cb15-1119" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1120"><a href="#cb15-1120" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span> <span class="op">&amp;&amp;</span> <span class="op">!</span>(isHeader <span class="op">||</span> isFixed)) rect<span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> <span class="fl">0.5</span>)<span class="op">;</span></span>
<span id="cb15-1121"><a href="#cb15-1121" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1122"><a href="#cb15-1122" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> t <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="st">"1em"</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"dy"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingV</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> style<span class="op">.</span><span class="at">textColor</span>)<span class="op">;</span></span>
<span id="cb15-1123"><a href="#cb15-1123" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1124"><a href="#cb15-1124" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (isHeader) {</span>
<span id="cb15-1125"><a href="#cb15-1125" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="op">!</span>style<span class="op">.</span><span class="at">border</span>)</span>
<span id="cb15-1126"><a href="#cb15-1126" aria-hidden="true" tabindex="-1"></a>                g<span class="op">.</span><span class="fu">append</span>(<span class="st">"line"</span>)</span>
<span id="cb15-1127"><a href="#cb15-1127" aria-hidden="true" tabindex="-1"></a>                    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x1"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y1"</span><span class="op">,</span> <span class="dv">5</span>)</span>
<span id="cb15-1128"><a href="#cb15-1128" aria-hidden="true" tabindex="-1"></a>                    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x2"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="dv">1</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y2"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">-</span> <span class="dv">5</span>)</span>
<span id="cb15-1129"><a href="#cb15-1129" aria-hidden="true" tabindex="-1"></a>                    <span class="op">.</span><span class="fu">attr</span>(<span class="st">"stroke"</span><span class="op">,</span> style<span class="op">.</span><span class="at">borderColor</span>)<span class="op">;</span></span>
<span id="cb15-1130"><a href="#cb15-1130" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1131"><a href="#cb15-1131" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_arrow</span>(g<span class="op">,</span> base<span class="op">,</span> <span class="st">"asc"</span><span class="op">,</span> <span class="st">"M 0 8 L 3 4 L 6 8"</span>)<span class="op">;</span></span>
<span id="cb15-1132"><a href="#cb15-1132" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_arrow</span>(g<span class="op">,</span> base<span class="op">,</span> <span class="st">"desc"</span><span class="op">,</span> <span class="st">"M 0 11 L 3 15 L 6 11"</span>)<span class="op">;</span></span>
<span id="cb15-1133"><a href="#cb15-1133" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1134"><a href="#cb15-1134" aria-hidden="true" tabindex="-1"></a>            <span class="co">// Header cell</span></span>
<span id="cb15-1135"><a href="#cb15-1135" aria-hidden="true" tabindex="-1"></a>            t<span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span>)</span>
<span id="cb15-1136"><a href="#cb15-1136" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"clip-path"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_clipPath</span>(<span class="vs">`headerClip</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span><span class="sc">}</span><span class="vs">`</span>))</span>
<span id="cb15-1137"><a href="#cb15-1137" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">name</span>)<span class="op">;</span></span>
<span id="cb15-1138"><a href="#cb15-1138" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1139"><a href="#cb15-1139" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb15-1140"><a href="#cb15-1140" aria-hidden="true" tabindex="-1"></a>            t<span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> <span class="st">"value"</span>)</span>
<span id="cb15-1141"><a href="#cb15-1141" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"dx"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">isNumber</span> <span class="op">?</span> <span class="op">-</span><span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span> <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span>)</span>
<span id="cb15-1142"><a href="#cb15-1142" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"clip-path"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_clipPath</span>(<span class="vs">`cellClip</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">index</span><span class="sc">}</span><span class="vs">`</span>))</span>
<span id="cb15-1143"><a href="#cb15-1143" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">isNumber</span> <span class="op">?</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">width</span> <span class="op">:</span> <span class="dv">0</span><span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb15-1144"><a href="#cb15-1144" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> d <span class="kw">=&gt;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">isNumber</span> <span class="op">?</span> <span class="st">"end"</span> <span class="op">:</span> <span class="st">"start"</span>)</span>
<span id="cb15-1145"><a href="#cb15-1145" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">text</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb15-1146"><a href="#cb15-1146" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">isNumber</span> <span class="op">&amp;&amp;</span> d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">format</span>)</span>
<span id="cb15-1147"><a href="#cb15-1147" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> d3<span class="op">.</span><span class="fu">format</span>(d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">format</span>)(d<span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb15-1148"><a href="#cb15-1148" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span></span>
<span id="cb15-1149"><a href="#cb15-1149" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">return</span> d<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb15-1150"><a href="#cb15-1150" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb15-1151"><a href="#cb15-1151" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1152"><a href="#cb15-1152" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1153"><a href="#cb15-1153" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1154"><a href="#cb15-1154" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_cellColor</span>(d<span class="op">,</span> fill<span class="op">,</span> isHeader<span class="op">,</span> isFixed) {</span>
<span id="cb15-1155"><a href="#cb15-1155" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_heatmap</span>) {</span>
<span id="cb15-1156"><a href="#cb15-1156" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (isHeader <span class="op">||</span> isFixed <span class="op">||</span> <span class="op">!</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">isNumber</span>)</span>
<span id="cb15-1157"><a href="#cb15-1157" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> fill<span class="op">;</span></span>
<span id="cb15-1158"><a href="#cb15-1158" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb15-1159"><a href="#cb15-1159" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_heatmapColor</span>(d<span class="op">.</span><span class="at">value</span>)<span class="op">;</span></span>
<span id="cb15-1160"><a href="#cb15-1160" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1161"><a href="#cb15-1161" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb15-1162"><a href="#cb15-1162" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> fill<span class="op">;</span></span>
<span id="cb15-1163"><a href="#cb15-1163" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1164"><a href="#cb15-1164" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1165"><a href="#cb15-1165" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_arrow</span>(g<span class="op">,</span> base<span class="op">,</span> name<span class="op">,</span> path) {</span>
<span id="cb15-1166"><a href="#cb15-1166" aria-hidden="true" tabindex="-1"></a>        g<span class="op">.</span><span class="fu">append</span>(<span class="st">"path"</span>)</span>
<span id="cb15-1167"><a href="#cb15-1167" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> name)</span>
<span id="cb15-1168"><a href="#cb15-1168" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"d"</span><span class="op">,</span> path)</span>
<span id="cb15-1169"><a href="#cb15-1169" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#bbb"</span>)</span>
<span id="cb15-1170"><a href="#cb15-1170" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> d <span class="kw">=&gt;</span> <span class="vs">`translate(</span><span class="sc">${</span>d<span class="op">.</span><span class="at">column</span><span class="op">.</span><span class="at">width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellPaddingH</span> <span class="op">-</span> <span class="dv">10</span><span class="sc">}</span><span class="vs">,2)`</span>)<span class="op">;</span></span>
<span id="cb15-1171"><a href="#cb15-1171" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1172"><a href="#cb15-1172" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1173"><a href="#cb15-1173" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addScrollbars</span>() {</span>
<span id="cb15-1174"><a href="#cb15-1174" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">visible</span>[<span class="dv">1</span>]) <span class="kw">this</span><span class="op">.</span><span class="fu">_addVScroll</span>()<span class="op">;</span></span>
<span id="cb15-1175"><a href="#cb15-1175" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">visible</span>[<span class="dv">0</span>]) <span class="kw">this</span><span class="op">.</span><span class="fu">_addHScroll</span>()<span class="op">;</span></span>
<span id="cb15-1176"><a href="#cb15-1176" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1177"><a href="#cb15-1177" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1178"><a href="#cb15-1178" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addVScroll</span>() {</span>
<span id="cb15-1179"><a href="#cb15-1179" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> sb <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">vertical</span> <span class="op">=</span> <span class="kw">new</span> <span class="fu">Scrollbar</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_svg</span>)<span class="op">;</span></span>
<span id="cb15-1180"><a href="#cb15-1180" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span><span class="fu">position</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_left</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span>)</span>
<span id="cb15-1181"><a href="#cb15-1181" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">sliderWidth</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span>)</span>
<span id="cb15-1182"><a href="#cb15-1182" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">sliderLength</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)</span>
<span id="cb15-1183"><a href="#cb15-1183" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">onscroll</span>((y<span class="op">,</span> sy<span class="op">,</span> delta) <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_body</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span><span class="op">-</span>sy <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_yf</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span><span class="sc">}</span><span class="vs">)`</span>))</span>
<span id="cb15-1184"><a href="#cb15-1184" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attach</span>()<span class="op">;</span></span>
<span id="cb15-1185"><a href="#cb15-1185" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1186"><a href="#cb15-1186" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1187"><a href="#cb15-1187" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addHScroll</span>() {</span>
<span id="cb15-1188"><a href="#cb15-1188" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> sb <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">horizontal</span> <span class="op">=</span> <span class="kw">new</span> <span class="fu">Scrollbar</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_svg</span>)<span class="op">;</span></span>
<span id="cb15-1189"><a href="#cb15-1189" aria-hidden="true" tabindex="-1"></a>        sb<span class="op">.</span><span class="fu">vertical</span>(<span class="kw">false</span>)</span>
<span id="cb15-1190"><a href="#cb15-1190" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">position</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_left</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span>)</span>
<span id="cb15-1191"><a href="#cb15-1191" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">sliderWidth</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span>)</span>
<span id="cb15-1192"><a href="#cb15-1192" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">sliderLength</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)</span>
<span id="cb15-1193"><a href="#cb15-1193" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">onscroll</span>((x<span class="op">,</span> sx<span class="op">,</span> delta) <span class="kw">=&gt;</span> {</span>
<span id="cb15-1194"><a href="#cb15-1194" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_dataArea</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="op">-</span>sx <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_xf</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb15-1195"><a href="#cb15-1195" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_dataHeader</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="op">-</span>sx <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_xf</span><span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb15-1196"><a href="#cb15-1196" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb15-1197"><a href="#cb15-1197" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attach</span>()<span class="op">;</span></span>
<span id="cb15-1198"><a href="#cb15-1198" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1199"><a href="#cb15-1199" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1200"><a href="#cb15-1200" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_calcConstrains</span>() {</span>
<span id="cb15-1201"><a href="#cb15-1201" aria-hidden="true" tabindex="-1"></a>        <span class="co">// f for both scrollbars = (total - visible) / (visible - slider length)    </span></span>
<span id="cb15-1202"><a href="#cb15-1202" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Vertical scrollbar constrain        </span></span>
<span id="cb15-1203"><a href="#cb15-1203" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> th <span class="op">=</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>) <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span><span class="op">,</span></span>
<span id="cb15-1204"><a href="#cb15-1204" aria-hidden="true" tabindex="-1"></a>            sh <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span><span class="op">;</span></span>
<span id="cb15-1205"><a href="#cb15-1205" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_yf</span> <span class="op">=</span> (th <span class="op">-</span> sh) <span class="op">/</span> (sh <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)<span class="op">;</span></span>
<span id="cb15-1206"><a href="#cb15-1206" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1207"><a href="#cb15-1207" aria-hidden="true" tabindex="-1"></a>        <span class="co">// Horizontal scrollbar constrain</span></span>
<span id="cb15-1208"><a href="#cb15-1208" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> tw <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sumWidth</span>() <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sumWidth</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">,</span></span>
<span id="cb15-1209"><a href="#cb15-1209" aria-hidden="true" tabindex="-1"></a>            sw <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_sumWidth</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_fixedColumns</span>)<span class="op">;</span></span>
<span id="cb15-1210"><a href="#cb15-1210" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_xf</span> <span class="op">=</span> (tw <span class="op">-</span> sw) <span class="op">/</span> (sw <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)<span class="op">;</span></span>
<span id="cb15-1211"><a href="#cb15-1211" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1212"><a href="#cb15-1212" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_minX</span> <span class="op">=</span> <span class="op">-</span>(tw <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_width</span>)<span class="op">;</span></span>
<span id="cb15-1213"><a href="#cb15-1213" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_minY</span> <span class="op">=</span> <span class="op">-</span>((<span class="kw">this</span><span class="op">.</span><span class="at">_data</span><span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedRows</span>) <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_cellHeightA</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_height</span>)<span class="op">;</span></span>
<span id="cb15-1214"><a href="#cb15-1214" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1215"><a href="#cb15-1215" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1216"><a href="#cb15-1216" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_scroll</span>(e) {</span>
<span id="cb15-1217"><a href="#cb15-1217" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">vertical</span>) {</span>
<span id="cb15-1218"><a href="#cb15-1218" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> dy <span class="op">=</span> e<span class="op">.</span><span class="at">wheelDeltaY</span> <span class="op">?</span> e<span class="op">.</span><span class="at">wheelDeltaY</span> <span class="op">:</span> e<span class="op">.</span><span class="at">wheelDelta</span> <span class="op">?</span> e<span class="op">.</span><span class="at">wheelDelta</span> <span class="op">:</span> <span class="op">-</span><span class="dv">1</span><span class="op">;</span></span>
<span id="cb15-1219"><a href="#cb15-1219" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (dy <span class="op">===</span> <span class="op">-</span><span class="dv">1</span>) <span class="cf">return</span><span class="op">;</span></span>
<span id="cb15-1220"><a href="#cb15-1220" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1221"><a href="#cb15-1221" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> cy <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getY</span>()<span class="op">;</span></span>
<span id="cb15-1222"><a href="#cb15-1222" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> y <span class="op">=</span> cy <span class="op">+</span> dy<span class="op">;</span></span>
<span id="cb15-1223"><a href="#cb15-1223" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_moveY</span>(y)<span class="op">;</span></span>
<span id="cb15-1224"><a href="#cb15-1224" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1225"><a href="#cb15-1225" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1226"><a href="#cb15-1226" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">horizontal</span>) {</span>
<span id="cb15-1227"><a href="#cb15-1227" aria-hidden="true" tabindex="-1"></a>            <span class="kw">const</span> dx <span class="op">=</span> e<span class="op">.</span><span class="at">wheelDeltaX</span><span class="op">;</span></span>
<span id="cb15-1228"><a href="#cb15-1228" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (dx) {</span>
<span id="cb15-1229"><a href="#cb15-1229" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> cx <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getX</span>()<span class="op">;</span></span>
<span id="cb15-1230"><a href="#cb15-1230" aria-hidden="true" tabindex="-1"></a>                <span class="kw">var</span> x <span class="op">=</span> cx <span class="op">+</span> dx<span class="op">;</span></span>
<span id="cb15-1231"><a href="#cb15-1231" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="fu">_moveX</span>(x)<span class="op">;</span></span>
<span id="cb15-1232"><a href="#cb15-1232" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb15-1233"><a href="#cb15-1233" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb15-1234"><a href="#cb15-1234" aria-hidden="true" tabindex="-1"></a>        e<span class="op">.</span><span class="fu">preventDefault</span>()<span class="op">;</span></span>
<span id="cb15-1235"><a href="#cb15-1235" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1236"><a href="#cb15-1236" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1237"><a href="#cb15-1237" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_getX</span>() { <span class="cf">return</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_dataArea</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span>)<span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)[<span class="dv">0</span>]<span class="op">.</span><span class="fu">substring</span>(<span class="dv">10</span>)<span class="op">;</span> }</span>
<span id="cb15-1238"><a href="#cb15-1238" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_getY</span>() { <span class="cf">return</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_body</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span>)<span class="op">.</span><span class="fu">split</span>(<span class="st">","</span>)[<span class="dv">1</span>]<span class="op">.</span><span class="fu">replace</span>(<span class="st">")"</span><span class="op">,</span> <span class="st">""</span>)<span class="op">;</span> }</span>
<span id="cb15-1239"><a href="#cb15-1239" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1240"><a href="#cb15-1240" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_moveX</span>(x) {</span>
<span id="cb15-1241"><a href="#cb15-1241" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (x <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span>) x <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="op">;</span></span>
<span id="cb15-1242"><a href="#cb15-1242" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (x <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_minX</span>) x <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_minX</span><span class="op">;</span></span>
<span id="cb15-1243"><a href="#cb15-1243" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1244"><a href="#cb15-1244" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataArea</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>x<span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb15-1245"><a href="#cb15-1245" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_dataHeader</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>x <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span><span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb15-1246"><a href="#cb15-1246" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">horizontal</span>)</span>
<span id="cb15-1247"><a href="#cb15-1247" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">horizontal</span><span class="op">.</span><span class="fu">moveSlider</span>(<span class="op">-</span>((x <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedWidth</span>) <span class="op">/</span> <span class="kw">this</span><span class="op">.</span><span class="at">_xf</span>))<span class="op">;</span></span>
<span id="cb15-1248"><a href="#cb15-1248" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1249"><a href="#cb15-1249" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1250"><a href="#cb15-1250" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_moveY</span>(y) {</span>
<span id="cb15-1251"><a href="#cb15-1251" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (y <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_minY</span>) y <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_minY</span><span class="op">;</span></span>
<span id="cb15-1252"><a href="#cb15-1252" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (y <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span>) y <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span><span class="op">;</span></span>
<span id="cb15-1253"><a href="#cb15-1253" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb15-1254"><a href="#cb15-1254" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_body</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(0,</span><span class="sc">${</span>y<span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb15-1255"><a href="#cb15-1255" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">vertical</span>)</span>
<span id="cb15-1256"><a href="#cb15-1256" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_scrollbar</span><span class="op">.</span><span class="at">vertical</span><span class="op">.</span><span class="fu">moveSlider</span>(<span class="op">-</span>(y <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_fixedHeight</span>) <span class="op">/</span> <span class="kw">this</span><span class="op">.</span><span class="at">_yf</span>)<span class="op">;</span></span>
<span id="cb15-1257"><a href="#cb15-1257" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb15-1258"><a href="#cb15-1258" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display hidden html-fill-item html-fill-container">
<div id="ojs-cell-15" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb16" data-startfrom="1263" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1262;"><span id="cb16-1263"><a href="#cb16-1263" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/analyzer2004/svgtable</span></span>
<span id="cb16-1264"><a href="#cb16-1264" aria-hidden="true" tabindex="-1"></a><span class="co">// Copyright 2020 Eric Lo</span></span>
<span id="cb16-1265"><a href="#cb16-1265" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Scrollbar {</span>
<span id="cb16-1266"><a href="#cb16-1266" aria-hidden="true" tabindex="-1"></a>    <span class="fu">constructor</span>(svg) {</span>
<span id="cb16-1267"><a href="#cb16-1267" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_svg</span> <span class="op">=</span> svg<span class="op">;</span></span>
<span id="cb16-1268"><a href="#cb16-1268" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_g</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1269"><a href="#cb16-1269" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_box</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1270"><a href="#cb16-1270" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb16-1271"><a href="#cb16-1271" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_bar</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1272"><a href="#cb16-1272" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1273"><a href="#cb16-1273" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1274"><a href="#cb16-1274" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span> <span class="op">=</span> <span class="dv">13</span><span class="op">;</span></span>
<span id="cb16-1275"><a href="#cb16-1275" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span> <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb16-1276"><a href="#cb16-1276" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1277"><a href="#cb16-1277" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimer</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1278"><a href="#cb16-1278" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimeout</span> <span class="op">=</span> <span class="dv">300</span><span class="op">;</span></span>
<span id="cb16-1279"><a href="#cb16-1279" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderSteps</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1280"><a href="#cb16-1280" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1281"><a href="#cb16-1281" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_grabbing</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb16-1282"><a href="#cb16-1282" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_delta</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-1283"><a href="#cb16-1283" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_deltac</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-1284"><a href="#cb16-1284" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1285"><a href="#cb16-1285" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onscroll</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1286"><a href="#cb16-1286" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span> <span class="op">=</span> <span class="vs">`eric.scrollbar.</span><span class="sc">${</span><span class="bu">Date</span><span class="op">.</span><span class="fu">now</span>() <span class="op">*</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">random</span>()<span class="sc">}</span><span class="vs">`</span><span class="op">;</span></span>
<span id="cb16-1287"><a href="#cb16-1287" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1288"><a href="#cb16-1288" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1289"><a href="#cb16-1289" aria-hidden="true" tabindex="-1"></a>    <span class="fu">vertical</span>(_) {</span>
<span id="cb16-1290"><a href="#cb16-1290" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span><span class="op">;</span></span>
<span id="cb16-1291"><a href="#cb16-1291" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1292"><a href="#cb16-1292" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1293"><a href="#cb16-1293" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sliderWidth</span>(_) {</span>
<span id="cb16-1294"><a href="#cb16-1294" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span><span class="op">;</span></span>
<span id="cb16-1295"><a href="#cb16-1295" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1296"><a href="#cb16-1296" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1297"><a href="#cb16-1297" aria-hidden="true" tabindex="-1"></a>    <span class="fu">sliderLength</span>(_) {</span>
<span id="cb16-1298"><a href="#cb16-1298" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span><span class="op">;</span></span>
<span id="cb16-1299"><a href="#cb16-1299" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1300"><a href="#cb16-1300" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1301"><a href="#cb16-1301" aria-hidden="true" tabindex="-1"></a>    <span class="fu">position</span>(x<span class="op">,</span> y<span class="op">,</span> length) {</span>
<span id="cb16-1302"><a href="#cb16-1302" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_box</span> <span class="op">=</span> { x<span class="op">,</span> y<span class="op">,</span> length }<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">;</span></span>
<span id="cb16-1303"><a href="#cb16-1303" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1304"><a href="#cb16-1304" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1305"><a href="#cb16-1305" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onscroll</span>(_) {</span>
<span id="cb16-1306"><a href="#cb16-1306" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onscroll</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onscroll</span><span class="op">;</span></span>
<span id="cb16-1307"><a href="#cb16-1307" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1308"><a href="#cb16-1308" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1309"><a href="#cb16-1309" aria-hidden="true" tabindex="-1"></a>    <span class="fu">attach</span>() {</span>
<span id="cb16-1310"><a href="#cb16-1310" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_render</span>()<span class="op">;</span></span>
<span id="cb16-1311"><a href="#cb16-1311" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_attachEvents</span>()<span class="op">;</span></span>
<span id="cb16-1312"><a href="#cb16-1312" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1313"><a href="#cb16-1313" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1314"><a href="#cb16-1314" aria-hidden="true" tabindex="-1"></a>    <span class="fu">dispose</span>() {</span>
<span id="cb16-1315"><a href="#cb16-1315" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_g</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_g</span><span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb16-1316"><a href="#cb16-1316" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb16-1317"><a href="#cb16-1317" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="vs">`mousedown.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="kw">null</span>)</span>
<span id="cb16-1318"><a href="#cb16-1318" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="vs">`mouseup.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="kw">null</span>)</span>
<span id="cb16-1319"><a href="#cb16-1319" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="vs">`mousemove.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> <span class="kw">null</span>)<span class="op">;</span></span>
<span id="cb16-1320"><a href="#cb16-1320" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1321"><a href="#cb16-1321" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1322"><a href="#cb16-1322" aria-hidden="true" tabindex="-1"></a>    <span class="fu">moveSlider</span>(pos) {</span>
<span id="cb16-1323"><a href="#cb16-1323" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pos <span class="op">&lt;</span> <span class="dv">0</span>)</span>
<span id="cb16-1324"><a href="#cb16-1324" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb16-1325"><a href="#cb16-1325" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (pos <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span> <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">.</span><span class="at">length</span>)</span>
<span id="cb16-1326"><a href="#cb16-1326" aria-hidden="true" tabindex="-1"></a>            pos <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span><span class="op">;</span></span>
<span id="cb16-1327"><a href="#cb16-1327" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1328"><a href="#cb16-1328" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span> <span class="op">?</span> <span class="st">"y"</span> <span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> pos)<span class="op">;</span></span>
<span id="cb16-1329"><a href="#cb16-1329" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1330"><a href="#cb16-1330" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1331"><a href="#cb16-1331" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_render</span>() {</span>
<span id="cb16-1332"><a href="#cb16-1332" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span>)</span>
<span id="cb16-1333"><a href="#cb16-1333" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderVBar</span>()<span class="op">;</span></span>
<span id="cb16-1334"><a href="#cb16-1334" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb16-1335"><a href="#cb16-1335" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderHBar</span>()<span class="op">;</span></span>
<span id="cb16-1336"><a href="#cb16-1336" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1337"><a href="#cb16-1337" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1338"><a href="#cb16-1338" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_renderVBar</span>() {</span>
<span id="cb16-1339"><a href="#cb16-1339" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> box <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">;</span></span>
<span id="cb16-1340"><a href="#cb16-1340" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1341"><a href="#cb16-1341" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> g <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_svg</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb16-1342"><a href="#cb16-1342" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>box<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>box<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb16-1343"><a href="#cb16-1343" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1344"><a href="#cb16-1344" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_bar</span> <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb16-1345"><a href="#cb16-1345" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span>)</span>
<span id="cb16-1346"><a href="#cb16-1346" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> box<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb16-1347"><a href="#cb16-1347" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#eee"</span>)<span class="op">;</span></span>
<span id="cb16-1348"><a href="#cb16-1348" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1349"><a href="#cb16-1349" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span> <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb16-1350"><a href="#cb16-1350" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb16-1351"><a href="#cb16-1351" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span>)</span>
<span id="cb16-1352"><a href="#cb16-1352" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)</span>
<span id="cb16-1353"><a href="#cb16-1353" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#ccc"</span>)<span class="op">;</span></span>
<span id="cb16-1354"><a href="#cb16-1354" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1355"><a href="#cb16-1355" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_g</span> <span class="op">=</span> g<span class="op">;</span></span>
<span id="cb16-1356"><a href="#cb16-1356" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1357"><a href="#cb16-1357" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1358"><a href="#cb16-1358" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_renderHBar</span>() {</span>
<span id="cb16-1359"><a href="#cb16-1359" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> box <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">;</span></span>
<span id="cb16-1360"><a href="#cb16-1360" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1361"><a href="#cb16-1361" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> g <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_svg</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)</span>
<span id="cb16-1362"><a href="#cb16-1362" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>box<span class="op">.</span><span class="at">x</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>box<span class="op">.</span><span class="at">y</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb16-1363"><a href="#cb16-1363" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1364"><a href="#cb16-1364" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_bar</span> <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb16-1365"><a href="#cb16-1365" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> box<span class="op">.</span><span class="at">length</span>)</span>
<span id="cb16-1366"><a href="#cb16-1366" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span>)</span>
<span id="cb16-1367"><a href="#cb16-1367" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#eee"</span>)<span class="op">;</span></span>
<span id="cb16-1368"><a href="#cb16-1368" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1369"><a href="#cb16-1369" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span> <span class="op">=</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb16-1370"><a href="#cb16-1370" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> <span class="dv">0</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> <span class="dv">0</span>)</span>
<span id="cb16-1371"><a href="#cb16-1371" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)</span>
<span id="cb16-1372"><a href="#cb16-1372" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span>)</span>
<span id="cb16-1373"><a href="#cb16-1373" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#ccc"</span>)<span class="op">;</span></span>
<span id="cb16-1374"><a href="#cb16-1374" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1375"><a href="#cb16-1375" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_g</span> <span class="op">=</span> g<span class="op">;</span></span>
<span id="cb16-1376"><a href="#cb16-1376" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1377"><a href="#cb16-1377" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1378"><a href="#cb16-1378" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_attachEvents</span>(tbox) {</span>
<span id="cb16-1379"><a href="#cb16-1379" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> box <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">;</span></span>
<span id="cb16-1380"><a href="#cb16-1380" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1381"><a href="#cb16-1381" aria-hidden="true" tabindex="-1"></a>        <span class="co">//this._svg</span></span>
<span id="cb16-1382"><a href="#cb16-1382" aria-hidden="true" tabindex="-1"></a>        d3<span class="op">.</span><span class="fu">select</span>(<span class="st">"body"</span>)</span>
<span id="cb16-1383"><a href="#cb16-1383" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="vs">`mousedown.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb16-1384"><a href="#cb16-1384" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (e<span class="op">.</span><span class="at">buttons</span> <span class="op">===</span> <span class="dv">1</span>) {</span>
<span id="cb16-1385"><a href="#cb16-1385" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">const</span> p <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(e)<span class="op">;</span></span>
<span id="cb16-1386"><a href="#cb16-1386" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (e<span class="op">.</span><span class="at">srcElement</span> <span class="op">===</span> <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">node</span>()) {</span>
<span id="cb16-1387"><a href="#cb16-1387" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">this</span><span class="op">.</span><span class="at">_grabbing</span> <span class="op">=</span> <span class="kw">true</span><span class="op">;</span></span>
<span id="cb16-1388"><a href="#cb16-1388" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#aaa"</span>)<span class="op">;</span></span>
<span id="cb16-1389"><a href="#cb16-1389" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span>) {</span>
<span id="cb16-1390"><a href="#cb16-1390" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">this</span><span class="op">.</span><span class="at">_delta</span> <span class="op">=</span> p[<span class="dv">1</span>] <span class="op">-</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb16-1391"><a href="#cb16-1391" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">this</span><span class="op">.</span><span class="at">_deltac</span> <span class="op">=</span> p[<span class="dv">1</span>] <span class="op">-</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span>) <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb16-1392"><a href="#cb16-1392" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1393"><a href="#cb16-1393" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span> {</span>
<span id="cb16-1394"><a href="#cb16-1394" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">this</span><span class="op">.</span><span class="at">_delta</span> <span class="op">=</span> p[<span class="dv">0</span>] <span class="op">-</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb16-1395"><a href="#cb16-1395" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">this</span><span class="op">.</span><span class="at">_deltac</span> <span class="op">=</span> p[<span class="dv">0</span>] <span class="op">-</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span>) <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderWidth</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb16-1396"><a href="#cb16-1396" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1397"><a href="#cb16-1397" aria-hidden="true" tabindex="-1"></a>                        e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb16-1398"><a href="#cb16-1398" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb16-1399"><a href="#cb16-1399" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span> <span class="cf">if</span> (e<span class="op">.</span><span class="at">srcElement</span> <span class="op">===</span> <span class="kw">this</span><span class="op">.</span><span class="at">_bar</span><span class="op">.</span><span class="fu">node</span>()) {</span>
<span id="cb16-1400"><a href="#cb16-1400" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> cbox <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_bar</span><span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">getBoundingClientRect</span>()<span class="op">;</span></span>
<span id="cb16-1401"><a href="#cb16-1401" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1402"><a href="#cb16-1402" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">var</span> a<span class="op">,</span> b<span class="op">,</span> pos<span class="op">;</span></span>
<span id="cb16-1403"><a href="#cb16-1403" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span>) {</span>
<span id="cb16-1404"><a href="#cb16-1404" aria-hidden="true" tabindex="-1"></a>                            a <span class="op">=</span> pos <span class="op">=</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span>)<span class="op">;</span></span>
<span id="cb16-1405"><a href="#cb16-1405" aria-hidden="true" tabindex="-1"></a>                            b <span class="op">=</span> p[<span class="dv">1</span>] <span class="op">-</span> cbox<span class="op">.</span><span class="at">y</span><span class="op">;</span></span>
<span id="cb16-1406"><a href="#cb16-1406" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1407"><a href="#cb16-1407" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span> {</span>
<span id="cb16-1408"><a href="#cb16-1408" aria-hidden="true" tabindex="-1"></a>                            a <span class="op">=</span> pos <span class="op">=</span> <span class="op">+</span><span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span>)<span class="op">;</span></span>
<span id="cb16-1409"><a href="#cb16-1409" aria-hidden="true" tabindex="-1"></a>                            b <span class="op">=</span> p[<span class="dv">0</span>] <span class="op">-</span> cbox<span class="op">.</span><span class="at">x</span><span class="op">;</span></span>
<span id="cb16-1410"><a href="#cb16-1410" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1411"><a href="#cb16-1411" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1412"><a href="#cb16-1412" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> intr <span class="op">=</span> (b <span class="op">-</span> a) <span class="op">/</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb16-1413"><a href="#cb16-1413" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> steps <span class="op">=</span> []<span class="op">;</span></span>
<span id="cb16-1414"><a href="#cb16-1414" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">for</span> (<span class="kw">var</span> i <span class="op">=</span> <span class="dv">0</span><span class="op">;</span> i <span class="op">&lt;</span> <span class="dv">3</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb16-1415"><a href="#cb16-1415" aria-hidden="true" tabindex="-1"></a>                            pos <span class="op">+=</span> intr<span class="op">;</span></span>
<span id="cb16-1416"><a href="#cb16-1416" aria-hidden="true" tabindex="-1"></a>                            steps<span class="op">.</span><span class="fu">push</span>(pos)<span class="op">;</span></span>
<span id="cb16-1417"><a href="#cb16-1417" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1418"><a href="#cb16-1418" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1419"><a href="#cb16-1419" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (b <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span> <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">.</span><span class="at">length</span>)</span>
<span id="cb16-1420"><a href="#cb16-1420" aria-hidden="true" tabindex="-1"></a>                            steps<span class="op">.</span><span class="fu">push</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>)<span class="op">;</span></span>
<span id="cb16-1421"><a href="#cb16-1421" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">else</span></span>
<span id="cb16-1422"><a href="#cb16-1422" aria-hidden="true" tabindex="-1"></a>                            steps<span class="op">.</span><span class="fu">push</span>(b)<span class="op">;</span></span>
<span id="cb16-1423"><a href="#cb16-1423" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1424"><a href="#cb16-1424" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderSteps</span> <span class="op">=</span> steps<span class="op">.</span><span class="fu">reverse</span>()<span class="op">;</span></span>
<span id="cb16-1425"><a href="#cb16-1425" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimeout</span> <span class="op">=</span> <span class="dv">200</span><span class="op">;</span></span>
<span id="cb16-1426"><a href="#cb16-1426" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimer</span> <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_slide</span>()<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimeout</span>)<span class="op">;</span></span>
<span id="cb16-1427"><a href="#cb16-1427" aria-hidden="true" tabindex="-1"></a>                        e<span class="op">.</span><span class="fu">stopPropagation</span>()<span class="op">;</span></span>
<span id="cb16-1428"><a href="#cb16-1428" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb16-1429"><a href="#cb16-1429" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb16-1430"><a href="#cb16-1430" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb16-1431"><a href="#cb16-1431" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="vs">`mouseup.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> () <span class="kw">=&gt;</span> {</span>
<span id="cb16-1432"><a href="#cb16-1432" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimer</span>) <span class="pp">clearTimeout</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimer</span>)<span class="op">;</span></span>
<span id="cb16-1433"><a href="#cb16-1433" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> steps <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderSteps</span><span class="op">;</span></span>
<span id="cb16-1434"><a href="#cb16-1434" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (steps <span class="op">&amp;&amp;</span> steps<span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-1435"><a href="#cb16-1435" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="fu">_slideTo</span>(steps<span class="op">.</span><span class="fu">reverse</span>()<span class="op">.</span><span class="fu">pop</span>())<span class="op">;</span></span>
<span id="cb16-1436"><a href="#cb16-1436" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="at">_sliderSteps</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1437"><a href="#cb16-1437" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb16-1438"><a href="#cb16-1438" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1439"><a href="#cb16-1439" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_grabbing</span> <span class="op">=</span> <span class="kw">false</span><span class="op">;</span></span>
<span id="cb16-1440"><a href="#cb16-1440" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="st">"#ccc"</span>)<span class="op">;</span></span>
<span id="cb16-1441"><a href="#cb16-1441" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb16-1442"><a href="#cb16-1442" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">on</span>(<span class="vs">`mousemove.</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_namespace</span><span class="sc">}</span><span class="vs">`</span><span class="op">,</span> e <span class="kw">=&gt;</span> {</span>
<span id="cb16-1443"><a href="#cb16-1443" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> box <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_box</span><span class="op">;</span></span>
<span id="cb16-1444"><a href="#cb16-1444" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1445"><a href="#cb16-1445" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_grabbing</span>) {</span>
<span id="cb16-1446"><a href="#cb16-1446" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span>) {</span>
<span id="cb16-1447"><a href="#cb16-1447" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> y <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(e)[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb16-1448"><a href="#cb16-1448" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> sy <span class="op">=</span> y <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_delta</span><span class="op">;</span></span>
<span id="cb16-1449"><a href="#cb16-1449" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (sy <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> sy <span class="op">&lt;=</span> box<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>) {</span>
<span id="cb16-1450"><a href="#cb16-1450" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"y"</span><span class="op">,</span> sy)<span class="op">;</span></span>
<span id="cb16-1451"><a href="#cb16-1451" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onscroll</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_onscroll</span>(y<span class="op">,</span> sy<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_deltac</span>)<span class="op">;</span></span>
<span id="cb16-1452"><a href="#cb16-1452" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1453"><a href="#cb16-1453" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb16-1454"><a href="#cb16-1454" aria-hidden="true" tabindex="-1"></a>                    <span class="cf">else</span> {</span>
<span id="cb16-1455"><a href="#cb16-1455" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> x <span class="op">=</span> d3<span class="op">.</span><span class="fu">pointer</span>(e)[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb16-1456"><a href="#cb16-1456" aria-hidden="true" tabindex="-1"></a>                        <span class="kw">const</span> sx <span class="op">=</span> x <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_delta</span><span class="op">;</span></span>
<span id="cb16-1457"><a href="#cb16-1457" aria-hidden="true" tabindex="-1"></a>                        <span class="cf">if</span> (sx <span class="op">&gt;=</span> <span class="dv">0</span> <span class="op">&amp;&amp;</span> sx <span class="op">&lt;=</span> box<span class="op">.</span><span class="at">length</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderLength</span>) {</span>
<span id="cb16-1458"><a href="#cb16-1458" aria-hidden="true" tabindex="-1"></a>                            <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"x"</span><span class="op">,</span> sx)<span class="op">;</span></span>
<span id="cb16-1459"><a href="#cb16-1459" aria-hidden="true" tabindex="-1"></a>                            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onscroll</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_onscroll</span>(x<span class="op">,</span> sx<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_deltac</span>)<span class="op">;</span></span>
<span id="cb16-1460"><a href="#cb16-1460" aria-hidden="true" tabindex="-1"></a>                        }</span>
<span id="cb16-1461"><a href="#cb16-1461" aria-hidden="true" tabindex="-1"></a>                    }</span>
<span id="cb16-1462"><a href="#cb16-1462" aria-hidden="true" tabindex="-1"></a>                }</span>
<span id="cb16-1463"><a href="#cb16-1463" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb16-1464"><a href="#cb16-1464" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1465"><a href="#cb16-1465" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1466"><a href="#cb16-1466" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_slideTo</span>(dest) {</span>
<span id="cb16-1467"><a href="#cb16-1467" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_slider</span><span class="op">.</span><span class="fu">attr</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_vertical</span> <span class="op">?</span> <span class="st">"y"</span> <span class="op">:</span> <span class="st">"x"</span><span class="op">,</span> dest)<span class="op">;</span></span>
<span id="cb16-1468"><a href="#cb16-1468" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onscroll</span>) <span class="kw">this</span><span class="op">.</span><span class="fu">_onscroll</span>(dest<span class="op">,</span> dest<span class="op">,</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb16-1469"><a href="#cb16-1469" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1470"><a href="#cb16-1470" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb16-1471"><a href="#cb16-1471" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_slide</span>() {</span>
<span id="cb16-1472"><a href="#cb16-1472" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_slideTo</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_sliderSteps</span><span class="op">.</span><span class="fu">pop</span>())<span class="op">;</span></span>
<span id="cb16-1473"><a href="#cb16-1473" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_sliderSteps</span><span class="op">.</span><span class="at">length</span> <span class="op">&gt;</span> <span class="dv">0</span>) {</span>
<span id="cb16-1474"><a href="#cb16-1474" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimeout</span> <span class="op">-=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb16-1475"><a href="#cb16-1475" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimer</span> <span class="op">=</span> <span class="pp">setTimeout</span>(() <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_slide</span>()<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimeout</span>)<span class="op">;</span></span>
<span id="cb16-1476"><a href="#cb16-1476" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb16-1477"><a href="#cb16-1477" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb16-1478"><a href="#cb16-1478" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_sliderTimer</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb16-1479"><a href="#cb16-1479" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb16-1480"><a href="#cb16-1480" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-16" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>
<div class="card cell html-fill-item html-fill-container bslib-card" data-bslib-card-init="" data-require-bs-caller="card()" data-full-screen="false">
<div class="card-body html-fill-item html-fill-container">
<div class="sourceCode cell-code hidden html-fill-item html-fill-container" id="cb17" data-startfrom="1485" data-source-offset="0"><pre class="sourceCode js code-with-copy"><code class="sourceCode javascript" style="counter-reset: source-line 1484;"><span id="cb17-1485"><a href="#cb17-1485" aria-hidden="true" tabindex="-1"></a><span class="co">// https://github.com/analyzer2004/svgtable</span></span>
<span id="cb17-1486"><a href="#cb17-1486" aria-hidden="true" tabindex="-1"></a><span class="co">// Copyright 2020 Eric Lo</span></span>
<span id="cb17-1487"><a href="#cb17-1487" aria-hidden="true" tabindex="-1"></a><span class="kw">class</span> Paginator {</span>
<span id="cb17-1488"><a href="#cb17-1488" aria-hidden="true" tabindex="-1"></a>    <span class="fu">constructor</span>(table) {</span>
<span id="cb17-1489"><a href="#cb17-1489" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_table</span> <span class="op">=</span> table<span class="op">;</span></span>
<span id="cb17-1490"><a href="#cb17-1490" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_tableWidth</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1491"><a href="#cb17-1491" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_tableHeight</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1492"><a href="#cb17-1492" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1493"><a href="#cb17-1493" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1494"><a href="#cb17-1494" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_left</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1495"><a href="#cb17-1495" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_pw</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1496"><a href="#cb17-1496" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sw</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1497"><a href="#cb17-1497" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1498"><a href="#cb17-1498" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_controls</span> <span class="op">=</span> {</span>
<span id="cb17-1499"><a href="#cb17-1499" aria-hidden="true" tabindex="-1"></a>            <span class="dt">gotoInput</span><span class="op">:</span> <span class="kw">false</span><span class="op">,</span></span>
<span id="cb17-1500"><a href="#cb17-1500" aria-hidden="true" tabindex="-1"></a>            <span class="dt">recordsPerPageSelector</span><span class="op">:</span> <span class="kw">true</span></span>
<span id="cb17-1501"><a href="#cb17-1501" aria-hidden="true" tabindex="-1"></a>        }<span class="op">;</span></span>
<span id="cb17-1502"><a href="#cb17-1502" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_options</span> <span class="op">=</span> {</span>
<span id="cb17-1503"><a href="#cb17-1503" aria-hidden="true" tabindex="-1"></a>            <span class="dt">position</span><span class="op">:</span> <span class="st">"top"</span><span class="op">,</span></span>
<span id="cb17-1504"><a href="#cb17-1504" aria-hidden="true" tabindex="-1"></a>            <span class="dt">selector</span><span class="op">:</span> <span class="st">"left"</span><span class="op">,</span></span>
<span id="cb17-1505"><a href="#cb17-1505" aria-hidden="true" tabindex="-1"></a>            <span class="dt">buttonColor</span><span class="op">:</span> <span class="st">"#aaa"</span></span>
<span id="cb17-1506"><a href="#cb17-1506" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1507"><a href="#cb17-1507" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPageSelections</span> <span class="op">=</span> [<span class="dv">25</span><span class="op">,</span> <span class="dv">50</span><span class="op">,</span> <span class="dv">75</span>]<span class="op">;</span></span>
<span id="cb17-1508"><a href="#cb17-1508" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1509"><a href="#cb17-1509" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1510"><a href="#cb17-1510" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span> <span class="op">=</span> <span class="dv">50</span><span class="op">;</span></span>
<span id="cb17-1511"><a href="#cb17-1511" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-1512"><a href="#cb17-1512" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1513"><a href="#cb17-1513" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1514"><a href="#cb17-1514" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1515"><a href="#cb17-1515" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1516"><a href="#cb17-1516" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span> <span class="op">=</span> <span class="dv">15</span><span class="op">;</span></span>
<span id="cb17-1517"><a href="#cb17-1517" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb17-1518"><a href="#cb17-1518" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_containerTable</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb17-1519"><a href="#cb17-1519" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb17-1520"><a href="#cb17-1520" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb17-1521"><a href="#cb17-1521" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1522"><a href="#cb17-1522" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onPageNumberChange</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb17-1523"><a href="#cb17-1523" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_onRecordsPerPageChange</span> <span class="op">=</span> <span class="kw">null</span><span class="op">;</span></span>
<span id="cb17-1524"><a href="#cb17-1524" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1525"><a href="#cb17-1525" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1526"><a href="#cb17-1526" aria-hidden="true" tabindex="-1"></a>    <span class="fu">controls</span>(_) {</span>
<span id="cb17-1527"><a href="#cb17-1527" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_controls</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_controls</span><span class="op">;</span></span>
<span id="cb17-1528"><a href="#cb17-1528" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1529"><a href="#cb17-1529" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1530"><a href="#cb17-1530" aria-hidden="true" tabindex="-1"></a>    <span class="fu">options</span>(_) {</span>
<span id="cb17-1531"><a href="#cb17-1531" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_options</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_options</span><span class="op">;</span></span>
<span id="cb17-1532"><a href="#cb17-1532" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1533"><a href="#cb17-1533" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1534"><a href="#cb17-1534" aria-hidden="true" tabindex="-1"></a>    <span class="fu">position</span>(_) {</span>
<span id="cb17-1535"><a href="#cb17-1535" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_left</span> <span class="op">=</span> _[<span class="dv">0</span>]<span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_top</span> <span class="op">=</span> _[<span class="dv">1</span>]<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> [<span class="kw">this</span><span class="op">.</span><span class="at">_left</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">top</span>]<span class="op">;</span></span>
<span id="cb17-1536"><a href="#cb17-1536" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1537"><a href="#cb17-1537" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1538"><a href="#cb17-1538" aria-hidden="true" tabindex="-1"></a>    <span class="fu">buttonPadding</span>(_) {</span>
<span id="cb17-1539"><a href="#cb17-1539" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span><span class="op">;</span></span>
<span id="cb17-1540"><a href="#cb17-1540" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1541"><a href="#cb17-1541" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1542"><a href="#cb17-1542" aria-hidden="true" tabindex="-1"></a>    <span class="fu">buttonSpacing</span>(_) {</span>
<span id="cb17-1543"><a href="#cb17-1543" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1544"><a href="#cb17-1544" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1545"><a href="#cb17-1545" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1546"><a href="#cb17-1546" aria-hidden="true" tabindex="-1"></a>    <span class="fu">recordsPerPageSelections</span>(_) {</span>
<span id="cb17-1547"><a href="#cb17-1547" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPageSelections</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPageSelections</span><span class="op">;</span></span>
<span id="cb17-1548"><a href="#cb17-1548" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1549"><a href="#cb17-1549" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1550"><a href="#cb17-1550" aria-hidden="true" tabindex="-1"></a>    <span class="fu">recordsPerPage</span>(_) {</span>
<span id="cb17-1551"><a href="#cb17-1551" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">arguments</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb17-1552"><a href="#cb17-1552" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span> <span class="op">=</span> _<span class="op">;</span></span>
<span id="cb17-1553"><a href="#cb17-1553" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span> <span class="op">/</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span>)<span class="op">;</span></span>
<span id="cb17-1554"><a href="#cb17-1554" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_validateCurrentPage</span>()<span class="op">;</span></span>
<span id="cb17-1555"><a href="#cb17-1555" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb17-1556"><a href="#cb17-1556" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1557"><a href="#cb17-1557" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb17-1558"><a href="#cb17-1558" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span><span class="op">;</span></span>
<span id="cb17-1559"><a href="#cb17-1559" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1560"><a href="#cb17-1560" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1561"><a href="#cb17-1561" aria-hidden="true" tabindex="-1"></a>    <span class="fu">recordCount</span>(_) {</span>
<span id="cb17-1562"><a href="#cb17-1562" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">arguments</span><span class="op">.</span><span class="at">length</span>) {</span>
<span id="cb17-1563"><a href="#cb17-1563" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span> <span class="op">=</span> _<span class="op">;</span></span>
<span id="cb17-1564"><a href="#cb17-1564" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span> <span class="op">/</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span>)<span class="op">;</span></span>
<span id="cb17-1565"><a href="#cb17-1565" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_validateCurrentPage</span>()<span class="op">;</span></span>
<span id="cb17-1566"><a href="#cb17-1566" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb17-1567"><a href="#cb17-1567" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1568"><a href="#cb17-1568" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb17-1569"><a href="#cb17-1569" aria-hidden="true" tabindex="-1"></a>            <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span><span class="op">;</span></span>
<span id="cb17-1570"><a href="#cb17-1570" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1571"><a href="#cb17-1571" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1572"><a href="#cb17-1572" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onPageNumberChange</span>(_) {</span>
<span id="cb17-1573"><a href="#cb17-1573" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onPageNumberChange</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onPageNumberChange</span><span class="op">;</span></span>
<span id="cb17-1574"><a href="#cb17-1574" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1575"><a href="#cb17-1575" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1576"><a href="#cb17-1576" aria-hidden="true" tabindex="-1"></a>    <span class="fu">onRecordsPerPageChange</span>(_) {</span>
<span id="cb17-1577"><a href="#cb17-1577" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">arguments</span><span class="op">.</span><span class="at">length</span> <span class="op">?</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onRecordsPerPageChange</span> <span class="op">=</span> _<span class="op">,</span> <span class="kw">this</span>) <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_onRecordsPerPageChange</span><span class="op">;</span></span>
<span id="cb17-1578"><a href="#cb17-1578" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1579"><a href="#cb17-1579" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1580"><a href="#cb17-1580" aria-hidden="true" tabindex="-1"></a>    <span class="fu">init</span>(recordsPerPage<span class="op">,</span> recordCount) {</span>
<span id="cb17-1581"><a href="#cb17-1581" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span> <span class="op">=</span> recordsPerPage<span class="op">;</span></span>
<span id="cb17-1582"><a href="#cb17-1582" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span> <span class="op">=</span> recordCount<span class="op">;</span></span>
<span id="cb17-1583"><a href="#cb17-1583" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">=</span> <span class="bu">Math</span><span class="op">.</span><span class="fu">ceil</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_recordCount</span> <span class="op">/</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span>)<span class="op">;</span></span>
<span id="cb17-1584"><a href="#cb17-1584" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_resetBoundary</span>()<span class="op">;</span></span>
<span id="cb17-1585"><a href="#cb17-1585" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb17-1586"><a href="#cb17-1586" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1587"><a href="#cb17-1587" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1588"><a href="#cb17-1588" aria-hidden="true" tabindex="-1"></a>    <span class="fu">render</span>() {</span>
<span id="cb17-1589"><a href="#cb17-1589" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_prepare</span>()<span class="op">;</span></span>
<span id="cb17-1590"><a href="#cb17-1590" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createContainers</span>()<span class="op">;</span></span>
<span id="cb17-1591"><a href="#cb17-1591" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_renderPaginator</span>()<span class="op">;</span></span>
<span id="cb17-1592"><a href="#cb17-1592" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_controls</span><span class="op">.</span><span class="at">recordsPerPageSelector</span>) {</span>
<span id="cb17-1593"><a href="#cb17-1593" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderRecordsPerPageSelector</span>()<span class="op">;</span></span>
<span id="cb17-1594"><a href="#cb17-1594" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1595"><a href="#cb17-1595" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1596"><a href="#cb17-1596" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_table</span><span class="op">.</span><span class="at">g</span><span class="op">.</span><span class="fu">append</span>(() <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_containerTable</span><span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb17-1597"><a href="#cb17-1597" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">;</span></span>
<span id="cb17-1598"><a href="#cb17-1598" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1599"><a href="#cb17-1599" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1600"><a href="#cb17-1600" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_prepare</span>() {</span>
<span id="cb17-1601"><a href="#cb17-1601" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> s <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_table</span><span class="op">.</span><span class="fu">size</span>()<span class="op">;</span></span>
<span id="cb17-1602"><a href="#cb17-1602" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_tableWidth</span> <span class="op">=</span> s[<span class="dv">0</span>]<span class="op">;</span></span>
<span id="cb17-1603"><a href="#cb17-1603" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_tableHeight</span> <span class="op">=</span> s[<span class="dv">1</span>]<span class="op">;</span></span>
<span id="cb17-1604"><a href="#cb17-1604" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1605"><a href="#cb17-1605" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1606"><a href="#cb17-1606" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_createContainers</span>() {</span>
<span id="cb17-1607"><a href="#cb17-1607" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> c <span class="op">=</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg:g"</span>)<span class="op">;</span></span>
<span id="cb17-1608"><a href="#cb17-1608" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_options</span><span class="op">.</span><span class="at">position</span> <span class="op">===</span> <span class="st">"top"</span>)</span>
<span id="cb17-1609"><a href="#cb17-1609" aria-hidden="true" tabindex="-1"></a>            c<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_left</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb17-1610"><a href="#cb17-1610" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span></span>
<span id="cb17-1611"><a href="#cb17-1611" aria-hidden="true" tabindex="-1"></a>            c<span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_left</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_top</span><span class="sc">}</span><span class="vs">)`</span>)<span class="op">;</span></span>
<span id="cb17-1612"><a href="#cb17-1612" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1613"><a href="#cb17-1613" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_containerTable</span> <span class="op">=</span> c<span class="op">;</span></span>
<span id="cb17-1614"><a href="#cb17-1614" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createSelectorCell</span>()<span class="op">;</span></span>
<span id="cb17-1615"><a href="#cb17-1615" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createPaginatorCell</span>()<span class="op">;</span></span>
<span id="cb17-1616"><a href="#cb17-1616" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1617"><a href="#cb17-1617" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1618"><a href="#cb17-1618" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_createSelectorCell</span>() {</span>
<span id="cb17-1619"><a href="#cb17-1619" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span><span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb17-1620"><a href="#cb17-1620" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_containerTable</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb17-1621"><a href="#cb17-1621" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1622"><a href="#cb17-1622" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1623"><a href="#cb17-1623" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_createPaginatorCell</span>() {</span>
<span id="cb17-1624"><a href="#cb17-1624" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span>) <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span><span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb17-1625"><a href="#cb17-1625" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_containerTable</span><span class="op">.</span><span class="fu">append</span>(<span class="st">"g"</span>)<span class="op">;</span></span>
<span id="cb17-1626"><a href="#cb17-1626" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1627"><a href="#cb17-1627" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1628"><a href="#cb17-1628" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_renderPaginator</span>(pnum) {</span>
<span id="cb17-1629"><a href="#cb17-1629" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createPaginatorCell</span>()<span class="op">;</span></span>
<span id="cb17-1630"><a href="#cb17-1630" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1631"><a href="#cb17-1631" aria-hidden="true" tabindex="-1"></a>        <span class="co">//if (this._controls.gotoInput) this._addGotoInput(pnum);</span></span>
<span id="cb17-1632"><a href="#cb17-1632" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> tx <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1633"><a href="#cb17-1633" aria-hidden="true" tabindex="-1"></a>        tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addPageButton</span>(<span class="dv">1</span><span class="op">,</span> tx)<span class="op">;</span></span>
<span id="cb17-1634"><a href="#cb17-1634" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">===</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">&lt;</span> <span class="dv">5</span>) {</span>
<span id="cb17-1635"><a href="#cb17-1635" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> <span class="dv">2</span><span class="op">;</span> i <span class="op">&lt;=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span><span class="op">;</span> i<span class="op">++</span>)</span>
<span id="cb17-1636"><a href="#cb17-1636" aria-hidden="true" tabindex="-1"></a>                tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addPageButton</span>(i<span class="op">,</span> tx)<span class="op">;</span></span>
<span id="cb17-1637"><a href="#cb17-1637" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1638"><a href="#cb17-1638" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb17-1639"><a href="#cb17-1639" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> floor<span class="op">;</span></span>
<span id="cb17-1640"><a href="#cb17-1640" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">===</span> <span class="dv">5</span>) {</span>
<span id="cb17-1641"><a href="#cb17-1641" aria-hidden="true" tabindex="-1"></a>                floor <span class="op">=</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb17-1642"><a href="#cb17-1642" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1643"><a href="#cb17-1643" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> {</span>
<span id="cb17-1644"><a href="#cb17-1644" aria-hidden="true" tabindex="-1"></a>                floor <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span><span class="op">;</span></span>
<span id="cb17-1645"><a href="#cb17-1645" aria-hidden="true" tabindex="-1"></a>                tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addSeperator</span>(tx)<span class="op">;</span></span>
<span id="cb17-1646"><a href="#cb17-1646" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1647"><a href="#cb17-1647" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1648"><a href="#cb17-1648" aria-hidden="true" tabindex="-1"></a>            <span class="cf">for</span> (<span class="kw">let</span> i <span class="op">=</span> floor<span class="op">;</span> i <span class="op">&lt;=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span><span class="op">;</span> i<span class="op">++</span>) {</span>
<span id="cb17-1649"><a href="#cb17-1649" aria-hidden="true" tabindex="-1"></a>                tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addPageButton</span>(i<span class="op">,</span> tx)<span class="op">;</span></span>
<span id="cb17-1650"><a href="#cb17-1650" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1651"><a href="#cb17-1651" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1652"><a href="#cb17-1652" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1653"><a href="#cb17-1653" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">&lt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>) {</span>
<span id="cb17-1654"><a href="#cb17-1654" aria-hidden="true" tabindex="-1"></a>            tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addSeperator</span>(tx)<span class="op">;</span></span>
<span id="cb17-1655"><a href="#cb17-1655" aria-hidden="true" tabindex="-1"></a>            tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addPageButton</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">,</span> tx)<span class="op">;</span></span>
<span id="cb17-1656"><a href="#cb17-1656" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1657"><a href="#cb17-1657" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1658"><a href="#cb17-1658" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_pw</span> <span class="op">=</span> tx<span class="op">;</span></span>
<span id="cb17-1659"><a href="#cb17-1659" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_adjust</span>()<span class="op">;</span></span>
<span id="cb17-1660"><a href="#cb17-1660" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1661"><a href="#cb17-1661" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1662"><a href="#cb17-1662" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_renderRecordsPerPageSelector</span>() {</span>
<span id="cb17-1663"><a href="#cb17-1663" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_createSelectorCell</span>()<span class="op">;</span></span>
<span id="cb17-1664"><a href="#cb17-1664" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> tx <span class="op">=</span> <span class="dv">0</span><span class="op">;</span></span>
<span id="cb17-1665"><a href="#cb17-1665" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPageSelections</span><span class="op">.</span><span class="fu">forEach</span>(d <span class="kw">=&gt;</span> {</span>
<span id="cb17-1666"><a href="#cb17-1666" aria-hidden="true" tabindex="-1"></a>            tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addSelectorButton</span>(d<span class="op">,</span> tx)<span class="op">;</span></span>
<span id="cb17-1667"><a href="#cb17-1667" aria-hidden="true" tabindex="-1"></a>        })<span class="op">;</span></span>
<span id="cb17-1668"><a href="#cb17-1668" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_sw</span> <span class="op">=</span> tx<span class="op">;</span></span>
<span id="cb17-1669"><a href="#cb17-1669" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span><span class="kw">this</span><span class="op">.</span><span class="at">_tableWidth</span> <span class="op">-</span> tx<span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb17-1670"><a href="#cb17-1670" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1671"><a href="#cb17-1671" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1672"><a href="#cb17-1672" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_adjust</span>() {</span>
<span id="cb17-1673"><a href="#cb17-1673" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> left <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_pw</span> <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_tableWidth</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sw</span> <span class="op">?</span> <span class="kw">this</span><span class="op">.</span><span class="at">_pw</span> <span class="op">+</span> <span class="dv">30</span> <span class="op">:</span> <span class="kw">this</span><span class="op">.</span><span class="at">_tableWidth</span> <span class="op">-</span> <span class="kw">this</span><span class="op">.</span><span class="at">_sw</span><span class="op">;</span></span>
<span id="cb17-1674"><a href="#cb17-1674" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span><span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>left<span class="sc">}</span><span class="vs">,0)`</span>)<span class="op">;</span></span>
<span id="cb17-1675"><a href="#cb17-1675" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1676"><a href="#cb17-1676" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1677"><a href="#cb17-1677" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addSelectorButton</span>(num<span class="op">,</span> tx) {</span>
<span id="cb17-1678"><a href="#cb17-1678" aria-hidden="true" tabindex="-1"></a>        tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1679"><a href="#cb17-1679" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> s <span class="op">=</span> num<span class="op">.</span><span class="fu">toString</span>()<span class="op">;</span></span>
<span id="cb17-1680"><a href="#cb17-1680" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> b <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getBBox</span>(s)<span class="op">;</span></span>
<span id="cb17-1681"><a href="#cb17-1681" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span><span class="op">.</span><span class="fu">append</span>(() <span class="kw">=&gt;</span></span>
<span id="cb17-1682"><a href="#cb17-1682" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_addButton</span>(s<span class="op">,</span> <span class="st">"selBtn"</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> b<span class="op">.</span><span class="at">width</span><span class="op">,</span> b<span class="op">.</span><span class="at">height</span><span class="op">,</span> tx<span class="op">,</span> num <span class="op">===</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span>)</span>
<span id="cb17-1683"><a href="#cb17-1683" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"num"</span><span class="op">,</span> num)</span>
<span id="cb17-1684"><a href="#cb17-1684" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> e <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_clickSelectorNumber</span>(e))</span>
<span id="cb17-1685"><a href="#cb17-1685" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">node</span>()</span>
<span id="cb17-1686"><a href="#cb17-1686" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb17-1687"><a href="#cb17-1687" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> b<span class="op">.</span><span class="at">width</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1688"><a href="#cb17-1688" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1689"><a href="#cb17-1689" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1690"><a href="#cb17-1690" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addPageButton</span>(pageNum<span class="op">,</span> tx) {</span>
<span id="cb17-1691"><a href="#cb17-1691" aria-hidden="true" tabindex="-1"></a>        tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1692"><a href="#cb17-1692" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> s <span class="op">=</span> pageNum<span class="op">.</span><span class="fu">toString</span>()<span class="op">;</span></span>
<span id="cb17-1693"><a href="#cb17-1693" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> b <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getBBox</span>(s)<span class="op">;</span></span>
<span id="cb17-1694"><a href="#cb17-1694" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span><span class="op">.</span><span class="fu">append</span>(() <span class="kw">=&gt;</span></span>
<span id="cb17-1695"><a href="#cb17-1695" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_addButton</span>(s<span class="op">,</span> <span class="st">"pageBtn"</span><span class="op">,</span> <span class="kw">true</span><span class="op">,</span> b<span class="op">.</span><span class="at">width</span><span class="op">,</span> b<span class="op">.</span><span class="at">height</span><span class="op">,</span> tx<span class="op">,</span> pageNum <span class="op">===</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span>)</span>
<span id="cb17-1696"><a href="#cb17-1696" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"pageNum"</span><span class="op">,</span> pageNum)</span>
<span id="cb17-1697"><a href="#cb17-1697" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">on</span>(<span class="st">"click"</span><span class="op">,</span> e <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_clickPageNumber</span>(e))</span>
<span id="cb17-1698"><a href="#cb17-1698" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">node</span>()</span>
<span id="cb17-1699"><a href="#cb17-1699" aria-hidden="true" tabindex="-1"></a>        )<span class="op">;</span></span>
<span id="cb17-1700"><a href="#cb17-1700" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> b<span class="op">.</span><span class="at">width</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1701"><a href="#cb17-1701" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1702"><a href="#cb17-1702" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1703"><a href="#cb17-1703" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addSeperator</span>(tx) {</span>
<span id="cb17-1704"><a href="#cb17-1704" aria-hidden="true" tabindex="-1"></a>        tx <span class="op">+=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1705"><a href="#cb17-1705" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> s <span class="op">=</span> <span class="st">"..."</span><span class="op">;</span></span>
<span id="cb17-1706"><a href="#cb17-1706" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> b <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getBBox</span>(s)<span class="op">;</span></span>
<span id="cb17-1707"><a href="#cb17-1707" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span><span class="op">.</span><span class="fu">append</span>(() <span class="kw">=&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_addButton</span>(s<span class="op">,</span> <span class="st">"seperator"</span><span class="op">,</span> <span class="kw">false</span><span class="op">,</span> b<span class="op">.</span><span class="at">width</span><span class="op">,</span> b<span class="op">.</span><span class="at">height</span><span class="op">,</span> tx)<span class="op">.</span><span class="fu">node</span>())<span class="op">;</span></span>
<span id="cb17-1708"><a href="#cb17-1708" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> b<span class="op">.</span><span class="at">width</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span> <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonSpacing</span><span class="op">;</span></span>
<span id="cb17-1709"><a href="#cb17-1709" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1710"><a href="#cb17-1710" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1711"><a href="#cb17-1711" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_addButton</span>(caption<span class="op">,</span> className<span class="op">,</span> rect<span class="op">,</span> w<span class="op">,</span> h<span class="op">,</span> tx<span class="op">,</span> selected) {</span>
<span id="cb17-1712"><a href="#cb17-1712" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> rw <span class="op">=</span> w <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span><span class="op">,</span></span>
<span id="cb17-1713"><a href="#cb17-1713" aria-hidden="true" tabindex="-1"></a>            rh <span class="op">=</span> h <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_buttonPadding</span> <span class="op">/</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb17-1714"><a href="#cb17-1714" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1715"><a href="#cb17-1715" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> d3<span class="op">.</span><span class="fu">create</span>(<span class="st">"svg:g"</span>)</span>
<span id="cb17-1716"><a href="#cb17-1716" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"class"</span><span class="op">,</span> className)</span>
<span id="cb17-1717"><a href="#cb17-1717" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"text-anchor"</span><span class="op">,</span> <span class="st">"middle"</span>)</span>
<span id="cb17-1718"><a href="#cb17-1718" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>tx<span class="sc">}</span><span class="vs">,0)`</span>)</span>
<span id="cb17-1719"><a href="#cb17-1719" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> {</span>
<span id="cb17-1720"><a href="#cb17-1720" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (rect)</span>
<span id="cb17-1721"><a href="#cb17-1721" aria-hidden="true" tabindex="-1"></a>                    g<span class="op">.</span><span class="fu">append</span>(<span class="st">"rect"</span>)</span>
<span id="cb17-1722"><a href="#cb17-1722" aria-hidden="true" tabindex="-1"></a>                        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"rx"</span><span class="op">,</span> <span class="dv">4</span>)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"ry"</span><span class="op">,</span> <span class="dv">4</span>)</span>
<span id="cb17-1723"><a href="#cb17-1723" aria-hidden="true" tabindex="-1"></a>                        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"width"</span><span class="op">,</span> rw)<span class="op">.</span><span class="fu">attr</span>(<span class="st">"height"</span><span class="op">,</span> rh)</span>
<span id="cb17-1724"><a href="#cb17-1724" aria-hidden="true" tabindex="-1"></a>                        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"opacity"</span><span class="op">,</span> selected <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)</span>
<span id="cb17-1725"><a href="#cb17-1725" aria-hidden="true" tabindex="-1"></a>                        <span class="op">.</span><span class="fu">attr</span>(<span class="st">"fill"</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_options</span><span class="op">.</span><span class="at">buttonColor</span>)</span>
<span id="cb17-1726"><a href="#cb17-1726" aria-hidden="true" tabindex="-1"></a>            })</span>
<span id="cb17-1727"><a href="#cb17-1727" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">call</span>(g <span class="kw">=&gt;</span> g<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)</span>
<span id="cb17-1728"><a href="#cb17-1728" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">attr</span>(<span class="st">"transform"</span><span class="op">,</span> <span class="vs">`translate(</span><span class="sc">${</span>rw <span class="op">/</span> <span class="dv">2</span><span class="sc">}</span><span class="vs">,</span><span class="sc">${</span>rh <span class="op">/</span> <span class="dv">2</span> <span class="op">+</span> h <span class="op">/</span> <span class="dv">4</span><span class="sc">}</span><span class="vs">)`</span>)</span>
<span id="cb17-1729"><a href="#cb17-1729" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">text</span>(caption))<span class="op">;</span></span>
<span id="cb17-1730"><a href="#cb17-1730" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1731"><a href="#cb17-1731" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1732"><a href="#cb17-1732" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_getBBox</span>(str) {</span>
<span id="cb17-1733"><a href="#cb17-1733" aria-hidden="true" tabindex="-1"></a>        <span class="kw">const</span> svg <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_table</span><span class="op">.</span><span class="at">svg</span><span class="op">;</span></span>
<span id="cb17-1734"><a href="#cb17-1734" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="op">!</span>svg) <span class="cf">return</span> { <span class="dt">width</span><span class="op">:</span> <span class="dv">0</span><span class="op">,</span> <span class="dt">height</span><span class="op">:</span> <span class="dv">0</span> }<span class="op">;</span></span>
<span id="cb17-1735"><a href="#cb17-1735" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb17-1736"><a href="#cb17-1736" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> t<span class="op">;</span></span>
<span id="cb17-1737"><a href="#cb17-1737" aria-hidden="true" tabindex="-1"></a>            <span class="cf">try</span> {</span>
<span id="cb17-1738"><a href="#cb17-1738" aria-hidden="true" tabindex="-1"></a>                t <span class="op">=</span> svg<span class="op">.</span><span class="fu">append</span>(<span class="st">"text"</span>)<span class="op">.</span><span class="fu">text</span>(str)<span class="op">;</span></span>
<span id="cb17-1739"><a href="#cb17-1739" aria-hidden="true" tabindex="-1"></a>                <span class="cf">return</span> t<span class="op">.</span><span class="fu">node</span>()<span class="op">.</span><span class="fu">getBBox</span>()<span class="op">;</span></span>
<span id="cb17-1740"><a href="#cb17-1740" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1741"><a href="#cb17-1741" aria-hidden="true" tabindex="-1"></a>            <span class="cf">finally</span> {</span>
<span id="cb17-1742"><a href="#cb17-1742" aria-hidden="true" tabindex="-1"></a>                t<span class="op">.</span><span class="fu">remove</span>()<span class="op">;</span></span>
<span id="cb17-1743"><a href="#cb17-1743" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1744"><a href="#cb17-1744" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1745"><a href="#cb17-1745" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1746"><a href="#cb17-1746" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1747"><a href="#cb17-1747" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_gotoPage</span>(pnum) {</span>
<span id="cb17-1748"><a href="#cb17-1748" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pnum <span class="op">&lt;</span> <span class="dv">1</span>)</span>
<span id="cb17-1749"><a href="#cb17-1749" aria-hidden="true" tabindex="-1"></a>            pnum <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-1750"><a href="#cb17-1750" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (pnum <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>)</span>
<span id="cb17-1751"><a href="#cb17-1751" aria-hidden="true" tabindex="-1"></a>            pnum <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1752"><a href="#cb17-1752" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1753"><a href="#cb17-1753" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pnum <span class="op">&lt;=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>) {</span>
<span id="cb17-1754"><a href="#cb17-1754" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (pnum <span class="op">&gt;=</span> <span class="dv">1</span> <span class="op">&amp;&amp;</span> pnum <span class="op">&lt;=</span> <span class="dv">4</span>) {</span>
<span id="cb17-1755"><a href="#cb17-1755" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-1756"><a href="#cb17-1756" aria-hidden="true" tabindex="-1"></a>                <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">&lt;=</span> <span class="dv">5</span>)</span>
<span id="cb17-1757"><a href="#cb17-1757" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1758"><a href="#cb17-1758" aria-hidden="true" tabindex="-1"></a>                <span class="cf">else</span></span>
<span id="cb17-1759"><a href="#cb17-1759" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb17-1760"><a href="#cb17-1760" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1761"><a href="#cb17-1761" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> <span class="cf">if</span> (pnum <span class="op">&gt;=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">-</span> <span class="dv">4</span> <span class="op">&amp;&amp;</span> pnum <span class="op">&lt;=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>) {</span>
<span id="cb17-1762"><a href="#cb17-1762" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">-</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb17-1763"><a href="#cb17-1763" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1764"><a href="#cb17-1764" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1765"><a href="#cb17-1765" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span> {</span>
<span id="cb17-1766"><a href="#cb17-1766" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> pnum <span class="op">-</span> <span class="dv">2</span><span class="op">;</span></span>
<span id="cb17-1767"><a href="#cb17-1767" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> pnum <span class="op">+</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-1768"><a href="#cb17-1768" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1769"><a href="#cb17-1769" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1770"><a href="#cb17-1770" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">=</span> pnum<span class="op">;</span></span>
<span id="cb17-1771"><a href="#cb17-1771" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span><span class="op">;</span></span>
<span id="cb17-1772"><a href="#cb17-1772" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1773"><a href="#cb17-1773" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1774"><a href="#cb17-1774" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_clickPageNumber</span>(e) {</span>
<span id="cb17-1775"><a href="#cb17-1775" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> btn <span class="op">=</span> e<span class="op">.</span><span class="at">currentTarget</span><span class="op">;</span></span>
<span id="cb17-1776"><a href="#cb17-1776" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> pnum <span class="op">=</span> <span class="op">+</span>btn<span class="op">.</span><span class="at">attributes</span>[<span class="st">"pageNum"</span>]<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb17-1777"><a href="#cb17-1777" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1778"><a href="#cb17-1778" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">=</span> pnum<span class="op">;</span></span>
<span id="cb17-1779"><a href="#cb17-1779" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (pnum <span class="op">==</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">&amp;&amp;</span> pnum <span class="op">!=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>) {</span>
<span id="cb17-1780"><a href="#cb17-1780" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span><span class="op">++;</span></span>
<span id="cb17-1781"><a href="#cb17-1781" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">+</span> <span class="dv">2</span> <span class="op">&gt;=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>) {</span>
<span id="cb17-1782"><a href="#cb17-1782" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1783"><a href="#cb17-1783" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">-</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb17-1784"><a href="#cb17-1784" aria-hidden="true" tabindex="-1"></a>            }</span>
<span id="cb17-1785"><a href="#cb17-1785" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb17-1786"><a href="#cb17-1786" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">-</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb17-1787"><a href="#cb17-1787" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderPaginator</span>()<span class="op">;</span></span>
<span id="cb17-1788"><a href="#cb17-1788" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1789"><a href="#cb17-1789" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (pnum <span class="op">==</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span>) {</span>
<span id="cb17-1790"><a href="#cb17-1790" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span><span class="op">--;</span></span>
<span id="cb17-1791"><a href="#cb17-1791" aria-hidden="true" tabindex="-1"></a>            <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">&lt;</span> <span class="dv">3</span>)</span>
<span id="cb17-1792"><a href="#cb17-1792" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="fu">_resetBoundary</span>()<span class="op">;</span></span>
<span id="cb17-1793"><a href="#cb17-1793" aria-hidden="true" tabindex="-1"></a>            <span class="cf">else</span></span>
<span id="cb17-1794"><a href="#cb17-1794" aria-hidden="true" tabindex="-1"></a>                <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">+</span> <span class="dv">3</span><span class="op">;</span></span>
<span id="cb17-1795"><a href="#cb17-1795" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderPaginator</span>()<span class="op">;</span></span>
<span id="cb17-1796"><a href="#cb17-1796" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1797"><a href="#cb17-1797" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (pnum <span class="op">==</span> <span class="dv">1</span>) {</span>
<span id="cb17-1798"><a href="#cb17-1798" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_resetBoundary</span>()<span class="op">;</span></span>
<span id="cb17-1799"><a href="#cb17-1799" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderPaginator</span>()<span class="op">;</span></span>
<span id="cb17-1800"><a href="#cb17-1800" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1801"><a href="#cb17-1801" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> <span class="cf">if</span> (pnum <span class="op">==</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">&amp;&amp;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">&gt;</span> <span class="dv">5</span>) {</span>
<span id="cb17-1802"><a href="#cb17-1802" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1803"><a href="#cb17-1803" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">-</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb17-1804"><a href="#cb17-1804" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_renderPaginator</span>()<span class="op">;</span></span>
<span id="cb17-1805"><a href="#cb17-1805" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1806"><a href="#cb17-1806" aria-hidden="true" tabindex="-1"></a>        <span class="cf">else</span> {</span>
<span id="cb17-1807"><a href="#cb17-1807" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_paginatorCell</span></span>
<span id="cb17-1808"><a href="#cb17-1808" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)</span>
<span id="cb17-1809"><a href="#cb17-1809" aria-hidden="true" tabindex="-1"></a>                <span class="op">.</span><span class="fu">nodes</span>()<span class="op">.</span><span class="fu">forEach</span>(node <span class="kw">=&gt;</span> {</span>
<span id="cb17-1810"><a href="#cb17-1810" aria-hidden="true" tabindex="-1"></a>                    <span class="kw">const</span> num <span class="op">=</span> <span class="op">+</span>node<span class="op">.</span><span class="at">parentElement</span><span class="op">.</span><span class="at">attributes</span>[<span class="st">"pageNum"</span>]<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb17-1811"><a href="#cb17-1811" aria-hidden="true" tabindex="-1"></a>                    node<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">"opacity"</span><span class="op">,</span> num <span class="op">===</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb17-1812"><a href="#cb17-1812" aria-hidden="true" tabindex="-1"></a>                })<span class="op">;</span></span>
<span id="cb17-1813"><a href="#cb17-1813" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1814"><a href="#cb17-1814" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1815"><a href="#cb17-1815" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onPageNumberChange</span>) {</span>
<span id="cb17-1816"><a href="#cb17-1816" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> r <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getRange</span>(pnum)<span class="op">;</span></span>
<span id="cb17-1817"><a href="#cb17-1817" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_onPageNumberChange</span>(pnum<span class="op">,</span> r<span class="op">.</span><span class="at">begin</span><span class="op">,</span> r<span class="op">.</span><span class="at">end</span>)<span class="op">;</span></span>
<span id="cb17-1818"><a href="#cb17-1818" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1819"><a href="#cb17-1819" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1820"><a href="#cb17-1820" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1821"><a href="#cb17-1821" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_clickSelectorNumber</span>(e) {</span>
<span id="cb17-1822"><a href="#cb17-1822" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> btn <span class="op">=</span> e<span class="op">.</span><span class="at">currentTarget</span><span class="op">;</span></span>
<span id="cb17-1823"><a href="#cb17-1823" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> num <span class="op">=</span> <span class="op">+</span>btn<span class="op">.</span><span class="at">attributes</span>[<span class="st">"num"</span>]<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb17-1824"><a href="#cb17-1824" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1825"><a href="#cb17-1825" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">recordsPerPage</span>(num)<span class="op">;</span></span>
<span id="cb17-1826"><a href="#cb17-1826" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_selectorCell</span></span>
<span id="cb17-1827"><a href="#cb17-1827" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">selectAll</span>(<span class="st">"rect"</span>)</span>
<span id="cb17-1828"><a href="#cb17-1828" aria-hidden="true" tabindex="-1"></a>            <span class="op">.</span><span class="fu">nodes</span>()<span class="op">.</span><span class="fu">forEach</span>(node <span class="kw">=&gt;</span> {</span>
<span id="cb17-1829"><a href="#cb17-1829" aria-hidden="true" tabindex="-1"></a>                <span class="kw">const</span> n <span class="op">=</span> <span class="op">+</span>node<span class="op">.</span><span class="at">parentElement</span><span class="op">.</span><span class="at">attributes</span>[<span class="st">"num"</span>]<span class="op">.</span><span class="at">value</span><span class="op">;</span></span>
<span id="cb17-1830"><a href="#cb17-1830" aria-hidden="true" tabindex="-1"></a>                node<span class="op">.</span><span class="fu">setAttribute</span>(<span class="st">"opacity"</span><span class="op">,</span> num <span class="op">===</span> n <span class="op">?</span> <span class="dv">1</span> <span class="op">:</span> <span class="dv">0</span>)<span class="op">;</span></span>
<span id="cb17-1831"><a href="#cb17-1831" aria-hidden="true" tabindex="-1"></a>            })<span class="op">;</span></span>
<span id="cb17-1832"><a href="#cb17-1832" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1833"><a href="#cb17-1833" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_gotoPage</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span>)<span class="op">;</span></span>
<span id="cb17-1834"><a href="#cb17-1834" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1835"><a href="#cb17-1835" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="fu">_renderPaginator</span>()<span class="op">;</span></span>
<span id="cb17-1836"><a href="#cb17-1836" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1837"><a href="#cb17-1837" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_onRecordsPerPageChange</span>) {</span>
<span id="cb17-1838"><a href="#cb17-1838" aria-hidden="true" tabindex="-1"></a>            <span class="kw">var</span> r <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="fu">_getRange</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span>)<span class="op">;</span></span>
<span id="cb17-1839"><a href="#cb17-1839" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="fu">_onRecordsPerPageChange</span>(<span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span><span class="op">,</span> <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span><span class="op">,</span> r<span class="op">.</span><span class="at">begin</span><span class="op">,</span> r<span class="op">.</span><span class="at">end</span>)<span class="op">;</span></span>
<span id="cb17-1840"><a href="#cb17-1840" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1841"><a href="#cb17-1841" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1842"><a href="#cb17-1842" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1843"><a href="#cb17-1843" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_getRange</span>(pnum) {</span>
<span id="cb17-1844"><a href="#cb17-1844" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> begin <span class="op">=</span> (pnum <span class="op">-</span> <span class="dv">1</span>) <span class="op">*</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span><span class="op">;</span></span>
<span id="cb17-1845"><a href="#cb17-1845" aria-hidden="true" tabindex="-1"></a>        <span class="kw">var</span> end <span class="op">=</span> begin <span class="op">+</span> <span class="kw">this</span><span class="op">.</span><span class="at">_recordsPerPage</span> <span class="op">-</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-1846"><a href="#cb17-1846" aria-hidden="true" tabindex="-1"></a>        <span class="cf">return</span> { <span class="dt">begin</span><span class="op">:</span> begin<span class="op">,</span> <span class="dt">end</span><span class="op">:</span> end }<span class="op">;</span></span>
<span id="cb17-1847"><a href="#cb17-1847" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1848"><a href="#cb17-1848" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1849"><a href="#cb17-1849" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_validateCurrentPage</span>() {</span>
<span id="cb17-1850"><a href="#cb17-1850" aria-hidden="true" tabindex="-1"></a>        <span class="cf">if</span> (<span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">&gt;</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span>) {</span>
<span id="cb17-1851"><a href="#cb17-1851" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currentPage</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1852"><a href="#cb17-1852" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span><span class="op">;</span></span>
<span id="cb17-1853"><a href="#cb17-1853" aria-hidden="true" tabindex="-1"></a>            <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">-</span> <span class="dv">4</span><span class="op">;</span></span>
<span id="cb17-1854"><a href="#cb17-1854" aria-hidden="true" tabindex="-1"></a>        }</span>
<span id="cb17-1855"><a href="#cb17-1855" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1856"><a href="#cb17-1856" aria-hidden="true" tabindex="-1"></a></span>
<span id="cb17-1857"><a href="#cb17-1857" aria-hidden="true" tabindex="-1"></a>    <span class="fu">_resetBoundary</span>() {</span>
<span id="cb17-1858"><a href="#cb17-1858" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currFloor</span> <span class="op">=</span> <span class="dv">1</span><span class="op">;</span></span>
<span id="cb17-1859"><a href="#cb17-1859" aria-hidden="true" tabindex="-1"></a>        <span class="kw">this</span><span class="op">.</span><span class="at">_currCeiling</span> <span class="op">=</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">&lt;=</span> <span class="dv">5</span> <span class="op">?</span> <span class="kw">this</span><span class="op">.</span><span class="at">_totalPages</span> <span class="op">:</span> <span class="dv">5</span><span class="op">;</span></span>
<span id="cb17-1860"><a href="#cb17-1860" aria-hidden="true" tabindex="-1"></a>    }</span>
<span id="cb17-1861"><a href="#cb17-1861" aria-hidden="true" tabindex="-1"></a>}</span></code><button title="Copy to Clipboard" class="code-copy-button"><i class="bi"></i></button></pre></div>
<div class="cell-output cell-output-display html-fill-item html-fill-container">
<div id="ojs-cell-17" data-nodetype="declaration" class="html-fill-item html-fill-container">

</div>
</div>
</div>
<bslib-tooltip placement="auto" bsoptions="[]" data-require-bs-version="5" data-require-bs-caller="tooltip()">
    <template>Expand</template>
    <span class="bslib-full-screen-enter badge rounded-pill">
        <svg xmlns="http://www.w3.org/2000/svg" viewbox="0 0 24 24" style="height:1em;width:1em;" aria-hidden="true" role="img"><path d="M20 5C20 4.4 19.6 4 19 4H13C12.4 4 12 3.6 12 3C12 2.4 12.4 2 13 2H21C21.6 2 22 2.4 22 3V11C22 11.6 21.6 12 21 12C20.4 12 20 11.6 20 11V5ZM4 19C4 19.6 4.4 20 5 20H11C11.6 20 12 20.4 12 21C12 21.6 11.6 22 11 22H3C2.4 22 2 21.6 2 21V13C2 12.4 2.4 12 3 12C3.6 12 4 12.4 4 13V19Z"></path></svg>
    </span>
</bslib-tooltip><script data-bslib-card-init="">bslib.Card.initializeAllCards();</script></div>


<div id="3ade8a4a-fb1d-4a6c-8409-ac45482d5fc9" class="hidden html-fill-item html-fill-container">

</div>
</div>
</div>
</div>


<script type="ojs-module-contents">
eyJjb250ZW50cyI6W3sibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBwcm9wX2luZCA9IElucHV0cy5zZWxlY3QobmV3IE1hcChtZXRhZGF0YS5maWx0ZXIoZCA9PiBkLnR5cGUgPT0gXCJzdG9ja1wiKS5tYXAoKGQpID0+IFtkLmRlc2NyaXB0aW9uLCBkLmlkXSkpLCB7bGFiZWw6XCJJbmRpY2F0b3IgMSA6IENpcmNsZXNcIiwgdmFsdWU6IFwicG9zXCJ9KVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTIiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY2hvcm9faW5kID0gSW5wdXRzLnNlbGVjdChuZXcgTWFwKG1ldGFkYXRhLmZpbHRlcihkID0+IGQudHlwZSA9PSBcInJhdGlvXCIpLm1hcCgoZCkgPT4gW2QuZGVzY3JpcHRpb24sIGQuaWRdKSksIHtsYWJlbDpcIkluZGljYXRvciAyOiBDb2xvciBwYWxldHRlXCIsIHZhbHVlOiBcIkhFSUdIVE1cIn0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiB0aWxlcyA9IElucHV0cy5zZWxlY3QoW1wid29ybGRTdHJlZXRcIiwgXCJvcGVuc3RyZWV0bWFwXCIsIFwid29ybGRpbWFnZXJ5XCIsIFwib3BlbnRvcG9tYXBcIl0sIHtcclxuICBsYWJlbDogXCJUaWxlc1wiLFxyXG4gIHZhbHVlOiBcIndvcmxkaW1hZ2VyeVwiXHJcbn0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtNCIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBrID0gSW5wdXRzLnJhbmdlKFs0LCA1MF0sIHsgbGFiZWw6IFwiQ2lyY2xlIHNpemVcIiwgc3RlcDogMSwgdmFsdWU6MzAgfSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC01IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoic3ZnID0gdml6LmNyZWF0ZSh7XHJcbiAgICB3aWR0aDogODAwLCBcclxuICAgIGRvbWFpbjogcGVha3MsIFxyXG4gICAgbWFyZ2luOiAxNTAsXHJcbiAgICBwcm9qZWN0aW9uOiBkMy5nZW9NZXJjYXRvcigpLFxyXG4gICAgem9vbWFibGU6IHRydWV9KVxyXG50aWxlID0gc3ZnLnRpbGUoe3VybDogdGlsZXMsIGlkOiBcInRpbGVcIiB9KVxyXG5zeW1iID0gc3ZnLnBsb3Qoe3R5cGU6IFwicHJvcGNob3JvXCIsIGlkOiBcInN5bWJcIixcclxuICAgICAgICAgICAgZGF0YTogcGVha3MsXHJcbiAgICAgICAgICAgIHZhcjE6IHByb3BfaW5kLFxyXG4gICAgICAgICAgICB2YXIyOiBjaG9yb19pbmQsXHJcbiAgICAgICAgICAgIGJyZWFrczogYmtzLFxyXG4gICAgICAgICAgICBmaXhtYXg6IHZhbG1heCxcclxuICAgICAgICAgICAgY29sb3JzOiBcIlN1bnNldFwiLFxyXG4gICAgICAgICAgICB0aXA6IGAkUEtDT05TT2AsXHJcbiAgICAgICAgICAgIGssXHJcbiAgICAgICAgICAgIGxlZzFfdGl0bGU6IFwiSW5kaWNhdG9yIDFcIixcclxuICAgICAgICAgICAgbGVnMV9mcmFtZTogdHJ1ZSxcclxuICAgICAgICAgICAgbGVnMV9mcmFtZV9maWxsIDogXCJ3aGl0ZVwiLFxyXG4gICAgICAgICAgICBsZWcxX2ZyYW1lX3N0cm9rZTogXCIjZmZmZmZmNTBcIixcclxuICAgICAgICAgICAgbGVnMl90aXRsZTogXCJJbmRpY2F0b3IgMlwiLFxyXG4gICAgICAgICAgICBsZWcyX2ZyYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICBsZWcyX2ZyYW1lX2ZpbGwgOiBcIndoaXRlXCIsXHJcbiAgICAgICAgICAgIGxlZzJfZnJhbWVfc3Ryb2tlOiBcIiNmZmZmZmY1MFwifSk7XHJcbnNjYWxlID0gc3ZnLnNjYWxlYmFyKHtpZDogXCJzY2FsZVwifSk7XHJcbnN2Zy5yZW5kZXIoe29yZGVyOiBbdGlsZSwgc3ltYiwgc2NhbGVdfSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC02IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gZmlnLWhlaWdodDogMTBcclxue1xyXG4gIGNvbnN0IHN2ZyA9IGQzLmNyZWF0ZShcInN2Z1wiKVxyXG4gICAgLmF0dHIoXCJmb250LXNpemVcIiwgXCIxMHB0XCIpXHJcbiAgICAuYXR0cihcInZpZXdCb3hcIiwgWzAsIDAsIHdpZHRoLCA4MDBdKTtcclxuICBcclxuICBkb2N1bWVudC5ib2R5LmFwcGVuZChzdmcubm9kZSgpKTtcclxuICBcclxuICBuZXcgU1ZHVGFibGUoc3ZnKVxyXG4gICAgLnNpemUoW3dpZHRoLCA4MDBdKVxyXG4gICAgLmZpeGVkUm93cygwKVxyXG4gICAgLnJvd3NQZXJQYWdlKDc1KVxyXG4gICAgLmZpeGVkQ29sdW1ucygxKVxyXG4gICAgLmRlZmF1bHROdW1iZXJGb3JtYXQoXCIsLjFkXCIpXHJcbiAgICAuc3R5bGUoeyBib3JkZXI6IGZhbHNlIH0pXHJcbiAgICAuZGF0YShkYXRhX3BlYWtzKSAgXHJcbiAgICAub25oaWdobGlnaHQoY29udGV4dCA9PiB7IC8qIGRvIHNvbWV0aGluZyAqLyB9KVxyXG4gICAgLnJlbmRlcigpOyAgICBcclxuXHJcbiAgc3ZnLm5vZGUoKS5yZW1vdmUoKTtcclxuICByZXR1cm4gc3ZnLm5vZGUoKTtcclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTciLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgcHJvcF9pbmQyID0gSW5wdXRzLnNlbGVjdChuZXcgTWFwKG1ldGFkYXRhX3dvcmxkLmZpbHRlcihkID0+IGQudHlwZSA9PSBcInN0b2NrXCIpLm1hcCgoZCkgPT4gW2QuZGVzY3JpcHRpb24sIGQuaWRdKSksIHtsYWJlbDpcIkluZGljYXRvciAxIDogQ2lyY2xlc1wiLCB2YWx1ZTogXCJUT1RfQUxMXCJ9KVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTgiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJ2aWV3b2YgY2hvcm9faW5kMiA9IElucHV0cy5zZWxlY3QobmV3IE1hcChtZXRhZGF0YV93b3JsZC5maWx0ZXIoZCA9PiBkLnR5cGUgPT0gXCJyYXRpb1wiKS5tYXAoKGQpID0+IFtkLmRlc2NyaXB0aW9uLCBkLmlkXSkpLCB7bGFiZWw6XCJJbmRpY2F0b3IgMjogQ29sb3IgcGFsZXR0ZVwiLCB2YWx1ZTogXCJSVF9QT1BcIn0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtOSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6InZpZXdvZiBrMiA9IElucHV0cy5yYW5nZShbNCwgNTBdLCB7IGxhYmVsOiBcIkNpcmNsZSBzaXplXCIsIHN0ZXA6IDEsIHZhbHVlOjMwIH0pXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTAiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJzdmcyID0gdml6LmNyZWF0ZSh7XHJcbiAgICB3aWR0aDogOTAwLCBcclxuICAgIGRvbWFpbjogd29ybGQsIFxyXG4gICAgbWFyZ2luOiAwLFxyXG4gICAgcHJvamVjdGlvbjogZDMuZ2VvTmF0dXJhbEVhcnRoMSgpLFxyXG4gICAgem9vbWFibGU6IHRydWV9KVxyXG5vdXRsaW5lID0gc3ZnMi5vdXRsaW5lKHtpZDpcIm91dGxpbmVcIn0pO1xyXG5jb3VudHJpZXMgPSBzdmcyLnBhdGgoeyBkYXR1bTogd29ybGQsIGZpbGw6IFwid2hpdGVcIiwgZmlsbE9wYWNpdHk6IDAuMywgaWQ6IFwiY291bnRyaWVzXCIgfSk7XHJcbmNob3JvID0gc3ZnMi5wbG90KHt0eXBlOiBcImNob3JvXCIsIFxyXG4gICAgICAgICAgICAgaWQ6XCJjaG9yb1wiLFxyXG4gICAgICAgICAgICBkYXRhOiB3b3JsZCxcclxuICAgICAgICAgICAgdmFyOiBjaG9yb19pbmQyLFxyXG4gICAgICAgICAgICBjb2xvcnM6IFwiU3Vuc2V0XCIsXHJcbiAgICAgICAgICAgIHRpcDogYCROQU1FZW5gLFxyXG4gICAgICAgICAgICBicmVha3M6IGJrczIsXHJcbiAgICAgICAgICAgIGxlZ19wb3M6IFswLDI1MF0sXHJcbiAgICAgICAgICAgIGxlZ190aXRsZTogXCJJbmRpY2F0b3IgMlwiLFxyXG4gICAgICAgICAgICBsZWdfZnJhbWU6IHRydWUsXHJcbiAgICAgICAgICAgIGxlZ19taXNzaW5nX3RleHQ6IFwiTm8gYXNjZW50XCIsXHJcbiAgICAgICAgICAgIGxlZ19mcmFtZV9maWxsIDogXCJ3aGl0ZVwiLFxyXG4gICAgICAgICAgICBsZWdfZnJhbWVfc3Ryb2tlOiBcIiNmZmZmZmY1MFwifSk7XHJcbnByb3AgPSAgc3ZnMi5wbG90KHt0eXBlOiBcInByb3BcIiwgXHJcbiAgICAgICAgICAgIGlkOlwicHJvcFwiLFxyXG4gICAgICAgICAgICBkYXRhOiB3b3JsZCxcclxuICAgICAgICAgICAgdmFyOiBwcm9wX2luZDIsXHJcbiAgICAgICAgICAgIHRpcDogYCROQU1FZW5gLFxyXG4gICAgICAgICAgICBmaWxsOiBcIiNmZmZmZmY1MFwiLFxyXG4gICAgICAgICAgICBrOiBrMixcclxuICAgICAgICAgICAgZml4bWF4OiB2YWxtYXgyLFxyXG4gICAgICAgICAgICBsZWdfdGl0bGU6IFwiSW5kaWNhdG9yIDFcIixcclxuICAgICAgICAgICAgbGVnX2ZyYW1lOiB0cnVlLFxyXG4gICAgICAgICAgICBsZWdfZnJhbWVfZmlsbCA6IFwid2hpdGVcIixcclxuICAgICAgICAgICAgbGVnX2ZyYW1lX3N0cm9rZTogXCIjZmZmZmZmODBcIn0pO1xyXG5zdmcyLnJlbmRlcih7b3JkZXI6W291dGxpbmUsIGNvdW50cmllcywgY2hvcm8sIHByb3BdfSlcclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMSIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGZpZy1oZWlnaHQ6IDEwXHJcbntcclxuICBjb25zdCBzdmcgPSBkMy5jcmVhdGUoXCJzdmdcIilcclxuICAgIC5hdHRyKFwiZm9udC1zaXplXCIsIFwiMTBwdFwiKVxyXG4gICAgLmF0dHIoXCJ2aWV3Qm94XCIsIFswLCAwLCB3aWR0aCwgODAwXSk7XHJcbiAgXHJcbiAgZG9jdW1lbnQuYm9keS5hcHBlbmQoc3ZnLm5vZGUoKSk7XHJcbiAgXHJcbiAgbmV3IFNWR1RhYmxlKHN2ZylcclxuICAgIC5zaXplKFt3aWR0aCwgODAwXSlcclxuICAgIC5maXhlZFJvd3MoMClcclxuICAgIC5yb3dzUGVyUGFnZSg3NSlcclxuICAgIC5maXhlZENvbHVtbnMoMSlcclxuICAgIC5kZWZhdWx0TnVtYmVyRm9ybWF0KFwiLC4xZFwiKVxyXG4gICAgLnN0eWxlKHsgYm9yZGVyOiBmYWxzZSB9KVxyXG4gICAgLmRhdGEoZGF0YV93b3JsZCkgIFxyXG4gICAgLm9uaGlnaGxpZ2h0KGNvbnRleHQgPT4geyAvKiBkbyBzb21ldGhpbmcgKi8gfSlcclxuICAgIC5yZW5kZXIoKTsgICAgXHJcblxyXG4gIHN2Zy5ub2RlKCkucmVtb3ZlKCk7XHJcbiAgcmV0dXJuIHN2Zy5ub2RlKCk7XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xMiIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6IiBcclxuLy8gRGVmaW5lIGJyZWFrcyBtYW51YWxseSBNYXAgMVxyXG5ia3MgPSBtZXRhZGF0YVxyXG4gIC5maW5kKChkKSA9PiBkLmlkID09IGNob3JvX2luZClcclxuICAuYnJlYWtzLnJlcGxhY2UoXCJbXCIsIFwiXCIpXHJcbiAgLnJlcGxhY2UoXCJdXCIsIFwiXCIpXHJcbiAgLnNwbGl0KFwiLFwiKVxyXG4gIC5tYXAoKGQpID0+IHBhcnNlRmxvYXQoZCkpXHJcbiAgXHJcbnZhbG1heCA9IG1ldGFkYXRhXHJcbiAgLmZpbmQoKGQpID0+IGQuaWQgPT0gcHJvcF9pbmQpXHJcbiAgLmJyZWFrcy5yZXBsYWNlKFwiW1wiLCBcIlwiKVxyXG4gIC5yZXBsYWNlKFwiXVwiLCBcIlwiKVxyXG4gIC5zcGxpdChcIixcIilcclxuICAubWFwKChkKSA9PiBwYXJzZUZsb2F0KGQpKVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTEzIiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiIFxyXG4vLyBEZWZpbmUgYnJlYWtzIG1hbnVhbGx5IE1hcDJcclxuYmtzMiA9IG1ldGFkYXRhX3dvcmxkXHJcbiAgLmZpbmQoKGQpID0+IGQuaWQgPT0gY2hvcm9faW5kMilcclxuICAuYnJlYWtzLnJlcGxhY2UoXCJbXCIsIFwiXCIpXHJcbiAgLnJlcGxhY2UoXCJdXCIsIFwiXCIpXHJcbiAgLnNwbGl0KFwiLFwiKVxyXG4gIC5tYXAoKGQpID0+IHBhcnNlRmxvYXQoZCkpXHJcbiAgXHJcbnZhbG1heDIgPSBtZXRhZGF0YV93b3JsZFxyXG4gIC5maW5kKChkKSA9PiBkLmlkID09IHByb3BfaW5kMilcclxuICAuYnJlYWtzLnJlcGxhY2UoXCJbXCIsIFwiXCIpXHJcbiAgLnJlcGxhY2UoXCJdXCIsIFwiXCIpXHJcbiAgLnNwbGl0KFwiLFwiKVxyXG4gIC5tYXAoKGQpID0+IHBhcnNlRmxvYXQoZCkpXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTQiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcclxuLy8gY2FydG9cclxudml6ID0gcmVxdWlyZShcImdlb3ZpekAwLjcuMlwiKVxyXG5kaWNvcGFsID0gaW1wb3J0KFwiZGljb3BhbEAwLjguMVwiKVxyXG5cclxuLy8gcGFyYW1hdGVyc1xyXG5maXhtYXggPSBkMy5tYXgocGVha3MubWFwKGQgPT4gK2RbaW5kaWNhdG9yXSkpXHJcblxyXG4vLyBwZWFrc1xyXG50X3BlYWtzID0gRmlsZUF0dGFjaG1lbnQoXCJkYXRhX2NvbnNvL3BlYWtfNjcwMF90X2RhdGEuY3N2XCIpLmNzdigpXHJcbm1ldGFkYXRhID0gRmlsZUF0dGFjaG1lbnQoXCJkYXRhX2NvbnNvL21ldGFkYXRhLmNzdlwiKS5jc3YoKVxyXG5kYXRhX3BlYWtzID0gcGVha3MuZmVhdHVyZXMubWFwKGQgPT4gZC5wcm9wZXJ0aWVzKVxyXG5wZWFrcyA9IEZpbGVBdHRhY2htZW50KFwiZGF0YV9jb25zby9wZWFrXzY3MDBfZ2VvbG9jX2RhdGEuZ2VvanNvblwiKS5qc29uKClcclxuXHJcblxyXG4vLyBXb3JsZCBkYXRhXHJcbm1ldGFkYXRhX3dvcmxkID0gRmlsZUF0dGFjaG1lbnQoXCJkYXRhX2NvbnNvL21ldGFkYXRhX3dvcmxkLmNzdlwiKS5jc3YoKVxyXG5kYXRhX3dvcmxkID0gd29ybGQuZmVhdHVyZXMubWFwKGQgPT4gZC5wcm9wZXJ0aWVzKVxyXG53b3JsZCA9IEZpbGVBdHRhY2htZW50KFwiZGF0YV9jb25zby93b3JsZF9kYXRhLmdlb2pzb25cIikuanNvbigpXHJcbiJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldCIsImNlbGxOYW1lIjoib2pzLWNlbGwtMTUiLCJpbmxpbmUiOmZhbHNlLCJzb3VyY2UiOiJcclxuLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuYWx5emVyMjAwNC9zdmd0YWJsZVxyXG4vLyBDb3B5cmlnaHQgMjAyMCBFcmljIExvXHJcbmNsYXNzIFNWR1RhYmxlIHtcclxuICAgIGNvbnN0cnVjdG9yKHN2ZywgY29udGFpbmVyKSB7XHJcbiAgICAgICAgdGhpcy5fc3ZnID0gc3ZnO1xyXG4gICAgICAgIHRoaXMuX2NvbnRhaW5lciA9IGNvbnRhaW5lciB8fCBzdmc7XHJcbiAgICAgICAgdGhpcy5fZyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fY2hhckJveCA9IHsgeDogMCwgeTogMCwgd2lkdGg6IDAsIGhlaWdodDogMCB9O1xyXG5cclxuICAgICAgICB0aGlzLl9hdXRvU2l6ZUNlbGwgPSB0cnVlO1xyXG4gICAgICAgIHRoaXMuX2RlZmF1bHRDb2x1bW5XaWR0aCA9IDEwMDtcclxuICAgICAgICB0aGlzLl9jZWxsSGVpZ2h0ID0gMjQ7IC8vIHVzZXIgc2V0dGluZ1xyXG4gICAgICAgIHRoaXMuX2NlbGxIZWlnaHRBID0gMjQ7IC8vIGFjdHVhbCBjZWxsIGhlaWdodCA9IGNlbGxIZWlnaHQgKyBjZWxsUGFkZGluZ1YgKiAyXHJcbiAgICAgICAgdGhpcy5fY2VsbFBhZGRpbmdIID0gMTA7XHJcbiAgICAgICAgdGhpcy5fY2VsbFBhZGRpbmdWID0gMztcclxuICAgICAgICB0aGlzLl9maXhlZENvbHVtbnMgPSAwO1xyXG4gICAgICAgIHRoaXMuX2ZpeGVkUm93cyA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuX2xlZnQgPSAwO1xyXG4gICAgICAgIHRoaXMuX3RvcCA9IDA7XHJcbiAgICAgICAgdGhpcy5fd2lkdGggPSA0MDA7XHJcbiAgICAgICAgdGhpcy5faGVpZ2h0ID0gMzAwO1xyXG4gICAgICAgIHRoaXMuX3dpZHRoQSA9IDA7XHJcbiAgICAgICAgdGhpcy5faGVpZ2h0QSA9IDA7XHJcbiAgICAgICAgdGhpcy5fc2xpZGVyV2lkdGggPSAxMztcclxuICAgICAgICB0aGlzLl9zbGlkZXJMZW5ndGggPSA1MDtcclxuXHJcbiAgICAgICAgdGhpcy5feGYgPSAxOyAvLyBob3Jpem9udGFsIGNvbnRlbnQgdG8gc2Nyb2xsIGZhY3RvclxyXG4gICAgICAgIHRoaXMuX3lmID0gMTsgLy8gdmVydGljYWwgY29udGVudCB0byBzY3JvbGwgZmFjdG9yXHJcbiAgICAgICAgdGhpcy5fbWluWSA9IDA7IC8vIG1pbmltdW0geSBvZiB0aGUgY29udGVudCBjYW4gYmUgc2Nyb2xsZWRcclxuICAgICAgICB0aGlzLl9maXhlZFdpZHRoID0gMDtcclxuICAgICAgICB0aGlzLl9maXhlZEhlaWdodCA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuX2RhdGEgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2Z1bGxEYXRhID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9kYXRhSXNBcnJheSA9IGZhbHNlO1xyXG4gICAgICAgIHRoaXMuX2NvbHVtbnMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2RlZmF1bHROdW1iZXJGb3JtYXQgPSBcIiQsLjJmXCI7XHJcblxyXG4gICAgICAgIHRoaXMuX2hlYXRtYXAgPSBmYWxzZTtcclxuICAgICAgICB0aGlzLl9oZWF0bWFwUGFsZXR0ZSA9IG51bGw7IC8vIGludGVycG9sYXRvciBvciBhcnJheSBvZiBjb2xvcnNcclxuICAgICAgICB0aGlzLl9oZWF0bWFwQ29sb3IgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLl9wYWdpbmF0b3IgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3BhZ2luYXRvclBvcyA9IFwidG9wXCI7XHJcbiAgICAgICAgdGhpcy5fcm93Q291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMuX2N1cnJQYWdlTnVtID0gMDtcclxuICAgICAgICB0aGlzLl9yb3dzUGVyUGFnZSA9IDUwO1xyXG4gICAgICAgIHRoaXMuX2JlZ2luSW5kZXggPSAwO1xyXG4gICAgICAgIHRoaXMuX2VuZEluZGV4ID0gNDk7XHJcbiAgICAgICAgdGhpcy5fcm93c1BlclBhZ2VTZWxlY3Rpb25zID0gWzI1LCA1MCwgNzVdO1xyXG5cclxuICAgICAgICB0aGlzLl9zY3JvbGxiYXIgPSB7XHJcbiAgICAgICAgICAgIGhvcml6b250YWw6IG51bGwsXHJcbiAgICAgICAgICAgIHZlcnRpY2FsOiBudWxsLFxyXG4gICAgICAgICAgICB2aXNpYmxlOiBbdHJ1ZSwgdHJ1ZV1cclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLl9zdHlsZSA9IHtcclxuICAgICAgICAgICAgYm9yZGVyOiB0cnVlLFxyXG4gICAgICAgICAgICBib3JkZXJDb2xvcjogXCIjYWFhXCIsXHJcbiAgICAgICAgICAgIHRleHRDb2xvcjogXCJibGFja1wiLFxyXG4gICAgICAgICAgICBiYWNrZ3JvdW5kOiBcIndoaXRlXCIsXHJcbiAgICAgICAgICAgIGhlYWRlckJhY2tncm91bmQ6IFwiI2RkZFwiLFxyXG4gICAgICAgICAgICBmaXhlZEJhY2tncm91bmQ6IFwiI2VlZVwiLFxyXG4gICAgICAgICAgICBoaWdobGlnaHQ6IFwiY3Jvc3NcIiwgLy8gbm9uZSwgY2VsbCwgY3Jvc3NcclxuICAgICAgICAgICAgaGlnaGxpZ2h0QmFja2dyb3VuZDogXCIjZmZmM2IwXCJcclxuICAgICAgICB9O1xyXG5cclxuICAgICAgICB0aGlzLl90YWJsZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5faGVhZGVyID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9ib2R5ID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9kYXRhQXJlYSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fZGF0YUhlYWRlciA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuX2ZvY3VzID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9vbnNvcnQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX29uY2hhbmdlcGFnZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fb25oaWdobGlnaHQgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX29uY2xpY2sgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX29uY29udGV4dG1lbnUgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLl91bmlxdWVJZCA9IG5ldyBTdHJpbmcoRGF0ZS5ub3coKSAqIE1hdGgucmFuZG9tKCkpLnJlcGxhY2UoXCIuXCIsIFwiXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIGRlZmF1bHRDb2x1bW5XaWR0aChfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fZGVmYXVsdENvbHVtbldpZHRoID0gK18sIHRoaXMpIDogdGhpcy5fZGVmYXVsdENvbHVtbldpZHRoO1xyXG4gICAgfVxyXG5cclxuICAgIGNlbGxIZWlnaHQoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX2NlbGxIZWlnaHQgPSArXywgdGhpcykgOiB0aGlzLl9jZWxsSGVpZ2h0O1xyXG4gICAgfVxyXG5cclxuICAgIGNlbGxQYWRkaW5nSChfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fY2VsbFBhZGRpbmdIID0gK18sIHRoaXMpIDogdGhpcy5fY2VsbFBhZGRpbmdIO1xyXG4gICAgfVxyXG5cclxuICAgIGNlbGxQYWRkaW5nVihfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fY2VsbFBhZGRpbmdWID0gK18sIHRoaXMpIDogdGhpcy5fY2VsbFBhZGRpbmdWO1xyXG4gICAgfVxyXG5cclxuICAgIGF1dG9TaXplQ2VsbChfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fYXV0b1NpemVDZWxsID0gXywgdGhpcykgOiB0aGlzLl9hdXRvU2l6ZUNlbGw7XHJcbiAgICB9XHJcblxyXG4gICAgZml4ZWRDb2x1bW5zKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9maXhlZENvbHVtbnMgPSArXywgdGhpcykgOiB0aGlzLl9maXhlZENvbHVtbnM7XHJcbiAgICB9XHJcblxyXG4gICAgZml4ZWRSb3dzKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9maXhlZFJvd3MgPSArXywgdGhpcykgOiB0aGlzLl9maXhlZFJvd3M7XHJcbiAgICB9XHJcblxyXG4gICAgcm93c1BlclBhZ2UoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX3Jvd3NQZXJQYWdlID0gK18sIHRoaXMpIDogdGhpcy5fcm93c1BlclBhZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgcm93c1BlclBhZ2VTZWxlY3Rpb25zKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9yb3dzUGVyUGFnZVNlbGVjdGlvbnMgPSBfLCB0aGlzKSA6IHRoaXMuX3Jvd3NQZXJQYWdlU2VsZWN0aW9ucztcclxuICAgIH1cclxuXHJcbiAgICBleHRlbnQoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKFxyXG4gICAgICAgICAgICB0aGlzLl9sZWZ0ID0gK19bMF1bMF0sIHRoaXMuX3RvcCA9ICtfWzBdWzFdLFxyXG4gICAgICAgICAgICB0aGlzLl93aWR0aCA9ICtfWzFdWzBdLCB0aGlzLl9oZWlnaHQgPSArX1sxXVsxXSwgdGhpcykgOiBbW3RoaXMuX2xlZnQsIHRoaXMuX3RvcF0sIFt0aGlzLl93aWR0aCwgdGhpcy5faGVpZ2h0XV07XHJcbiAgICB9XHJcblxyXG4gICAgc2l6ZShfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fd2lkdGggPSArX1swXSwgdGhpcy5faGVpZ2h0ID0gK19bMV0sIHRoaXMpIDogW3RoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHRdO1xyXG4gICAgfVxyXG5cclxuICAgIHN0eWxlKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9zdHlsZSA9IE9iamVjdC5hc3NpZ24odGhpcy5fc3R5bGUsIF8pLCB0aGlzKSA6IHRoaXMuX3N0eWxlO1xyXG4gICAgfVxyXG5cclxuICAgIGhlYXRtYXAoXykge1xyXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXRtYXAgPSBfO1xyXG4gICAgICAgICAgICBpZiAodGhpcy5fdGFibGUpIHRoaXMuX3VwZGF0ZUhlYXRtYXAoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlYXRtYXA7XHJcbiAgICB9XHJcblxyXG4gICAgaGVhdG1hcFBhbGV0dGUoXykge1xyXG4gICAgICAgIGlmIChhcmd1bWVudHMubGVuZ3RoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXRtYXBQYWxldHRlID0gXztcclxuICAgICAgICAgICAgaWYgKHRoaXMuX3RhYmxlKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9wcm9jZXNzSGVhdG1hcCgpO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2hlYXRtYXApIHRoaXMuX3VwZGF0ZUhlYXRtYXAoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcztcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gdGhpcy5faGVhdG1hcFBhbGV0dGU7XHJcbiAgICB9XHJcblxyXG4gICAgZGF0YShfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fZGF0YSA9IF8sIHRoaXMpIDogdGhpcy5fZGF0YTtcclxuICAgIH1cclxuXHJcbiAgICBjb2x1bW5zKF8pIHtcclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLl9jb2x1bW5zID0gXztcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX2NvbHVtbnMgJiYgdGhpcy5fZGF0YSkgdGhpcy5fcHJvY2Vzc0NvbHVtbnMoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2NvbHVtbnM7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIGRlZmF1bHROdW1iZXJGb3JtYXQoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX2RlZmF1bHROdW1iZXJGb3JtYXQgPSBfLCB0aGlzKSA6IHRoaXMuX2RlZmF1bHROdW1iZXJGb3JtYXQ7XHJcbiAgICB9XHJcblxyXG4gICAgb25zb3J0KF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9vbnNvcnQgPSBfLCB0aGlzKSA6IHRoaXMuX29uc29ydDtcclxuICAgIH1cclxuXHJcbiAgICBvbmNoYW5nZXBhZ2UoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX29uY2hhbmdlcGFnZSA9IF8sIHRoaXMpIDogdGhpcy5fb25jaGFuZ2VwYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIG9uaGlnaGxpZ2h0KF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9vbmhpZ2hsaWdodCA9IF8sIHRoaXMpIDogdGhpcy5fb25oaWdobGlnaHQ7XHJcbiAgICB9XHJcblxyXG4gICAgb25jbGljayhfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fb25jbGljayA9IF8sIHRoaXMpIDogdGhpcy5fb25jbGljaztcclxuICAgIH1cclxuXHJcbiAgICBvbmNvbnRleHRtZW51KF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9vbmNvbnRleHRtZW51ID0gXywgdGhpcykgOiB0aGlzLl9vbmNvbnRleHRtZW51O1xyXG4gICAgfVxyXG5cclxuICAgIHJlbmRlcigpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX3ZhbGlkYXRlKCkpIHtcclxuICAgICAgICAgICAgLy8gZXJyb3JcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2luaXQoKTtcclxuICAgICAgICAgICAgdGhpcy5faW5pdFBhZ2luYXRvcigpO1xyXG4gICAgICAgICAgICB0aGlzLl9wcm9jZXNzQ29sdW1ucygpO1xyXG4gICAgICAgICAgICB0aGlzLl9wcmVwYXJlKCk7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9jYWxjQ29uc3RyYWlucygpO1xyXG4gICAgICAgICAgICB0aGlzLl9jcmVhdGVDbGlwUGF0aHMoKTtcclxuXHJcbiAgICAgICAgICAgIHRoaXMuX3Byb2Nlc3NIZWF0bWFwKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX2NyZWF0ZVRhYmxlKCk7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckJvZHkodGhpcy5fdGFibGUpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJIZWFkZXIodGhpcy5fdGFibGUpO1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRTY3JvbGxiYXJzKCk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9wYWdpbmF0b3IpIHRoaXMuX3BhZ2luYXRvci5yZW5kZXIoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0Um93RGF0YShpbmRleCkge1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhW2luZGV4XTtcclxuICAgIH1cclxuXHJcbiAgICBnZXRDb2x1bW5EYXRhKGluZGV4KSB7XHJcbiAgICAgICAgY29uc3QgYyA9IHRoaXMuX2NvbHVtbnNbaW5kZXhdO1xyXG4gICAgICAgIHJldHVybiB0aGlzLl9kYXRhLm1hcChfID0+IF9bYy5uYW1lXSk7XHJcbiAgICB9XHJcblxyXG4gICAgZ2V0IGcoKSB7IHJldHVybiB0aGlzLl9nOyB9XHJcblxyXG4gICAgZ2V0IHN2ZygpIHsgcmV0dXJuIHRoaXMuX3N2ZzsgfVxyXG5cclxuICAgIF9pbml0KCkge1xyXG4gICAgICAgIHRoaXMuX2cgPSB0aGlzLl9jb250YWluZXIuYXBwZW5kKFwiZ1wiKTtcclxuICAgICAgICB0aGlzLl9jZWxsSGVpZ2h0QSA9IHRoaXMuX2NlbGxIZWlnaHQgKyB0aGlzLl9jZWxsUGFkZGluZ1YgKiAyO1xyXG4gICAgICAgIHRoaXMuX2NoYXJCb3ggPSB0aGlzLl9nZXRCQm94KFwiWlwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fd2lkdGhBID0gdGhpcy5fd2lkdGg7XHJcbiAgICAgICAgdGhpcy5faGVpZ2h0QSA9IHRoaXMuX2hlaWdodDtcclxuICAgIH1cclxuXHJcbiAgICBfaW5pdFBhZ2luYXRvcigpIHtcclxuICAgICAgICBpZiAodGhpcy5fZGF0YS5sZW5ndGggPiB0aGlzLl9yb3dzUGVyUGFnZSkge1xyXG4gICAgICAgICAgICB0aGlzLl9mdWxsRGF0YSA9IHRoaXMuX2RhdGE7XHJcbiAgICAgICAgICAgIHRoaXMuX3Jvd0NvdW50ID0gdGhpcy5fZnVsbERhdGEubGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLl9kYXRhID0gdGhpcy5fZnVsbERhdGEuc2xpY2UoMCwgdGhpcy5fcm93c1BlclBhZ2UpO1xyXG4gICAgICAgICAgICB0aGlzLl9jYWxjUGFnZVJhbmdlKDEsIDApO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgcHIgPSBuZXcgUGFnaW5hdG9yKHRoaXMpO1xyXG4gICAgICAgICAgICBjb25zdCBwdG9wID0gdGhpcy5fdG9wLCBwaCA9IHRoaXMuX2NoYXJCb3guaGVpZ2h0ICsgcHIuYnV0dG9uUGFkZGluZygpIC8gMiArIDM7IC8vMzogbWFyZ2luXHJcbiAgICAgICAgICAgIHRoaXMuX3RvcCArPSBwaDtcclxuICAgICAgICAgICAgdGhpcy5faGVpZ2h0IC09IHBoO1xyXG4gICAgICAgICAgICAvLyBib3R0b21cclxuICAgICAgICAgICAgLy8gdGhpcy5faGVpZ2h0IC09IHBoIC0gNTtcclxuICAgICAgICAgICAgLy8gcHRvcCA9IHRoaXMuX2hlaWdodCArIHRoaXMuX3RvcCArIDU7XHJcblxyXG4gICAgICAgICAgICBwci5pbml0KHRoaXMuX3Jvd3NQZXJQYWdlLCB0aGlzLl9yb3dDb3VudClcclxuICAgICAgICAgICAgICAgIC5vcHRpb25zKHtcclxuICAgICAgICAgICAgICAgICAgICBwb3NpdGlvbjogXCJ0b3BcIixcclxuICAgICAgICAgICAgICAgICAgICBzZWxlY3RvcjogXCJyaWdodFwiLFxyXG4gICAgICAgICAgICAgICAgICAgIGJ1dHRvbkNvbG9yOiB0aGlzLl9zdHlsZS5oZWFkZXJCYWNrZ3JvdW5kXHJcbiAgICAgICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAgICAgLnBvc2l0aW9uKFt0aGlzLl9sZWZ0LCBwdG9wXSlcclxuICAgICAgICAgICAgICAgIC5yZWNvcmRzUGVyUGFnZVNlbGVjdGlvbnModGhpcy5fcm93c1BlclBhZ2VTZWxlY3Rpb25zKVxyXG4gICAgICAgICAgICAgICAgLm9uUGFnZU51bWJlckNoYW5nZSgocG51bSwgYmVnaW4sIGVuZCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJQYWdlTnVtID0gcG51bTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jYWxjUGFnZVJhbmdlKHBudW0sIGJlZ2luKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9wYWdlRGF0YSgpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3JlcmVuZGVyKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX29uY2hhbmdlcGFnZSkgdGhpcy5fb25jaGFuZ2VwYWdlKHRoaXMuX2JlZ2luSW5kZXgpO1xyXG4gICAgICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgICAgIC5vblJlY29yZHNQZXJQYWdlQ2hhbmdlKChycHAsIHBudW0sIGJlZ2luLCBlbmQpID0+IHtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yb3dzUGVyUGFnZSA9IHJwcDtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyUGFnZU51bSA9IHBudW07XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY2FsY1BhZ2VSYW5nZShwbnVtLCBiZWdpbik7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fcGFnZURhdGEoKTtcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9yZXJlbmRlcigpO1xyXG4gICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbmNoYW5nZXBhZ2UpIHRoaXMuX29uY2hhbmdlcGFnZSh0aGlzLl9iZWdpbkluZGV4KTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG5cclxuICAgICAgICAgICAgdGhpcy5fcGFnaW5hdG9yID0gcHI7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9jYWxjUGFnZVJhbmdlKHBudW0sIGJlZ2luKSB7XHJcbiAgICAgICAgaWYgKHBudW0gPT09IDEpIHRoaXMuX2JlZ2luSW5kZXggPSB0aGlzLl9maXhlZFJvd3M7XHJcbiAgICAgICAgZWxzZSB0aGlzLl9iZWdpbkluZGV4ID0gYmVnaW4gLSAocG51bSAtIDIpICogdGhpcy5fZml4ZWRSb3dzO1xyXG5cclxuICAgICAgICB0aGlzLl9lbmRJbmRleCA9IHRoaXMuX2JlZ2luSW5kZXggKyB0aGlzLl9yb3dzUGVyUGFnZSAtIHRoaXMuX2ZpeGVkUm93cztcclxuICAgIH1cclxuXHJcbiAgICBfcGFnZURhdGEoKSB7XHJcbiAgICAgICAgdGhpcy5fZGF0YSA9IHRoaXMuX2Z1bGxEYXRhLnNsaWNlKDAsIHRoaXMuX2ZpeGVkUm93cylcclxuICAgICAgICAgICAgLmNvbmNhdCh0aGlzLl9mdWxsRGF0YS5zbGljZSh0aGlzLl9iZWdpbkluZGV4LCB0aGlzLl9lbmRJbmRleCkpO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZXJlbmRlcigpIHtcclxuICAgICAgICB0aGlzLl9nLnNlbGVjdEFsbChcImNsaXBQYXRoXCIpLnJlbW92ZSgpO1xyXG4gICAgICAgIGlmICh0aGlzLl90YWJsZSkgdGhpcy5fdGFibGUucmVtb3ZlKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGJhci5ob3Jpem9udGFsKSB0aGlzLl9zY3JvbGxiYXIuaG9yaXpvbnRhbC5kaXNwb3NlKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGJhci52ZXJ0aWNhbCkgdGhpcy5fc2Nyb2xsYmFyLnZlcnRpY2FsLmRpc3Bvc2UoKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZm9jdXMgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX2hlaWdodCA9IHRoaXMuX2hlaWdodEE7XHJcbiAgICAgICAgdGhpcy5fd2lkdGggPSB0aGlzLl93aWR0aEE7XHJcbiAgICAgICAgdGhpcy5fc2Nyb2xsYmFyLnZpc2libGUgPSBbdHJ1ZSwgdHJ1ZV07XHJcblxyXG4gICAgICAgIGNvbnN0IHBoID0gdGhpcy5fY2hhckJveC5oZWlnaHQgKyB0aGlzLl9wYWdpbmF0b3IuYnV0dG9uUGFkZGluZygpIC8gMjtcclxuICAgICAgICB0aGlzLl9oZWlnaHQgLT0gcGg7XHJcblxyXG4gICAgICAgIHRoaXMuX3Byb2Nlc3NDb2x1bW5zKCk7XHJcbiAgICAgICAgdGhpcy5fcHJlcGFyZSgpO1xyXG5cclxuICAgICAgICB0aGlzLl9jYWxjQ29uc3RyYWlucygpO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZUNsaXBQYXRocygpO1xyXG5cclxuICAgICAgICB0aGlzLl9jcmVhdGVUYWJsZSgpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckJvZHkodGhpcy5fdGFibGUpO1xyXG4gICAgICAgIHRoaXMuX3JlbmRlckhlYWRlcih0aGlzLl90YWJsZSk7XHJcbiAgICAgICAgdGhpcy5fYWRkU2Nyb2xsYmFycygpO1xyXG4gICAgfVxyXG5cclxuICAgIF92YWxpZGF0ZSgpIHtcclxuICAgICAgICByZXR1cm4gdGhpcy5fZGF0YSAmJiB0aGlzLl9kYXRhLmxlbmd0aCA+IDA7XHJcbiAgICB9XHJcblxyXG4gICAgX3ByZXBhcmUoKSB7XHJcbiAgICAgICAgdGhpcy5fZml4ZWRIZWlnaHQgPSB0aGlzLl9jZWxsSGVpZ2h0QSAqIHRoaXMuX2ZpeGVkUm93cyArIHRoaXMuX2NlbGxIZWlnaHRBO1xyXG5cclxuICAgICAgICBjb25zdCB3ID0gdGhpcy5fc3VtV2lkdGgoKTtcclxuICAgICAgICBjb25zdCBoID0gdGhpcy5fZGF0YS5sZW5ndGggKiB0aGlzLl9jZWxsSGVpZ2h0QTtcclxuXHJcbiAgICAgICAgaWYgKHcgKyB0aGlzLl9zbGlkZXJXaWR0aCA8IHRoaXMuX3dpZHRoKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3dpZHRoID0gdztcclxuICAgICAgICAgICAgdGhpcy5fc2Nyb2xsYmFyLnZpc2libGVbMF0gPSBmYWxzZTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3dpZHRoIC09IHRoaXMuX3NsaWRlcldpZHRoO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKGggKyB0aGlzLl9zbGlkZXJXaWR0aCArIHRoaXMuX2NlbGxIZWlnaHRBIDwgdGhpcy5faGVpZ2h0KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2hlaWdodCA9IGggKyB0aGlzLl9jZWxsSGVpZ2h0QTsgLy8gaW5jbHVkZXMgaGVhZGVyXHJcbiAgICAgICAgICAgIHRoaXMuX3Njcm9sbGJhci52aXNpYmxlWzFdID0gZmFsc2U7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB0aGlzLl9oZWlnaHQgLT0gdGhpcy5fc2xpZGVyV2lkdGg7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zdW1XaWR0aChuKSB7XHJcbiAgICAgICAgLy8gbiA9PT0gMCA6IGRvIG5vdCBjYWxjdWxhdGUsIHVzdWFsbHkgaXQgaXMgX2ZpeGVkQ29sdW1ucyA9IDBcclxuICAgICAgICBpZiAobiA9PT0gMClcclxuICAgICAgICAgICAgcmV0dXJuIDA7XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIC8vIG4gPT09IHVuZGVmaW5lZCA6IGFsbCBjb2x1bW5zXHJcbiAgICAgICAgICAgIGNvbnN0IGwgPSBuIHx8IHRoaXMuX2NvbHVtbnMubGVuZ3RoO1xyXG4gICAgICAgICAgICB2YXIgdyA9IDA7XHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSAwOyBpIDwgbDsgaSsrKSB3ICs9IHRoaXMuX2NvbHVtbnNbaV0ud2lkdGg7XHJcbiAgICAgICAgICAgIHJldHVybiB3O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfcHJvY2Vzc0NvbHVtbnMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2RhdGEubGVuZ3RoID4gMCAmJiB0aGlzLl9kYXRhWzBdLmxlbmd0aCA+IDApIHtcclxuICAgICAgICAgICAgdGhpcy5fZGF0YUlzQXJyYXkgPSBBcnJheS5pc0FycmF5KHRoaXMuX2RhdGFbMF0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKCF0aGlzLl9jb2x1bW5zKSB7XHJcbiAgICAgICAgICAgIC8vIENTViBvciBKU09OXHJcbiAgICAgICAgICAgIGNvbnN0IGtleXMgPSB0aGlzLl9kYXRhLmNvbHVtbnMgPyB0aGlzLl9kYXRhLmNvbHVtbnMgOiBPYmplY3Qua2V5cyh0aGlzLl9kYXRhWzBdKTtcclxuICAgICAgICAgICAgbGV0IHggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLl9jb2x1bW5zID0ga2V5cy5tYXAoKGMsIGkpID0+IHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGlzTnVtYmVyID0gdHlwZW9mIHRoaXMuX2RhdGFbMF1bY10gPT09IFwibnVtYmVyXCI7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2x1bW4gPSB7XHJcbiAgICAgICAgICAgICAgICAgICAgbmFtZTogYyxcclxuICAgICAgICAgICAgICAgICAgICBpc051bWJlcjogaXNOdW1iZXIsXHJcbiAgICAgICAgICAgICAgICAgICAgZm9ybWF0OiBpc051bWJlciA/IHRoaXMuX2RlZmF1bHROdW1iZXJGb3JtYXQgOiBudWxsLFxyXG4gICAgICAgICAgICAgICAgICAgIG9yZGVyOiAwLCAvLyAwOiBub25lLCAxOiBhc2NlbmRpbmcsIDI6IGRlc2NlbmRpbmdcclxuICAgICAgICAgICAgICAgICAgICB4OiB4LFxyXG4gICAgICAgICAgICAgICAgICAgIHR4OiB4LCAvLyB4IGZvciB0cmFuc2xhdGVcclxuICAgICAgICAgICAgICAgICAgICBpbmRleDogaSxcclxuICAgICAgICAgICAgICAgICAgICB3aWR0aDogdGhpcy5fZGVmYXVsdENvbHVtbldpZHRoXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB4ICs9IGNvbHVtbi53aWR0aDtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW47XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgbGV0IHggPSAwO1xyXG4gICAgICAgICAgICB0aGlzLl9jb2x1bW5zLmZvckVhY2goKGNvbHVtbiwgaSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgY29sdW1uLndpZHRoID0gY29sdW1uLndpZHRoIHx8IHRoaXMuX2RlZmF1bHRDb2x1bW5XaWR0aDtcclxuICAgICAgICAgICAgICAgIGNvbHVtbi54ID0geDtcclxuICAgICAgICAgICAgICAgIGNvbHVtbi50eCA9IHg7IC8vIHggZm9yIHRyYW5zbGF0ZVxyXG4gICAgICAgICAgICAgICAgY29sdW1uLmluZGV4ID0gaTtcclxuICAgICAgICAgICAgICAgIHggKz0gY29sdW1uLndpZHRoO1xyXG4gICAgICAgICAgICB9KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9hdXRvU2l6ZUNlbGwpIHRoaXMuX2NhbGNTaXplKCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2ZpeGVkV2lkdGggPSB0aGlzLl9zdW1XaWR0aCh0aGlzLl9maXhlZENvbHVtbnMpO1xyXG4gICAgICAgIGZvciAobGV0IGkgPSB0aGlzLl9maXhlZENvbHVtbnM7IGkgPCB0aGlzLl9jb2x1bW5zLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGMgPSB0aGlzLl9jb2x1bW5zW2ldO1xyXG4gICAgICAgICAgICBjLnR4ID0gYy54IC0gdGhpcy5fZml4ZWRXaWR0aDsgLy8geCBmb3IgdHJhbnNsYXRlXHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9jb2x1bW5zLnJlc2V0T3JkZXIgPSAoZXhjZXB0KSA9PiB0aGlzLl9jb2x1bW5zLmZvckVhY2goYyA9PiB7IGlmIChleGNlcHQgJiYgYyAhPT0gZXhjZXB0IHx8ICFleGNlcHQpIGMub3JkZXIgPSAwOyB9KTtcclxuICAgIH1cclxuXHJcbiAgICBfY2FsY1NpemUoKSB7XHJcbiAgICAgICAgLy8gdGVzdCBpZiBpdCBpcyB1c2VkIGluIGEgZ2VuZXJhdG9yXHJcbiAgICAgICAgaWYgKHRoaXMuX2NoYXJCb3gud2lkdGggPiAwICYmIHRoaXMuX2NoYXJCb3guaGVpZ2h0ID4gMCkge1xyXG5cclxuICAgICAgICAgICAgLy8gb3ZlcnJpZGVzIGNlbGxIZWlnaHRcclxuICAgICAgICAgICAgdGhpcy5fY2VsbEhlaWdodCA9IHRoaXMuX2NoYXJCb3guaGVpZ2h0O1xyXG4gICAgICAgICAgICB0aGlzLl9jZWxsSGVpZ2h0QSA9IHRoaXMuX2NoYXJCb3guaGVpZ2h0ICsgdGhpcy5fY2VsbFBhZGRpbmdWICogMjtcclxuXHJcbiAgICAgICAgICAgIC8vIHByZXBhcmUga2V5c1xyXG4gICAgICAgICAgICBjb25zdCBrZXlzID0gW107XHJcbiAgICAgICAgICAgIGNvbnN0IGxvbmdlc3QgPSB0aGlzLl9jb2x1bW5zLm1hcCgoY29sdW1uLCBpKSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhpcy5fZGF0YUlzQXJyYXkpIGtleXMucHVzaChpKTtcclxuICAgICAgICAgICAgICAgIGVsc2Uga2V5cy5wdXNoKGNvbHVtbi5uYW1lKTtcclxuICAgICAgICAgICAgICAgIHJldHVybiBjb2x1bW4ubmFtZTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgICAgICAvLyBmaW5kIHRoZSBsb25nZXN0IHN0cmluZyBmb3IgZWFjaCBjb2x1bW5cclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCB0aGlzLl9kYXRhLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCByb3cgPSB0aGlzLl9kYXRhW2ldO1xyXG4gICAgICAgICAgICAgICAgZm9yIChsZXQgaiA9IDA7IGogPCBrZXlzLmxlbmd0aDsgaisrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3Qga2V5ID0ga2V5c1tqXSwgY29sdW1uID0gdGhpcy5fY29sdW1uc1tqXTtcclxuICAgICAgICAgICAgICAgICAgICBjb25zdCB2YWwgPSByb3dba2V5XTtcclxuICAgICAgICAgICAgICAgICAgICBpZiAodmFsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICBjb25zdCBjdXJyID0gY29sdW1uLmlzTnVtYmVyICYmIGNvbHVtbi5mb3JtYXQgPyBkMy5mb3JtYXQoY29sdW1uLmZvcm1hdCkocm93W2tleV0pIDogcm93W2tleV07XHJcbiAgICAgICAgICAgICAgICAgICAgICBpZiAoY3Vyci5sZW5ndGggPiBsb25nZXN0W2pdLmxlbmd0aCkgbG9uZ2VzdFtqXSA9IGN1cnI7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAvLyByZS1jYWxjdWxhdGUgY29sdW1uIHdpZHRoIGZvciBlYWNoIGNvbHVtbiBiYXNlZCBvbiBsb25nZXN0W11cclxuICAgICAgICAgICAgdmFyIHggPSAwO1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMDsgaSA8IGxvbmdlc3QubGVuZ3RoOyBpKyspIHtcclxuICAgICAgICAgICAgICAgIGNvbnN0IGNvbHVtbiA9IHRoaXMuX2NvbHVtbnNbaV07XHJcbiAgICAgICAgICAgICAgICBjb2x1bW4ueCA9IGNvbHVtbi50eCA9IHg7XHJcbiAgICAgICAgICAgICAgICBjb2x1bW4ud2lkdGggPSB0aGlzLl9nZXRCQm94KGxvbmdlc3RbaV0pLndpZHRoICsgdGhpcy5fY2VsbFBhZGRpbmdIICogMiArIDIwO1xyXG4gICAgICAgICAgICAgICAgeCArPSBjb2x1bW4ud2lkdGg7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICB9XHJcbiAgICB9XHJcblxyXG4gICAgX2dldEJCb3goc3RyKSB7XHJcbiAgICAgICAgdmFyIHQ7XHJcbiAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgdCA9IHRoaXMuX3N2Zy5hcHBlbmQoXCJ0ZXh0XCIpLnRleHQoc3RyKTtcclxuICAgICAgICAgICAgcmV0dXJuIHQubm9kZSgpLmdldEJCb3goKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZmluYWxseSB7XHJcbiAgICAgICAgICAgIHQucmVtb3ZlKCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9wcm9jZXNzSGVhdG1hcCgpIHtcclxuICAgICAgICBpZiAoIXRoaXMuX2hlYXRtYXBQYWxldHRlKSByZXR1cm47XHJcblxyXG4gICAgICAgIGNvbnN0IGRhdGEgPSB0aGlzLl9mdWxsRGF0YSB8fCB0aGlzLl9kYXRhO1xyXG4gICAgICAgIGNvbnN0IGFsbCA9IGRhdGEuc2xpY2UodGhpcy5fZml4ZWRSb3dzKS5mbGF0TWFwKGQgPT4ge1xyXG4gICAgICAgICAgICBjb25zdCByID0gdGhpcy5fZGF0YUlzQXJyYXkgP1xyXG4gICAgICAgICAgICAgICAgZC5zbGljZSh0aGlzLl9maXhlZENvbHVtbnMpIDpcclxuICAgICAgICAgICAgICAgIE9iamVjdC5rZXlzKGQpLm1hcChrID0+IGRba10pLnNsaWNlKHRoaXMuX2ZpeGVkQ29sdW1ucyk7XHJcblxyXG4gICAgICAgICAgICBjb25zdCB2YWx1ZXMgPSBbXTtcclxuICAgICAgICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCByLmxlbmd0aDsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjb2wgPSB0aGlzLl9jb2x1bW5zW2kgKyB0aGlzLl9maXhlZENvbHVtbnNdO1xyXG4gICAgICAgICAgICAgICAgaWYgKGNvbC5pc051bWJlcikgdmFsdWVzLnB1c2godGhpcy5fZGF0YUlzQXJyYXkgPyByW2ldIDogcltjb2wubmFtZV0pO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIHJldHVybiByO1xyXG4gICAgICAgIH0pXHJcblxyXG4gICAgICAgIGNvbnN0IGV4dCA9IGQzLmV4dGVudChhbGwpO1xyXG4gICAgICAgIGNvbnN0IHAgPSB0aGlzLl9oZWF0bWFwUGFsZXR0ZTtcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShwKSkge1xyXG4gICAgICAgICAgICAvLyBQYWxldHRlIGlzIGFuIGFycmF5XHJcbiAgICAgICAgICAgIHRoaXMuX2hlYXRtYXBDb2xvciA9IGQzLnNjYWxlU2VxdWVudGlhbCgpXHJcbiAgICAgICAgICAgICAgICAuZG9tYWluKHRoaXMuX3NlcmllcyhleHRbMF0sIGV4dFsxXSwgcC5sZW5ndGgpKVxyXG4gICAgICAgICAgICAgICAgLnJhbmdlKHApO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmICh0eXBlb2YgcCA9PT0gXCJmdW5jdGlvblwiKSB7XHJcbiAgICAgICAgICAgIC8vIFBhbGV0dGUgaXMgYSBjb2xvciBpbnRlcnBvbGF0b3JcclxuICAgICAgICAgICAgdGhpcy5faGVhdG1hcENvbG9yID0gZDMuc2NhbGVTZXF1ZW50aWFsKHApXHJcbiAgICAgICAgICAgICAgICAuZG9tYWluKGV4dCk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9zZXJpZXMobWluLCBtYXgsIG51bSkge1xyXG4gICAgICAgIGNvbnN0IG4gPSBudW0gLSAxLCBzID0gW21pbl0sIGludHJ2ID0gbWF4IC8gbjtcclxuICAgICAgICB2YXIgaSA9IG1pbjtcclxuICAgICAgICB3aGlsZSAoaSA8IG1heCAmJiBzLmxlbmd0aCA8IG51bSkge1xyXG4gICAgICAgICAgICBpICs9IGludHJ2O1xyXG4gICAgICAgICAgICBzLnB1c2goaSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAocy5sZW5ndGggPCBudW0pXHJcbiAgICAgICAgICAgIHMucHVzaChtYXgpO1xyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgc1tzLmxlbmd0aCAtIDFdID0gbWF4O1xyXG5cclxuICAgICAgICByZXR1cm4gcztcclxuICAgIH1cclxuXHJcbiAgICBfY3JlYXRlQ2xpcFBhdGhzKCkge1xyXG4gICAgICAgIGNvbnN0IGFkZENsaXBQYXRoID0gKGlkLCB3aWR0aCwgaGVpZ2h0LCB4LCB5KSA9PiB7XHJcbiAgICAgICAgICAgIGNvbnN0IGNwID0gdGhpcy5fZy5hcHBlbmQoXCJjbGlwUGF0aFwiKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJpZFwiLCBgJHtpZH0uJHt0aGlzLl91bmlxdWVJZH1gKVxyXG4gICAgICAgICAgICAgICAgLmFwcGVuZChcInJlY3RcIilcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgd2lkdGgpXHJcbiAgICAgICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCBoZWlnaHQpO1xyXG5cclxuICAgICAgICAgICAgaWYgKHgpIGNwLmF0dHIoXCJ4XCIsIHgpO1xyXG4gICAgICAgICAgICBpZiAoeSkgY3AuYXR0cihcInlcIiwgeSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBhZGRDbGlwUGF0aChcImJvZHlDbGlwXCIsIHRoaXMuX3dpZHRoLCB0aGlzLl9oZWlnaHQpO1xyXG4gICAgICAgIGFkZENsaXBQYXRoKFwiaGVhZGVyUm93Q2xpcFwiLCB0aGlzLl93aWR0aCAtIHRoaXMuX2ZpeGVkV2lkdGgsIHRoaXMuX2ZpeGVkSGVpZ2h0ICsgMSwgbnVsbCwgLTEpO1xyXG4gICAgICAgIHRoaXMuX2NvbHVtbnMuZm9yRWFjaCgoY29sdW1uLCBpKSA9PiB7XHJcbiAgICAgICAgICAgIGFkZENsaXBQYXRoKFwiaGVhZGVyQ2xpcFwiICsgaSwgY29sdW1uLndpZHRoIC0gdGhpcy5fY2VsbFBhZGRpbmdILCB0aGlzLl9jZWxsSGVpZ2h0QSk7XHJcbiAgICAgICAgICAgIGlmIChjb2x1bW4uaXNOdW1iZXIpXHJcbiAgICAgICAgICAgICAgICBhZGRDbGlwUGF0aChcImNlbGxDbGlwXCIgKyBpLCBjb2x1bW4ud2lkdGggLSB0aGlzLl9jZWxsUGFkZGluZ0gsIHRoaXMuX2NlbGxIZWlnaHRBLCAtKGNvbHVtbi53aWR0aCAtIHRoaXMuX2NlbGxQYWRkaW5nSCkpO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICBhZGRDbGlwUGF0aChcImNlbGxDbGlwXCIgKyBpLCBjb2x1bW4ud2lkdGggLSB0aGlzLl9jZWxsUGFkZGluZ0gsIHRoaXMuX2NlbGxIZWlnaHRBKTtcclxuICAgICAgICB9KVxyXG4gICAgfVxyXG5cclxuICAgIF9jbGlwUGF0aChpZCkge1xyXG4gICAgICAgIHJldHVybiBgdXJsKCMke2lkfS4ke3RoaXMuX3VuaXF1ZUlkfSlgO1xyXG4gICAgfVxyXG5cclxuICAgIF9jcmVhdGVUYWJsZSgpIHtcclxuICAgICAgICAvLyB0YWJsZSBjb250YWluZXJcclxuICAgICAgICB0aGlzLl90YWJsZSA9IHRoaXMuX2cuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7dGhpcy5fbGVmdH0sJHt0aGlzLl90b3B9KWApXHJcbiAgICAgICAgICAgIC5vbihcIndoZWVsXCIsIGUgPT4gdGhpcy5fc2Nyb2xsKGUpKVxyXG4gICAgICAgICAgICAub24oXCJtb3VzZXdoZWVsXCIsIGUgPT4gdGhpcy5fc2Nyb2xsKGUpKVxyXG4gICAgICAgICAgICAub24oXCJET01Nb3VzZVNjcm9sbFwiLCBlID0+IHRoaXMuX3Njcm9sbChlKSk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbmRlckJvZHkoKSB7XHJcbiAgICAgICAgY29uc3QgdGhhdCA9IHRoaXMsIHN0eWxlID0gdGhpcy5fc3R5bGUsXHJcbiAgICAgICAgICAgIGhpZ2hsaWdodCA9IHN0eWxlLmhpZ2hsaWdodCAhPT0gXCJub25lXCIsXHJcbiAgICAgICAgICAgIGNyb3NzID0gc3R5bGUuaGlnaGxpZ2h0ID09PSBcImNyb3NzXCI7XHJcblxyXG4gICAgICAgIC8vIHRhYmxlIGJvZHkgY29udGFpbmVyXHJcbiAgICAgICAgY29uc3QgYm9keUJveCA9IHRoaXMuX3RhYmxlLmFwcGVuZChcImdcIikuYXR0cihcImNsaXAtcGF0aFwiLCB0aGlzLl9jbGlwUGF0aChcImJvZHlDbGlwXCIpKTtcclxuICAgICAgICAvLyBpbm5lciBjb250YWluZXIgb2YgdGhlIHRhYmxlIGJvZHksIHkgaXMgY29udHJvbGxlZCBieSB2ZXJ0aWNhbCBzY3JvbGxiYXIgYW5kIGl0cyBjb250ZW50IGlzIGNsaXBwZWQgYnkgYm9keUNsaXAgIFxyXG4gICAgICAgIC8vIGl0IGNvbnRhaW5zIHR3byBwYXJ0czogZGF0YUFyZWEgd2hpY2ggaXMgaG9yaXpvbnRhbGx5IG1vdmVhYmxlIGFuZCBmaXhlZCBjb2x1bW5zIG9uIHRoZSBsZWZ0XHJcbiAgICAgICAgY29uc3QgYm9keSA9IGJvZHlCb3guYXBwZW5kKFwiZ1wiKS5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoMCwke3RoaXMuX2ZpeGVkSGVpZ2h0fSlgKTtcclxuICAgICAgICAvLyBjb250YWluZXIgb2YgdGhlIG1vdmVhYmxlIHBhcnQgb2YgdGhlIGJvZHlcclxuICAgICAgICBjb25zdCBkYXRhQXJlYSA9IGJvZHkuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7dGhpcy5fZml4ZWRXaWR0aH0sMClgKTtcclxuXHJcbiAgICAgICAgY29uc3Qgcm93cyA9IHRoaXMuX2RhdGEuc2xpY2UodGhpcy5fZml4ZWRSb3dzKTtcclxuICAgICAgICAvL2lmICh0aGlzLl9kYXRhSXNBcnJheSkgcm93cy5mb3JFYWNoKHIgPT4gclswXS5vcmlnaW4gPSByKTtcclxuICAgICAgICAvLyBtb3ZlYWJsZSBwYXJ0IG9mIHRoZSBib2R5LCB4IGlzIGNvbnRyb2xsZWQgYnkgaG9yaXpvbnRhbCBzY3JvbGxiYXJcclxuICAgICAgICBjb25zdCBjZWxsID0gdGhpcy5fYWRkUm93cyhcclxuICAgICAgICAgICAgZGF0YUFyZWEsXHJcbiAgICAgICAgICAgIFwicm93XCIsXHJcbiAgICAgICAgICAgICgpID0+IHJvd3MsXHJcbiAgICAgICAgICAgIChkLCBpKSA9PiB0aGlzLl9jb2x1bW5zLnNsaWNlKHRoaXMuX2ZpeGVkQ29sdW1ucykubWFwKChjLCBqKSA9PiB7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4ge1xyXG4gICAgICAgICAgICAgICAgICAgIHJvd0luZGV4OiBpICsgdGhpcy5fZml4ZWRSb3dzLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogYyxcclxuICAgICAgICAgICAgICAgICAgICB2YWx1ZTogdGhpcy5fZGF0YUlzQXJyYXkgPyBkW2MuaW5kZXhdIDogZFtjLm5hbWVdXHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pLFxyXG4gICAgICAgICAgICAoZCwgaSkgPT4gYHRyYW5zbGF0ZSgwLCR7aSAqIHRoaXMuX2NlbGxIZWlnaHRBfSlgLFxyXG4gICAgICAgICAgICBkID0+IGB0cmFuc2xhdGUoJHtkLmNvbHVtbi50eH0sMClgLFxyXG4gICAgICAgICAgICBnID0+IHRoaXMuX2FkZENlbGwoZywgc3R5bGUuYmFja2dyb3VuZCwgdGhpcy5fZml4ZWRDb2x1bW5zKSlcclxuICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgY2xpY2spXHJcbiAgICAgICAgICAgIC5vbihcImNvbnRleHRtZW51XCIsIGNvbnRleHRtZW51KVxyXG4gICAgICAgICAgICAub24oXCJtb3VzZW92ZXJcIiwgbW91c2VvdmVyKVxyXG4gICAgICAgICAgICAub24oXCJtb3VzZWxlYXZlXCIsIG1vdXNlbGVhdmUpO1xyXG5cclxuICAgICAgICB2YXIgZml4ZWRDZWxsO1xyXG4gICAgICAgIGlmICh0aGlzLl9maXhlZENvbHVtbnMpIHtcclxuICAgICAgICAgICAgLy8gZml4ZWQgY29sdW1ucyBvbiB0aGUgbGVmdFxyXG4gICAgICAgICAgICBmaXhlZENlbGwgPSB0aGlzLl9hZGRSb3dzKFxyXG4gICAgICAgICAgICAgICAgYm9keS5hcHBlbmQoXCJnXCIpLFxyXG4gICAgICAgICAgICAgICAgXCJyb3dcIixcclxuICAgICAgICAgICAgICAgICgpID0+IHJvd3MubWFwKChyLCBpKSA9PiB0aGlzLl9jb2x1bW5zLnNsaWNlKDAsIHRoaXMuX2ZpeGVkQ29sdW1ucykubWFwKChjLCBqKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgICAgIG9yaWdpbjogciwgLy8gZm9yIHNvcnQgdG8gZ2V0IHRoZSBpbmRleCBvZiBkYXRhXHJcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IGkgKyB0aGlzLl9maXhlZFJvd3MsXHJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBjLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9kYXRhSXNBcnJheSA/IHJbYy5pbmRleF0gOiByW2MubmFtZV1cclxuICAgICAgICAgICAgICAgIH0pKSksXHJcbiAgICAgICAgICAgICAgICBkID0+IGQsXHJcbiAgICAgICAgICAgICAgICAoZCwgaSkgPT4gYHRyYW5zbGF0ZSgwLCR7aSAqIHRoaXMuX2NlbGxIZWlnaHRBfSlgLFxyXG4gICAgICAgICAgICAgICAgZCA9PiBgdHJhbnNsYXRlKCR7ZC5jb2x1bW4udHh9LDApYCxcclxuICAgICAgICAgICAgICAgIGcgPT4gdGhpcy5fYWRkQ2VsbChnLCBzdHlsZS5maXhlZEJhY2tncm91bmQsIDAsIGZhbHNlLCB0cnVlKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9ib2R5ID0gYm9keTtcclxuICAgICAgICB0aGlzLl9kYXRhQXJlYSA9IGRhdGFBcmVhO1xyXG5cclxuICAgICAgICBjb25zdCB0ZXN0ID0gY3Jvc3MgP1xyXG4gICAgICAgICAgICAoZCwgY2VsbCkgPT4gY2VsbC5yb3dJbmRleCA9PT0gZC5yb3dJbmRleCB8fCBjZWxsLmNvbHVtbi5pbmRleCA9PT0gZC5jb2x1bW4uaW5kZXggOlxyXG4gICAgICAgICAgICAoZCwgY2VsbCkgPT4gY2VsbC5yb3dJbmRleCA9PT0gZC5yb3dJbmRleCAmJiBjZWxsLmNvbHVtbi5pbmRleCA9PT0gZC5jb2x1bW4uaW5kZXg7XHJcblxyXG4gICAgICAgIGQzLnNlbGVjdChcImJvZHlcIikub24oYGtleWRvd24uZXJpYy5zdmd0YWJsZS4ke3RoaXMuX3VuaXF1ZUlkfWAsIGtleXByZXNzKTtcclxuXHJcbiAgICAgICAgZnVuY3Rpb24ga2V5cHJlc3MoZSkge1xyXG4gICAgICAgICAgICBpZiAoZS5rZXkgPT09IFwiRXNjYXBlXCIpIHRoYXQuX2ZvY3VzID0gbnVsbDtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIGZ1bmN0aW9uIGNsaWNrKGUsIGQpIHtcclxuICAgICAgICAgICAgaWYgKHRoYXQuX2ZvY3VzICE9PSBkKSB7XHJcbiAgICAgICAgICAgICAgICB0aGF0Ll9mb2N1cyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICBtb3VzZW92ZXIoZSwgZCk7XHJcbiAgICAgICAgICAgICAgICB0aGF0Ll9mb2N1cyA9IGQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgdGhhdC5fZm9jdXMgPSBudWxsO1xyXG5cclxuICAgICAgICAgICAgaWYgKHRoYXQuX29uY2xpY2spIHRoYXQuX29uY2xpY2soZSwgZCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBjb250ZXh0bWVudShlLCBkKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGF0Ll9vbmNvbnRleHRtZW51KSB7XHJcbiAgICAgICAgICAgICAgICBpZiAodGhhdC5fZm9jdXMgIT09IGQpIHtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9mb2N1cyA9IG51bGw7XHJcbiAgICAgICAgICAgICAgICAgICAgbW91c2VvdmVyKGUsIGQpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoYXQuX2ZvY3VzID0gZDtcclxuICAgICAgICAgICAgICAgICAgICB0aGF0Ll9vbmNvbnRleHRtZW51KGUsIGQpO1xyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIGZhbHNlO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBmdW5jdGlvbiBtb3VzZW92ZXIoZSwgZCkge1xyXG4gICAgICAgICAgICBpZiAoIWhpZ2hsaWdodCB8fCB0aGF0Ll9mb2N1cykgcmV0dXJuO1xyXG5cclxuICAgICAgICAgICAgY29uc3QgciA9IGNlbGwuc2VsZWN0KFwicmVjdFwiKVxyXG4gICAgICAgICAgICAgICAgLmRhdHVtKGNlbGwgPT4gdGVzdChkLCBjZWxsKSA/IHN0eWxlLmhpZ2hsaWdodEJhY2tncm91bmQgOiB0aGF0Ll9jZWxsQ29sb3IoY2VsbCwgc3R5bGUuYmFja2dyb3VuZCwgZmFsc2UsIGZhbHNlKSlcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBkID0+IGQpO1xyXG4gICAgICAgICAgICBpZiAoIXRoYXQuX3N0eWxlLmJvcmRlcikgci5hdHRyKFwic3Ryb2tlXCIsIGQgPT4gZCk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZml4ZWRDZWxsKSBmaXhlZENlbGwuc2VsZWN0KFwidGV4dFwiKS5hdHRyKFwiZm9udC13ZWlnaHRcIiwgY2VsbCA9PiBjZWxsLnJvd0luZGV4ID09PSBkLnJvd0luZGV4ID8gXCJib2xkXCIgOiBcIlwiKTtcclxuICAgICAgICAgICAgdGhhdC5fZGF0YUhlYWRlci5zZWxlY3RBbGwoXCJ0ZXh0XCIpLmF0dHIoXCJmb250LXdlaWdodFwiLCBjZWxsID0+IGNlbGwuY29sdW1uLmluZGV4ID09PSBkLmNvbHVtbi5pbmRleCA/IFwiYm9sZFwiIDogXCJcIik7XHJcblxyXG4gICAgICAgICAgICBpZiAodGhhdC5fb25oaWdobGlnaHQpIHtcclxuICAgICAgICAgICAgICAgIHRoYXQuX29uaGlnaGxpZ2h0KGUsIHtcclxuICAgICAgICAgICAgICAgICAgICBjZWxsOiBkLFxyXG4gICAgICAgICAgICAgICAgICAgIGNvbHVtbjogZC5jb2x1bW4sXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Um93OiAoKSA9PiB0aGF0LmdldFJvd0RhdGEoZC5yb3dJbmRleCksXHJcbiAgICAgICAgICAgICAgICAgICAgZ2V0Q29sdW1uOiAoKSA9PiB0aGF0LmdldENvbHVtbkRhdGEoZC5jb2x1bW4uaW5kZXgpXHJcbiAgICAgICAgICAgICAgICB9KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgZnVuY3Rpb24gbW91c2VsZWF2ZSgpIHtcclxuICAgICAgICAgICAgaWYgKCFoaWdobGlnaHQgfHwgdGhhdC5fZm9jdXMpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IHIgPSBjZWxsLnNlbGVjdChcInJlY3RcIikuYXR0cihcImZpbGxcIiwgZCA9PiB0aGF0Ll9jZWxsQ29sb3IoZCwgc3R5bGUuYmFja2dyb3VuZCwgZmFsc2UsIGZhbHNlKSk7XHJcbiAgICAgICAgICAgIGlmICghdGhhdC5fc3R5bGUuYm9yZGVyKSByLmF0dHIoXCJzdHJva2VcIiwgZCA9PiB0aGF0Ll9jZWxsQ29sb3IoZCwgc3R5bGUuYmFja2dyb3VuZCwgZmFsc2UsIGZhbHNlKSk7XHJcblxyXG4gICAgICAgICAgICBpZiAoZml4ZWRDZWxsKSBmaXhlZENlbGwuc2VsZWN0KFwidGV4dFwiKS5hdHRyKFwiZm9udC13ZWlnaHRcIiwgXCJcIik7XHJcbiAgICAgICAgICAgIHRoYXQuX2RhdGFIZWFkZXIuc2VsZWN0QWxsKFwidGV4dFwiKS5hdHRyKFwiZm9udC13ZWlnaHRcIiwgXCJcIik7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF91cGRhdGVIZWF0bWFwKCkge1xyXG4gICAgICAgIGNvbnN0IGJnID0gdGhpcy5fc3R5bGUuYmFja2dyb3VuZDtcclxuICAgICAgICBjb25zdCByZWN0cyA9IHRoaXMuX2RhdGFBcmVhLnNlbGVjdEFsbChcInJlY3RcIik7XHJcbiAgICAgICAgaWYgKHRoaXMuX2hlYXRtYXApIHtcclxuICAgICAgICAgICAgcmVjdHMuYXR0cihcImZpbGxcIiwgZCA9PiB0aGlzLl9jZWxsQ29sb3IoZCwgYmcsIGZhbHNlLCBmYWxzZSkpO1xyXG4gICAgICAgICAgICBpZiAoIXRoaXMuX3N0eWxlLmJvcmRlcikgcmVjdHMuYXR0cihcInN0cm9rZVwiLCBkID0+IHRoaXMuX2NlbGxDb2xvcihkLCBiZywgZmFsc2UsIGZhbHNlKSk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICByZWN0cy5hdHRyKFwiZmlsbFwiLCBkID0+IGJnKTtcclxuICAgICAgICAgICAgaWYgKCF0aGlzLl9zdHlsZS5ib3JkZXIpIHJlY3RzLmF0dHIoXCJzdHJva2VcIiwgYmcpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfcmVuZGVySGVhZGVyKGcpIHtcclxuICAgICAgICBjb25zdCBzdHlsZSA9IHRoaXMuX3N0eWxlO1xyXG5cclxuICAgICAgICAvLyBmaXhlZCByb3dzIHNsaWNlZCBmcm9tIHRoaXMuX2RhdGFcclxuICAgICAgICBjb25zdCByb3dzID0gdGhpcy5fZGF0YS5zbGljZSgwLCB0aGlzLl9maXhlZFJvd3MpO1xyXG4gICAgICAgIC8vIGhlYWRlciBjb250YWluZXJcclxuICAgICAgICBjb25zdCBoZWFkZXIgPSBnLmFwcGVuZChcImdcIik7XHJcbiAgICAgICAgLy8gdG9wLWxlZnQgY2VsbHMgd2hpY2ggYXJlIGFsd2F5cyBmaXhlZCBpZiBmaXhlZENvbHVtbnMgaXMgc3BlY2lmaWVkXHJcbiAgICAgICAgaGVhZGVyLnNlbGVjdEFsbChcIi5jb2x1bW5cIilcclxuICAgICAgICAgICAgLy8gVW5pZnkgdGhlIHRoZSBkYXRhIHN0cnVjdHVyZSBtYWtlIGl0IGNvbXBhdGlibGUgd2l0aCBhZGRDZWxsXHJcbiAgICAgICAgICAgIC5kYXRhKHRoaXMuX2NvbHVtbnMuc2xpY2UoMCwgdGhpcy5fZml4ZWRDb2x1bW5zKS5tYXAoKGQsIGkpID0+ICh7XHJcbiAgICAgICAgICAgICAgICBjb2x1bW46IGRcclxuICAgICAgICAgICAgfSkpKVxyXG4gICAgICAgICAgICAuam9pbihcImdcIilcclxuICAgICAgICAgICAgLmF0dHIoXCJjbGFzc1wiLCBcImNvbHVtblwiKVxyXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGB0cmFuc2xhdGUoJHtkLmNvbHVtbi50eH0sMClgKVxyXG4gICAgICAgICAgICAuY2FsbChnID0+IHRoaXMuX2FkZENlbGwoZywgc3R5bGUuaGVhZGVyQmFja2dyb3VuZCwgMCwgdHJ1ZSwgdHJ1ZSkpXHJcbiAgICAgICAgICAgIC5vbihcImNsaWNrXCIsIChlLCBkKSA9PiB0aGlzLl9zb3J0KGQpKTtcclxuXHJcbiAgICAgICAgLy8gZml4ZWQgZGF0YSBjZWxscyBpbiB0aGUgZml4ZWQgY29sdW1ucyBzZWN0aW9uXHJcbiAgICAgICAgaWYgKHRoaXMuX2ZpeGVkQ29sdW1ucykge1xyXG4gICAgICAgICAgICB0aGlzLl9hZGRSb3dzKFxyXG4gICAgICAgICAgICAgICAgaGVhZGVyLFxyXG4gICAgICAgICAgICAgICAgXCJmaXhlZFJvd1wiLFxyXG4gICAgICAgICAgICAgICAgKCkgPT4gcm93cy5tYXAoKHIsIGkpID0+IHRoaXMuX2NvbHVtbnMuc2xpY2UoMCwgdGhpcy5fZml4ZWRDb2x1bW5zKS5tYXAoKGMsIGopID0+ICh7XHJcbiAgICAgICAgICAgICAgICAgICAgcm93SW5kZXg6IGksXHJcbiAgICAgICAgICAgICAgICAgICAgY29sdW1uOiBjLFxyXG4gICAgICAgICAgICAgICAgICAgIHZhbHVlOiB0aGlzLl9kYXRhSXNBcnJheSA/IHJbYy5pbmRleF0gOiByW2MubmFtZV1cclxuICAgICAgICAgICAgICAgIH0pKSksXHJcbiAgICAgICAgICAgICAgICBkID0+IGQsXHJcbiAgICAgICAgICAgICAgICAoZCwgaSkgPT4gYHRyYW5zbGF0ZSgwLCR7KGkgKyAxKSAqIHRoaXMuX2NlbGxIZWlnaHRBfSlgLFxyXG4gICAgICAgICAgICAgICAgZCA9PiBgdHJhbnNsYXRlKCR7ZC5jb2x1bW4udHh9LDApYCxcclxuICAgICAgICAgICAgICAgIGcgPT4gdGhpcy5fYWRkQ2VsbChnLCBzdHlsZS5maXhlZEJhY2tncm91bmQsIDAsIGZhbHNlLCB0cnVlKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICAvLyB0aGUgY29udGFpbmVyIG9mIHRoZSByZXN0IG9mIHRoZSBoZWFkZXIgY2VsbHMsIGl0cyBjb250ZW50IGlzIGNsaXBwZWQgYnkgaGVhZGVyQ2xpcFxyXG4gICAgICAgIGNvbnN0IGhlYWRlckJveCA9IGhlYWRlci5hcHBlbmQoXCJnXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiY2xpcC1wYXRoXCIsIHRoaXMuX2NsaXBQYXRoKFwiaGVhZGVyUm93Q2xpcFwiKSlcclxuICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3RoaXMuX2ZpeGVkV2lkdGh9LDApYCk7XHJcblxyXG4gICAgICAgIC8vIGhvcml6b250YWxseSBtb3ZlYWJsZSBwYXJ0IG9mIHRoZSBoZWFkZXIsIHggaXMgY29udHJvbGxlZCBieSBhbmQgc3luY2hyb25pemVkIHdpdGggaG9yaXpvbnRhbCBzY3JvbGxiYXJcclxuICAgICAgICBjb25zdCBkYXRhSGVhZGVyID0gaGVhZGVyQm94LmFwcGVuZChcImdcIik7XHJcbiAgICAgICAgZGF0YUhlYWRlci5zZWxlY3RBbGwoXCIuY29sdW1uXCIpXHJcbiAgICAgICAgICAgIC8vIFVuaWZ5IHRoZSB0aGUgZGF0YSBzdHJ1Y3R1cmUgbWFrZSBpdCBjb21wYXRpYmxlIHdpdGggYWRkQ2VsbFxyXG4gICAgICAgICAgICAuZGF0YSh0aGlzLl9jb2x1bW5zLnNsaWNlKHRoaXMuX2ZpeGVkQ29sdW1ucykubWFwKChkLCBpKSA9PiAoe1xyXG4gICAgICAgICAgICAgICAgY29sdW1uOiBkXHJcbiAgICAgICAgICAgIH0pKSlcclxuICAgICAgICAgICAgLmpvaW4oXCJnXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgXCJjb2x1bW5cIilcclxuICAgICAgICAgICAgLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgZCA9PiBgdHJhbnNsYXRlKCR7ZC5jb2x1bW4udHh9LDApYClcclxuICAgICAgICAgICAgLmNhbGwoZyA9PiB0aGlzLl9hZGRDZWxsKGcsIHN0eWxlLmhlYWRlckJhY2tncm91bmQsIHRoaXMuX2ZpeGVkQ29sdW1ucywgdHJ1ZSwgdHJ1ZSkpXHJcbiAgICAgICAgICAgIC5vbihcImNsaWNrXCIsIChlLCBkKSA9PiB0aGlzLl9zb3J0KGQpKTtcclxuXHJcbiAgICAgICAgdGhpcy5fYWRkUm93cyhcclxuICAgICAgICAgICAgZGF0YUhlYWRlcixcclxuICAgICAgICAgICAgXCJmaXhlZFJvd1wiLFxyXG4gICAgICAgICAgICAoKSA9PiByb3dzLFxyXG4gICAgICAgICAgICAoZCwgaSkgPT4gdGhpcy5fY29sdW1ucy5zbGljZSh0aGlzLl9maXhlZENvbHVtbnMpLm1hcCgoYywgaikgPT4ge1xyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHtcclxuICAgICAgICAgICAgICAgICAgICByb3dJbmRleDogaSxcclxuICAgICAgICAgICAgICAgICAgICBjb2x1bW46IGMsXHJcbiAgICAgICAgICAgICAgICAgICAgdmFsdWU6IHRoaXMuX2RhdGFJc0FycmF5ID8gZFtjLmluZGV4XSA6IGRbYy5uYW1lXVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KSxcclxuICAgICAgICAgICAgKGQsIGkpID0+IGB0cmFuc2xhdGUoMCwkeyhpICsgMSkgKiB0aGlzLl9jZWxsSGVpZ2h0QX0pYCxcclxuICAgICAgICAgICAgZCA9PiBgdHJhbnNsYXRlKCR7ZC5jb2x1bW4udHh9LDApYCxcclxuICAgICAgICAgICAgZyA9PiB0aGlzLl9hZGRDZWxsKGcsIHN0eWxlLmZpeGVkQmFja2dyb3VuZCwgdGhpcy5fZml4ZWRDb2x1bW5zLCBmYWxzZSwgdHJ1ZSlcclxuICAgICAgICApO1xyXG5cclxuICAgICAgICAvLyBhIGZpeGVkIGxpbmUgZm9yIHNlcGVyYXRpbmcgaGVhZGVyIGFuZCBib2R5XHJcbiAgICAgICAgZy5hcHBlbmQoXCJsaW5lXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwic3Ryb2tlXCIsIHN0eWxlLmJvcmRlckNvbG9yKVxyXG4gICAgICAgICAgICAuYXR0cihcIngxXCIsIDApXHJcbiAgICAgICAgICAgIC5hdHRyKFwieTFcIiwgdGhpcy5fY2VsbEhlaWdodEEpXHJcbiAgICAgICAgICAgIC5hdHRyKFwieDJcIiwgdGhpcy5fd2lkdGgpXHJcbiAgICAgICAgICAgIC5hdHRyKFwieTJcIiwgdGhpcy5fY2VsbEhlaWdodEEpO1xyXG5cclxuICAgICAgICB0aGlzLl9oZWFkZXIgPSBoZWFkZXI7XHJcbiAgICAgICAgdGhpcy5fZGF0YUhlYWRlciA9IGRhdGFIZWFkZXI7XHJcbiAgICB9XHJcblxyXG4gICAgX3NvcnQoZCkge1xyXG4gICAgICAgIGNvbnN0IHNvcnRlZCA9IHRoaXMuX3NvcnREYXRhKGQuY29sdW1uKTtcclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3BhZ2luYXRvciAmJiB0aGlzLl9mdWxsRGF0YS5sZW5ndGggPiB0aGlzLl9yb3dzUGVyUGFnZSkge1xyXG4gICAgICAgICAgICBjb25zdCB4ID0gdGhpcy5fZ2V0WCgpLCB5ID0gdGhpcy5fZ2V0WSgpO1xyXG4gICAgICAgICAgICB0aGlzLl9wYWdlRGF0YSgpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZXJlbmRlcigpO1xyXG4gICAgICAgICAgICB0aGlzLl9tb3ZlWCh4KTtcclxuICAgICAgICAgICAgdGhpcy5fbW92ZVkoeSk7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9vbnNvcnQpIHRoaXMuX29uc29ydChkLmNvbHVtbiwgdGhpcy5fcGFnaW5hdG9yICE9PSBudWxsKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGYgPSAyNTAgLyBzb3J0ZWQubGVuZ3RoO1xyXG4gICAgICAgICAgICB0aGlzLl90YWJsZS5zZWxlY3RBbGwoXCIucm93XCIpXHJcbiAgICAgICAgICAgICAgICAudHJhbnNpdGlvbigpXHJcbiAgICAgICAgICAgICAgICAuZHVyYXRpb24oKGQsIGkpID0+IGkgKiBmKVxyXG4gICAgICAgICAgICAgICAgLmVhc2UoZDMuZWFzZUJvdW5jZSlcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGNvbnN0IGkgPSBBcnJheS5pc0FycmF5KGQpICYmIGRbMF0ub3JpZ2luICE9PSB1bmRlZmluZWQgPyBzb3J0ZWQuaW5kZXhPZihkWzBdLm9yaWdpbikgOiBzb3J0ZWQuaW5kZXhPZihkKTtcclxuICAgICAgICAgICAgICAgICAgICByZXR1cm4gYHRyYW5zbGF0ZSgwLCR7aSAqIHRoaXMuX2NlbGxIZWlnaHRBfSlgO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBjb25zdCBjZyA9IHRoaXMuX2hlYWRlci5zZWxlY3RBbGwoXCIuY29sdW1uXCIpO1xyXG4gICAgICAgIGNnLnNlbGVjdChcIi5hc2NcIikuYXR0cihcImZpbGxcIiwgXyA9PiBkLmNvbHVtbiA9PT0gXy5jb2x1bW4gJiYgZC5jb2x1bW4ub3JkZXIgPT09IDEgPyBcIiM3NzdcIiA6IFwiI2JiYlwiKTtcclxuICAgICAgICBjZy5zZWxlY3QoXCIuZGVzY1wiKS5hdHRyKFwiZmlsbFwiLCBfID0+IGQuY29sdW1uID09PSBfLmNvbHVtbiAmJiBkLmNvbHVtbi5vcmRlciA9PT0gMiA/IFwiIzc3N1wiIDogXCIjYmJiXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIF9zb3J0RGF0YShjb2x1bW4pIHtcclxuICAgICAgICAvL3ZhciBzb3J0ZWQgPSBbLi4udGhpcy5fZGF0YV0uc2xpY2UodGhpcy5fZml4ZWRSb3dzKTtcclxuICAgICAgICB2YXIgZml4ZWQsIHNvcnRlZDtcclxuICAgICAgICBpZiAodGhpcy5fcGFnaW5hdG9yKSB7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9maXhlZFJvd3MgPiAwKSB7XHJcbiAgICAgICAgICAgICAgICBmaXhlZCA9IHRoaXMuX2Z1bGxEYXRhLnNsaWNlKDAsIHRoaXMuX2ZpeGVkUm93cyk7XHJcbiAgICAgICAgICAgICAgICBzb3J0ZWQgPSB0aGlzLl9mdWxsRGF0YS5zbGljZSh0aGlzLl9maXhlZFJvd3MpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHNvcnRlZCA9IHRoaXMuX2Z1bGxEYXRhO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgc29ydGVkID0gWy4uLnRoaXMuX2RhdGFdLnNsaWNlKHRoaXMuX2ZpeGVkUm93cyk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl9jb2x1bW5zLnJlc2V0T3JkZXIoY29sdW1uKTtcclxuICAgICAgICBpZiAoY29sdW1uLm9yZGVyID09PSAwKVxyXG4gICAgICAgICAgICBjb2x1bW4ub3JkZXIgPSAxO1xyXG4gICAgICAgIGVsc2UgaWYgKGNvbHVtbi5vcmRlciA9PT0gMSlcclxuICAgICAgICAgICAgY29sdW1uLm9yZGVyID0gMjtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIGNvbHVtbi5vcmRlciA9IDE7XHJcblxyXG4gICAgICAgIGNvbnN0IGluZGV4ID0gdGhpcy5fZGF0YUlzQXJyYXkgPyBjb2x1bW4uaW5kZXggOiBjb2x1bW4ubmFtZTtcclxuXHJcbiAgICAgICAgaWYgKGNvbHVtbi5vcmRlciA9PT0gMCkge1xyXG4gICAgICAgICAgICBzb3J0ZWQuc29ydCgoYSwgYikgPT4gLTEpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChjb2x1bW4uaXNOdW1iZXIpIHtcclxuICAgICAgICAgICAgaWYgKGNvbHVtbi5vcmRlciA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHNvcnRlZC5zb3J0KChhLCBiKSA9PiBhW2luZGV4XSAtIGJbaW5kZXhdKTtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgc29ydGVkLnNvcnQoKGEsIGIpID0+IGJbaW5kZXhdIC0gYVtpbmRleF0pO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgaWYgKGNvbHVtbi5vcmRlciA9PT0gMSlcclxuICAgICAgICAgICAgICAgIHNvcnRlZC5zb3J0KChhLCBiKSA9PiBhW2luZGV4XS5sb2NhbGVDb21wYXJlKGJbaW5kZXhdKSk7XHJcbiAgICAgICAgICAgIGVsc2VcclxuICAgICAgICAgICAgICAgIHNvcnRlZC5zb3J0KChhLCBiKSA9PiBiW2luZGV4XS5sb2NhbGVDb21wYXJlKGFbaW5kZXhdKSk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICBpZiAoZml4ZWQpIHRoaXMuX2Z1bGxEYXRhID0gZml4ZWQuY29uY2F0KHNvcnRlZCk7XHJcblxyXG4gICAgICAgIHJldHVybiBzb3J0ZWQ7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gcm93czogZGF0YSBmdW5jdGlvbiBmb3Igcm93c1xyXG4gICAgLy8gY29sdW1uczogZGF0YSBmdW5jdGlvbiBmb3IgY29sdW1uc1xyXG4gICAgLy8gcnQ6IHJvdyB0cmFuc2xhdGUgZnVuY3Rpb25cclxuICAgIC8vIGN0OiBjb2x1bW4gdHJhbnNsYXRlIGZ1bmN0aW9uXHJcbiAgICAvLyBjZWxsOiBjZWxsIGZ1bmN0aW9uXHJcbiAgICBfYWRkUm93cyhnLCBjbGFzc05hbWUsIHJvd3MsIGNvbHVtbnMsIHJ0LCBjdCwgY2VsbCkge1xyXG4gICAgICAgIHJldHVybiBnLnNlbGVjdEFsbChcIi5cIiArIGNsYXNzTmFtZSlcclxuICAgICAgICAgICAgLmRhdGEocm93cylcclxuICAgICAgICAgICAgLmpvaW4oXCJnXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgY2xhc3NOYW1lKVxyXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBydClcclxuICAgICAgICAgICAgLnNlbGVjdEFsbChcIi5jZWxsXCIpXHJcbiAgICAgICAgICAgIC5kYXRhKGNvbHVtbnMpXHJcbiAgICAgICAgICAgIC5qb2luKFwiZ1wiKVxyXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIFwiY2VsbFwiKVxyXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBjdClcclxuICAgICAgICAgICAgLmNhbGwoY2VsbClcclxuICAgIH1cclxuXHJcbiAgICAvLyBiYXNlOiBudW1iZXIgb2YgZml4ZWQgY2VsbHMgb24gdGhlIHNhbWUgcm93XHJcbiAgICBfYWRkQ2VsbChnLCBmaWxsLCBiYXNlLCBpc0hlYWRlciwgaXNGaXhlZCkge1xyXG4gICAgICAgIGNvbnN0IHN0eWxlID0gdGhpcy5fc3R5bGU7XHJcblxyXG4gICAgICAgIGNvbnN0IHJlY3QgPSBnLmFwcGVuZChcInJlY3RcIilcclxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCBkID0+IGQuY29sdW1uLndpZHRoKVxyXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB0aGlzLl9jZWxsSGVpZ2h0QSlcclxuICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIGQgPT4gdGhpcy5fY2VsbENvbG9yKGQsIGZpbGwsIGlzSGVhZGVyLCBpc0ZpeGVkKSlcclxuICAgICAgICAgICAgLmF0dHIoXCJzdHJva2Utd2lkdGhcIiwgMC4xKVxyXG4gICAgICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBzdHlsZS5ib3JkZXIgPyBzdHlsZS5ib3JkZXJDb2xvciA6IGZpbGwpO1xyXG5cclxuICAgICAgICBpZiAodGhpcy5faGVhdG1hcCAmJiAhKGlzSGVhZGVyIHx8IGlzRml4ZWQpKSByZWN0LmF0dHIoXCJvcGFjaXR5XCIsIDAuNSk7XHJcblxyXG4gICAgICAgIGNvbnN0IHQgPSBnLmFwcGVuZChcInRleHRcIikuYXR0cihcInlcIiwgXCIxZW1cIikuYXR0cihcImR5XCIsIHRoaXMuX2NlbGxQYWRkaW5nVikuYXR0cihcImZpbGxcIiwgc3R5bGUudGV4dENvbG9yKTtcclxuXHJcbiAgICAgICAgaWYgKGlzSGVhZGVyKSB7XHJcbiAgICAgICAgICAgIGlmICghc3R5bGUuYm9yZGVyKVxyXG4gICAgICAgICAgICAgICAgZy5hcHBlbmQoXCJsaW5lXCIpXHJcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ4MVwiLCBkID0+IGQuY29sdW1uLndpZHRoIC0gMSkuYXR0cihcInkxXCIsIDUpXHJcbiAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJ4MlwiLCBkID0+IGQuY29sdW1uLndpZHRoIC0gMSkuYXR0cihcInkyXCIsIHRoaXMuX2NlbGxIZWlnaHRBIC0gNSlcclxuICAgICAgICAgICAgICAgICAgICAuYXR0cihcInN0cm9rZVwiLCBzdHlsZS5ib3JkZXJDb2xvcik7XHJcblxyXG4gICAgICAgICAgICB0aGlzLl9hcnJvdyhnLCBiYXNlLCBcImFzY1wiLCBcIk0gMCA4IEwgMyA0IEwgNiA4XCIpO1xyXG4gICAgICAgICAgICB0aGlzLl9hcnJvdyhnLCBiYXNlLCBcImRlc2NcIiwgXCJNIDAgMTEgTCAzIDE1IEwgNiAxMVwiKTtcclxuXHJcbiAgICAgICAgICAgIC8vIEhlYWRlciBjZWxsXHJcbiAgICAgICAgICAgIHQuYXR0cihcImR4XCIsIHRoaXMuX2NlbGxQYWRkaW5nSClcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwiY2xpcC1wYXRoXCIsIGQgPT4gdGhpcy5fY2xpcFBhdGgoYGhlYWRlckNsaXAke2QuY29sdW1uLmluZGV4fWApKVxyXG4gICAgICAgICAgICAgICAgLnRleHQoZCA9PiBkLmNvbHVtbi5uYW1lKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgIHQuYXR0cihcImNsYXNzXCIsIFwidmFsdWVcIilcclxuICAgICAgICAgICAgICAgIC5hdHRyKFwiZHhcIiwgZCA9PiBkLmNvbHVtbi5pc051bWJlciA/IC10aGlzLl9jZWxsUGFkZGluZ0ggOiB0aGlzLl9jZWxsUGFkZGluZ0gpXHJcbiAgICAgICAgICAgICAgICAuYXR0cihcImNsaXAtcGF0aFwiLCBkID0+IHRoaXMuX2NsaXBQYXRoKGBjZWxsQ2xpcCR7ZC5jb2x1bW4uaW5kZXh9YCkpXHJcbiAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBkID0+IGB0cmFuc2xhdGUoJHtkLmNvbHVtbi5pc051bWJlciA/IGQuY29sdW1uLndpZHRoIDogMH0sMClgKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJ0ZXh0LWFuY2hvclwiLCBkID0+IGQuY29sdW1uLmlzTnVtYmVyID8gXCJlbmRcIiA6IFwic3RhcnRcIilcclxuICAgICAgICAgICAgICAgIC50ZXh0KGQgPT4ge1xyXG4gICAgICAgICAgICAgICAgICAgIGlmIChkLmNvbHVtbi5pc051bWJlciAmJiBkLmNvbHVtbi5mb3JtYXQpXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkMy5mb3JtYXQoZC5jb2x1bW4uZm9ybWF0KShkLnZhbHVlKTtcclxuICAgICAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHJldHVybiBkLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgfSk7XHJcbiAgICAgICAgfVxyXG4gICAgfVxyXG5cclxuICAgIF9jZWxsQ29sb3IoZCwgZmlsbCwgaXNIZWFkZXIsIGlzRml4ZWQpIHtcclxuICAgICAgICBpZiAodGhpcy5faGVhdG1hcCkge1xyXG4gICAgICAgICAgICBpZiAoaXNIZWFkZXIgfHwgaXNGaXhlZCB8fCAhZC5jb2x1bW4uaXNOdW1iZXIpXHJcbiAgICAgICAgICAgICAgICByZXR1cm4gZmlsbDtcclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgcmV0dXJuIHRoaXMuX2hlYXRtYXBDb2xvcihkLnZhbHVlKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICByZXR1cm4gZmlsbDtcclxuICAgIH1cclxuXHJcbiAgICBfYXJyb3coZywgYmFzZSwgbmFtZSwgcGF0aCkge1xyXG4gICAgICAgIGcuYXBwZW5kKFwicGF0aFwiKVxyXG4gICAgICAgICAgICAuYXR0cihcImNsYXNzXCIsIG5hbWUpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiZFwiLCBwYXRoKVxyXG4gICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgXCIjYmJiXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGQgPT4gYHRyYW5zbGF0ZSgke2QuY29sdW1uLndpZHRoIC0gdGhpcy5fY2VsbFBhZGRpbmdIIC0gMTB9LDIpYCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2FkZFNjcm9sbGJhcnMoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGJhci52aXNpYmxlWzFdKSB0aGlzLl9hZGRWU2Nyb2xsKCk7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGJhci52aXNpYmxlWzBdKSB0aGlzLl9hZGRIU2Nyb2xsKCk7XHJcbiAgICB9XHJcblxyXG4gICAgX2FkZFZTY3JvbGwoKSB7XHJcbiAgICAgICAgY29uc3Qgc2IgPSB0aGlzLl9zY3JvbGxiYXIudmVydGljYWwgPSBuZXcgU2Nyb2xsYmFyKHRoaXMuX3N2Zyk7XHJcbiAgICAgICAgc2IucG9zaXRpb24odGhpcy5fbGVmdCArIHRoaXMuX3dpZHRoLCB0aGlzLl90b3AgKyB0aGlzLl9maXhlZEhlaWdodCwgdGhpcy5faGVpZ2h0IC0gdGhpcy5fZml4ZWRIZWlnaHQpXHJcbiAgICAgICAgICAgIC5zbGlkZXJXaWR0aCh0aGlzLl9zbGlkZXJXaWR0aClcclxuICAgICAgICAgICAgLnNsaWRlckxlbmd0aCh0aGlzLl9zbGlkZXJMZW5ndGgpXHJcbiAgICAgICAgICAgIC5vbnNjcm9sbCgoeSwgc3ksIGRlbHRhKSA9PiB0aGlzLl9ib2R5LmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgwLCR7LXN5ICogdGhpcy5feWYgKyB0aGlzLl9maXhlZEhlaWdodH0pYCkpXHJcbiAgICAgICAgICAgIC5hdHRhY2goKTtcclxuICAgIH1cclxuXHJcbiAgICBfYWRkSFNjcm9sbCgpIHtcclxuICAgICAgICBjb25zdCBzYiA9IHRoaXMuX3Njcm9sbGJhci5ob3Jpem9udGFsID0gbmV3IFNjcm9sbGJhcih0aGlzLl9zdmcpO1xyXG4gICAgICAgIHNiLnZlcnRpY2FsKGZhbHNlKVxyXG4gICAgICAgICAgICAucG9zaXRpb24odGhpcy5fbGVmdCArIHRoaXMuX2ZpeGVkV2lkdGgsIHRoaXMuX3RvcCArIHRoaXMuX2hlaWdodCwgdGhpcy5fd2lkdGggLSB0aGlzLl9maXhlZFdpZHRoKVxyXG4gICAgICAgICAgICAuc2xpZGVyV2lkdGgodGhpcy5fc2xpZGVyV2lkdGgpXHJcbiAgICAgICAgICAgIC5zbGlkZXJMZW5ndGgodGhpcy5fc2xpZGVyTGVuZ3RoKVxyXG4gICAgICAgICAgICAub25zY3JvbGwoKHgsIHN4LCBkZWx0YSkgPT4ge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGF0YUFyZWEuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7LXN4ICogdGhpcy5feGYgKyB0aGlzLl9maXhlZFdpZHRofSwwKWApO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fZGF0YUhlYWRlci5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHstc3ggKiB0aGlzLl94Zn0sMClgKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLmF0dGFjaCgpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jYWxjQ29uc3RyYWlucygpIHtcclxuICAgICAgICAvLyBmIGZvciBib3RoIHNjcm9sbGJhcnMgPSAodG90YWwgLSB2aXNpYmxlKSAvICh2aXNpYmxlIC0gc2xpZGVyIGxlbmd0aCkgICAgXHJcbiAgICAgICAgLy8gVmVydGljYWwgc2Nyb2xsYmFyIGNvbnN0cmFpbiAgICAgICAgXHJcbiAgICAgICAgY29uc3QgdGggPSAodGhpcy5fZGF0YS5sZW5ndGggLSB0aGlzLl9maXhlZFJvd3MpICogdGhpcy5fY2VsbEhlaWdodEEsXHJcbiAgICAgICAgICAgIHNoID0gdGhpcy5faGVpZ2h0IC0gdGhpcy5fZml4ZWRIZWlnaHQ7XHJcbiAgICAgICAgdGhpcy5feWYgPSAodGggLSBzaCkgLyAoc2ggLSB0aGlzLl9zbGlkZXJMZW5ndGgpO1xyXG5cclxuICAgICAgICAvLyBIb3Jpem9udGFsIHNjcm9sbGJhciBjb25zdHJhaW5cclxuICAgICAgICBjb25zdCB0dyA9IHRoaXMuX3N1bVdpZHRoKCkgLSB0aGlzLl9zdW1XaWR0aCh0aGlzLl9maXhlZENvbHVtbnMpLFxyXG4gICAgICAgICAgICBzdyA9IHRoaXMuX3dpZHRoIC0gdGhpcy5fc3VtV2lkdGgodGhpcy5fZml4ZWRDb2x1bW5zKTtcclxuICAgICAgICB0aGlzLl94ZiA9ICh0dyAtIHN3KSAvIChzdyAtIHRoaXMuX3NsaWRlckxlbmd0aCk7XHJcblxyXG4gICAgICAgIHRoaXMuX21pblggPSAtKHR3IC0gdGhpcy5fd2lkdGgpO1xyXG4gICAgICAgIHRoaXMuX21pblkgPSAtKCh0aGlzLl9kYXRhLmxlbmd0aCAtIHRoaXMuX2ZpeGVkUm93cykgKiB0aGlzLl9jZWxsSGVpZ2h0QSAtIHRoaXMuX2hlaWdodCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3Njcm9sbChlKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGJhci52ZXJ0aWNhbCkge1xyXG4gICAgICAgICAgICBjb25zdCBkeSA9IGUud2hlZWxEZWx0YVkgPyBlLndoZWVsRGVsdGFZIDogZS53aGVlbERlbHRhID8gZS53aGVlbERlbHRhIDogLTE7XHJcbiAgICAgICAgICAgIGlmIChkeSA9PT0gLTEpIHJldHVybjtcclxuXHJcbiAgICAgICAgICAgIGNvbnN0IGN5ID0gdGhpcy5fZ2V0WSgpO1xyXG4gICAgICAgICAgICB2YXIgeSA9IGN5ICsgZHk7XHJcbiAgICAgICAgICAgIHRoaXMuX21vdmVZKHkpO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX3Njcm9sbGJhci5ob3Jpem9udGFsKSB7XHJcbiAgICAgICAgICAgIGNvbnN0IGR4ID0gZS53aGVlbERlbHRhWDtcclxuICAgICAgICAgICAgaWYgKGR4KSB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBjeCA9IHRoaXMuX2dldFgoKTtcclxuICAgICAgICAgICAgICAgIHZhciB4ID0gY3ggKyBkeDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX21vdmVYKHgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGUucHJldmVudERlZmF1bHQoKTtcclxuICAgIH1cclxuXHJcbiAgICBfZ2V0WCgpIHsgcmV0dXJuICt0aGlzLl9kYXRhQXJlYS5hdHRyKFwidHJhbnNmb3JtXCIpLnNwbGl0KFwiLFwiKVswXS5zdWJzdHJpbmcoMTApOyB9XHJcbiAgICBfZ2V0WSgpIHsgcmV0dXJuICt0aGlzLl9ib2R5LmF0dHIoXCJ0cmFuc2Zvcm1cIikuc3BsaXQoXCIsXCIpWzFdLnJlcGxhY2UoXCIpXCIsIFwiXCIpOyB9XHJcblxyXG4gICAgX21vdmVYKHgpIHtcclxuICAgICAgICBpZiAoeCA+IHRoaXMuX2ZpeGVkV2lkdGgpIHggPSB0aGlzLl9maXhlZFdpZHRoO1xyXG4gICAgICAgIGVsc2UgaWYgKHggPCB0aGlzLl9taW5YKSB4ID0gdGhpcy5fbWluWDtcclxuXHJcbiAgICAgICAgdGhpcy5fZGF0YUFyZWEuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7eH0sMClgKTtcclxuICAgICAgICB0aGlzLl9kYXRhSGVhZGVyLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3ggLSB0aGlzLl9maXhlZFdpZHRofSwwKWApO1xyXG4gICAgICAgIGlmICh0aGlzLl9zY3JvbGxiYXIuaG9yaXpvbnRhbClcclxuICAgICAgICAgICAgdGhpcy5fc2Nyb2xsYmFyLmhvcml6b250YWwubW92ZVNsaWRlcigtKCh4IC0gdGhpcy5fZml4ZWRXaWR0aCkgLyB0aGlzLl94ZikpO1xyXG4gICAgfVxyXG5cclxuICAgIF9tb3ZlWSh5KSB7XHJcbiAgICAgICAgaWYgKHkgPCB0aGlzLl9taW5ZKSB5ID0gdGhpcy5fbWluWTtcclxuICAgICAgICBlbHNlIGlmICh5ID4gdGhpcy5fZml4ZWRIZWlnaHQpIHkgPSB0aGlzLl9maXhlZEhlaWdodDtcclxuXHJcbiAgICAgICAgdGhpcy5fYm9keS5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoMCwke3l9KWApO1xyXG4gICAgICAgIGlmICh0aGlzLl9zY3JvbGxiYXIudmVydGljYWwpXHJcbiAgICAgICAgICAgIHRoaXMuX3Njcm9sbGJhci52ZXJ0aWNhbC5tb3ZlU2xpZGVyKC0oeSAtIHRoaXMuX2ZpeGVkSGVpZ2h0KSAvIHRoaXMuX3lmKTtcclxuICAgIH1cclxufVxyXG4ifSx7Im1ldGhvZE5hbWUiOiJpbnRlcnByZXQiLCJjZWxsTmFtZSI6Im9qcy1jZWxsLTE2IiwiaW5saW5lIjpmYWxzZSwic291cmNlIjoiLy8gaHR0cHM6Ly9naXRodWIuY29tL2FuYWx5emVyMjAwNC9zdmd0YWJsZVxyXG4vLyBDb3B5cmlnaHQgMjAyMCBFcmljIExvXHJcbmNsYXNzIFNjcm9sbGJhciB7XHJcbiAgICBjb25zdHJ1Y3RvcihzdmcpIHtcclxuICAgICAgICB0aGlzLl9zdmcgPSBzdmc7XHJcbiAgICAgICAgdGhpcy5fZyA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fYm94ID0gbnVsbDtcclxuICAgICAgICB0aGlzLl92ZXJ0aWNhbCA9IHRydWU7XHJcbiAgICAgICAgdGhpcy5fYmFyID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9zbGlkZXIgPSBudWxsO1xyXG5cclxuICAgICAgICB0aGlzLl9zbGlkZXJXaWR0aCA9IDEzO1xyXG4gICAgICAgIHRoaXMuX3NsaWRlckxlbmd0aCA9IDUwO1xyXG5cclxuICAgICAgICB0aGlzLl9zbGlkZXJUaW1lciA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fc2xpZGVyVGltZW91dCA9IDMwMDtcclxuICAgICAgICB0aGlzLl9zbGlkZXJTdGVwcyA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuX2dyYWJiaW5nID0gZmFsc2U7XHJcbiAgICAgICAgdGhpcy5fZGVsdGEgPSAwO1xyXG4gICAgICAgIHRoaXMuX2RlbHRhYyA9IDA7XHJcblxyXG4gICAgICAgIHRoaXMuX29uc2Nyb2xsID0gbnVsbDtcclxuICAgICAgICB0aGlzLl9uYW1lc3BhY2UgPSBgZXJpYy5zY3JvbGxiYXIuJHtEYXRlLm5vdygpICogTWF0aC5yYW5kb20oKX1gO1xyXG4gICAgfVxyXG5cclxuICAgIHZlcnRpY2FsKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl92ZXJ0aWNhbCA9IF8sIHRoaXMpIDogdGhpcy5fdmVydGljYWw7XHJcbiAgICB9XHJcblxyXG4gICAgc2xpZGVyV2lkdGgoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX3NsaWRlcldpZHRoID0gXywgdGhpcykgOiB0aGlzLl9zbGlkZXJXaWR0aDtcclxuICAgIH1cclxuXHJcbiAgICBzbGlkZXJMZW5ndGgoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX3NsaWRlckxlbmd0aCA9IF8sIHRoaXMpIDogdGhpcy5fc2xpZGVyTGVuZ3RoO1xyXG4gICAgfVxyXG5cclxuICAgIHBvc2l0aW9uKHgsIHksIGxlbmd0aCkge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX2JveCA9IHsgeCwgeSwgbGVuZ3RoIH0sIHRoaXMpIDogdGhpcy5fYm94O1xyXG4gICAgfVxyXG5cclxuICAgIG9uc2Nyb2xsKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9vbnNjcm9sbCA9IF8sIHRoaXMpIDogdGhpcy5fb25zY3JvbGw7XHJcbiAgICB9XHJcblxyXG4gICAgYXR0YWNoKCkge1xyXG4gICAgICAgIHRoaXMuX3JlbmRlcigpO1xyXG4gICAgICAgIHRoaXMuX2F0dGFjaEV2ZW50cygpO1xyXG4gICAgfVxyXG5cclxuICAgIGRpc3Bvc2UoKSB7XHJcbiAgICAgICAgaWYgKHRoaXMuX2cpIHRoaXMuX2cucmVtb3ZlKCk7XHJcbiAgICAgICAgZDMuc2VsZWN0KFwiYm9keVwiKVxyXG4gICAgICAgICAgICAub24oYG1vdXNlZG93bi4ke3RoaXMuX25hbWVzcGFjZX1gLCBudWxsKVxyXG4gICAgICAgICAgICAub24oYG1vdXNldXAuJHt0aGlzLl9uYW1lc3BhY2V9YCwgbnVsbClcclxuICAgICAgICAgICAgLm9uKGBtb3VzZW1vdmUuJHt0aGlzLl9uYW1lc3BhY2V9YCwgbnVsbCk7XHJcbiAgICB9XHJcblxyXG4gICAgbW92ZVNsaWRlcihwb3MpIHtcclxuICAgICAgICBpZiAocG9zIDwgMClcclxuICAgICAgICAgICAgcG9zID0gMDtcclxuICAgICAgICBlbHNlIGlmIChwb3MgKyB0aGlzLl9zbGlkZXJMZW5ndGggPiB0aGlzLl9ib3gubGVuZ3RoKVxyXG4gICAgICAgICAgICBwb3MgPSB0aGlzLl9ib3gubGVuZ3RoIC0gdGhpcy5fc2xpZGVyTGVuZ3RoO1xyXG5cclxuICAgICAgICB0aGlzLl9zbGlkZXIuYXR0cih0aGlzLl92ZXJ0aWNhbCA/IFwieVwiIDogXCJ4XCIsIHBvcyk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbmRlcigpIHtcclxuICAgICAgICBpZiAodGhpcy5fdmVydGljYWwpXHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclZCYXIoKTtcclxuICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlckhCYXIoKTtcclxuICAgIH1cclxuXHJcbiAgICBfcmVuZGVyVkJhcigpIHtcclxuICAgICAgICBjb25zdCBib3ggPSB0aGlzLl9ib3g7XHJcblxyXG4gICAgICAgIGNvbnN0IGcgPSB0aGlzLl9zdmcuYXBwZW5kKFwiZ1wiKVxyXG4gICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7Ym94Lnh9LCR7Ym94Lnl9KWApO1xyXG5cclxuICAgICAgICB0aGlzLl9iYXIgPSBnLmFwcGVuZChcInJlY3RcIilcclxuICAgICAgICAgICAgLmF0dHIoXCJ3aWR0aFwiLCB0aGlzLl9zbGlkZXJXaWR0aClcclxuICAgICAgICAgICAgLmF0dHIoXCJoZWlnaHRcIiwgYm94Lmxlbmd0aClcclxuICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwiI2VlZVwiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fc2xpZGVyID0gZy5hcHBlbmQoXCJyZWN0XCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwieFwiLCAwKS5hdHRyKFwieVwiLCAwKVxyXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHRoaXMuX3NsaWRlcldpZHRoKVxyXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB0aGlzLl9zbGlkZXJMZW5ndGgpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiZmlsbFwiLCBcIiNjY2NcIik7XHJcblxyXG4gICAgICAgIHRoaXMuX2cgPSBnO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZW5kZXJIQmFyKCkge1xyXG4gICAgICAgIGNvbnN0IGJveCA9IHRoaXMuX2JveDtcclxuXHJcbiAgICAgICAgY29uc3QgZyA9IHRoaXMuX3N2Zy5hcHBlbmQoXCJnXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHtib3gueH0sJHtib3gueX0pYCk7XHJcblxyXG4gICAgICAgIHRoaXMuX2JhciA9IGcuYXBwZW5kKFwicmVjdFwiKVxyXG4gICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIGJveC5sZW5ndGgpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiaGVpZ2h0XCIsIHRoaXMuX3NsaWRlcldpZHRoKVxyXG4gICAgICAgICAgICAuYXR0cihcImZpbGxcIiwgXCIjZWVlXCIpO1xyXG5cclxuICAgICAgICB0aGlzLl9zbGlkZXIgPSBnLmFwcGVuZChcInJlY3RcIilcclxuICAgICAgICAgICAgLmF0dHIoXCJ4XCIsIDApLmF0dHIoXCJ5XCIsIDApXHJcbiAgICAgICAgICAgIC5hdHRyKFwid2lkdGhcIiwgdGhpcy5fc2xpZGVyTGVuZ3RoKVxyXG4gICAgICAgICAgICAuYXR0cihcImhlaWdodFwiLCB0aGlzLl9zbGlkZXJXaWR0aClcclxuICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIFwiI2NjY1wiKTtcclxuXHJcbiAgICAgICAgdGhpcy5fZyA9IGc7XHJcbiAgICB9XHJcblxyXG4gICAgX2F0dGFjaEV2ZW50cyh0Ym94KSB7XHJcbiAgICAgICAgY29uc3QgYm94ID0gdGhpcy5fYm94O1xyXG5cclxuICAgICAgICAvL3RoaXMuX3N2Z1xyXG4gICAgICAgIGQzLnNlbGVjdChcImJvZHlcIilcclxuICAgICAgICAgICAgLm9uKGBtb3VzZWRvd24uJHt0aGlzLl9uYW1lc3BhY2V9YCwgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBpZiAoZS5idXR0b25zID09PSAxKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgcCA9IGQzLnBvaW50ZXIoZSk7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKGUuc3JjRWxlbWVudCA9PT0gdGhpcy5fc2xpZGVyLm5vZGUoKSkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9ncmFiYmluZyA9IHRydWU7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NsaWRlci5hdHRyKFwiZmlsbFwiLCBcIiNhYWFcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl92ZXJ0aWNhbCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fZGVsdGEgPSBwWzFdIC0gK3RoaXMuX3NsaWRlci5hdHRyKFwieVwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbHRhYyA9IHBbMV0gLSArdGhpcy5fc2xpZGVyLmF0dHIoXCJ5XCIpIC0gdGhpcy5fc2xpZGVyTGVuZ3RoIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX2RlbHRhID0gcFswXSAtICt0aGlzLl9zbGlkZXIuYXR0cihcInhcIik7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9kZWx0YWMgPSBwWzBdIC0gK3RoaXMuX3NsaWRlci5hdHRyKFwieFwiKSAtIHRoaXMuX3NsaWRlcldpZHRoIC8gMjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgICAgICAgICBlLnN0b3BQcm9wYWdhdGlvbigpO1xyXG4gICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICBlbHNlIGlmIChlLnNyY0VsZW1lbnQgPT09IHRoaXMuX2Jhci5ub2RlKCkpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgY29uc3QgY2JveCA9IHRoaXMuX2Jhci5ub2RlKCkuZ2V0Qm91bmRpbmdDbGllbnRSZWN0KCk7XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICB2YXIgYSwgYiwgcG9zO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBpZiAodGhpcy5fdmVydGljYWwpIHtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGEgPSBwb3MgPSArdGhpcy5fc2xpZGVyLmF0dHIoXCJ5XCIpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgYiA9IHBbMV0gLSBjYm94Lnk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBhID0gcG9zID0gK3RoaXMuX3NsaWRlci5hdHRyKFwieFwiKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGIgPSBwWzBdIC0gY2JveC54O1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB9XHJcblxyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBpbnRyID0gKGIgLSBhKSAvIDQ7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHN0ZXBzID0gW107XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGZvciAodmFyIGkgPSAwOyBpIDwgMzsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgICAgICBwb3MgKz0gaW50cjtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIHN0ZXBzLnB1c2gocG9zKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgfVxyXG5cclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKGIgKyB0aGlzLl9zbGlkZXJMZW5ndGggPiB0aGlzLl9ib3gubGVuZ3RoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcHMucHVzaCh0aGlzLl9ib3gubGVuZ3RoIC0gdGhpcy5fc2xpZGVyTGVuZ3RoKTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgc3RlcHMucHVzaChiKTtcclxuXHJcbiAgICAgICAgICAgICAgICAgICAgICAgIHRoaXMuX3NsaWRlclN0ZXBzID0gc3RlcHMucmV2ZXJzZSgpO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zbGlkZXJUaW1lb3V0ID0gMjAwO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICB0aGlzLl9zbGlkZXJUaW1lciA9IHNldFRpbWVvdXQoKCkgPT4gdGhpcy5fc2xpZGUoKSwgdGhpcy5fc2xpZGVyVGltZW91dCk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGUuc3RvcFByb3BhZ2F0aW9uKCk7XHJcbiAgICAgICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICB9KVxyXG4gICAgICAgICAgICAub24oYG1vdXNldXAuJHt0aGlzLl9uYW1lc3BhY2V9YCwgKCkgPT4ge1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3NsaWRlclRpbWVyKSBjbGVhclRpbWVvdXQodGhpcy5fc2xpZGVyVGltZXIpO1xyXG4gICAgICAgICAgICAgICAgY29uc3Qgc3RlcHMgPSB0aGlzLl9zbGlkZXJTdGVwcztcclxuICAgICAgICAgICAgICAgIGlmIChzdGVwcyAmJiBzdGVwcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2xpZGVUbyhzdGVwcy5yZXZlcnNlKCkucG9wKCkpO1xyXG4gICAgICAgICAgICAgICAgICAgIHRoaXMuX3NsaWRlclN0ZXBzID0gbnVsbDtcclxuICAgICAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9ncmFiYmluZyA9IGZhbHNlO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fc2xpZGVyLmF0dHIoXCJmaWxsXCIsIFwiI2NjY1wiKTtcclxuICAgICAgICAgICAgfSlcclxuICAgICAgICAgICAgLm9uKGBtb3VzZW1vdmUuJHt0aGlzLl9uYW1lc3BhY2V9YCwgZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBib3ggPSB0aGlzLl9ib3g7XHJcblxyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX2dyYWJiaW5nKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgaWYgKHRoaXMuX3ZlcnRpY2FsKSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHkgPSBkMy5wb2ludGVyKGUpWzFdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzeSA9IHkgLSB0aGlzLl9kZWx0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN5ID49IDAgJiYgc3kgPD0gYm94Lmxlbmd0aCAtIHRoaXMuX3NsaWRlckxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2xpZGVyLmF0dHIoXCJ5XCIsIHN5KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbnNjcm9sbCkgdGhpcy5fb25zY3JvbGwoeSwgc3ksIHRoaXMuX2RlbHRhYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIGNvbnN0IHggPSBkMy5wb2ludGVyKGUpWzBdO1xyXG4gICAgICAgICAgICAgICAgICAgICAgICBjb25zdCBzeCA9IHggLSB0aGlzLl9kZWx0YTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgaWYgKHN4ID49IDAgJiYgc3ggPD0gYm94Lmxlbmd0aCAtIHRoaXMuX3NsaWRlckxlbmd0aCkge1xyXG4gICAgICAgICAgICAgICAgICAgICAgICAgICAgdGhpcy5fc2xpZGVyLmF0dHIoXCJ4XCIsIHN4KTtcclxuICAgICAgICAgICAgICAgICAgICAgICAgICAgIGlmICh0aGlzLl9vbnNjcm9sbCkgdGhpcy5fb25zY3JvbGwoeCwgc3gsIHRoaXMuX2RlbHRhYyk7XHJcbiAgICAgICAgICAgICAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIH0pO1xyXG4gICAgfVxyXG5cclxuICAgIF9zbGlkZVRvKGRlc3QpIHtcclxuICAgICAgICB0aGlzLl9zbGlkZXIuYXR0cih0aGlzLl92ZXJ0aWNhbCA/IFwieVwiIDogXCJ4XCIsIGRlc3QpO1xyXG4gICAgICAgIGlmICh0aGlzLl9vbnNjcm9sbCkgdGhpcy5fb25zY3JvbGwoZGVzdCwgZGVzdCwgMCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3NsaWRlKCkge1xyXG4gICAgICAgIHRoaXMuX3NsaWRlVG8odGhpcy5fc2xpZGVyU3RlcHMucG9wKCkpO1xyXG4gICAgICAgIGlmICh0aGlzLl9zbGlkZXJTdGVwcy5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX3NsaWRlclRpbWVvdXQgLT0gNTA7XHJcbiAgICAgICAgICAgIHRoaXMuX3NsaWRlclRpbWVyID0gc2V0VGltZW91dCgoKSA9PiB0aGlzLl9zbGlkZSgpLCB0aGlzLl9zbGlkZXJUaW1lb3V0KTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICB0aGlzLl9zbGlkZXJUaW1lciA9IG51bGw7XHJcbiAgICB9XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0IiwiY2VsbE5hbWUiOiJvanMtY2VsbC0xNyIsImlubGluZSI6ZmFsc2UsInNvdXJjZSI6Ii8vIGh0dHBzOi8vZ2l0aHViLmNvbS9hbmFseXplcjIwMDQvc3ZndGFibGVcclxuLy8gQ29weXJpZ2h0IDIwMjAgRXJpYyBMb1xyXG5jbGFzcyBQYWdpbmF0b3Ige1xyXG4gICAgY29uc3RydWN0b3IodGFibGUpIHtcclxuICAgICAgICB0aGlzLl90YWJsZSA9IHRhYmxlO1xyXG4gICAgICAgIHRoaXMuX3RhYmxlV2lkdGggPSAwO1xyXG4gICAgICAgIHRoaXMuX3RhYmxlSGVpZ2h0ID0gMDtcclxuXHJcbiAgICAgICAgdGhpcy5fdG9wID0gMDtcclxuICAgICAgICB0aGlzLl9sZWZ0ID0gMDtcclxuICAgICAgICB0aGlzLl9wdyA9IDA7XHJcbiAgICAgICAgdGhpcy5fc3cgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLl9jb250cm9scyA9IHtcclxuICAgICAgICAgICAgZ290b0lucHV0OiBmYWxzZSxcclxuICAgICAgICAgICAgcmVjb3Jkc1BlclBhZ2VTZWxlY3RvcjogdHJ1ZVxyXG4gICAgICAgIH07XHJcbiAgICAgICAgdGhpcy5fb3B0aW9ucyA9IHtcclxuICAgICAgICAgICAgcG9zaXRpb246IFwidG9wXCIsXHJcbiAgICAgICAgICAgIHNlbGVjdG9yOiBcImxlZnRcIixcclxuICAgICAgICAgICAgYnV0dG9uQ29sb3I6IFwiI2FhYVwiXHJcbiAgICAgICAgfVxyXG4gICAgICAgIHRoaXMuX3JlY29yZHNQZXJQYWdlU2VsZWN0aW9ucyA9IFsyNSwgNTAsIDc1XTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVjb3JkQ291bnQgPSAwO1xyXG4gICAgICAgIHRoaXMuX3JlY29yZHNQZXJQYWdlID0gNTA7XHJcbiAgICAgICAgdGhpcy5fY3VycmVudFBhZ2UgPSAxO1xyXG4gICAgICAgIHRoaXMuX3RvdGFsUGFnZXMgPSAwO1xyXG4gICAgICAgIHRoaXMuX2N1cnJGbG9vciA9IDA7XHJcbiAgICAgICAgdGhpcy5fY3VyckNlaWxpbmcgPSAwO1xyXG5cclxuICAgICAgICB0aGlzLl9idXR0b25QYWRkaW5nID0gMTU7XHJcbiAgICAgICAgdGhpcy5fYnV0dG9uU3BhY2luZyA9IDU7XHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyVGFibGUgPSBudWxsO1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdG9yQ2VsbCA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fcGFnaW5hdG9yQ2VsbCA9IG51bGw7XHJcblxyXG4gICAgICAgIHRoaXMuX29uUGFnZU51bWJlckNoYW5nZSA9IG51bGw7XHJcbiAgICAgICAgdGhpcy5fb25SZWNvcmRzUGVyUGFnZUNoYW5nZSA9IG51bGw7XHJcbiAgICB9XHJcblxyXG4gICAgY29udHJvbHMoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX2NvbnRyb2xzID0gXywgdGhpcykgOiB0aGlzLl9jb250cm9scztcclxuICAgIH1cclxuXHJcbiAgICBvcHRpb25zKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9vcHRpb25zID0gXywgdGhpcykgOiB0aGlzLl9vcHRpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIHBvc2l0aW9uKF8pIHtcclxuICAgICAgICByZXR1cm4gYXJndW1lbnRzLmxlbmd0aCA/ICh0aGlzLl9sZWZ0ID0gX1swXSwgdGhpcy5fdG9wID0gX1sxXSwgdGhpcykgOiBbdGhpcy5fbGVmdCwgdGhpcy50b3BdO1xyXG4gICAgfVxyXG5cclxuICAgIGJ1dHRvblBhZGRpbmcoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX2J1dHRvblBhZGRpbmcgPSBfLCB0aGlzKSA6IHRoaXMuX2J1dHRvblBhZGRpbmc7XHJcbiAgICB9XHJcblxyXG4gICAgYnV0dG9uU3BhY2luZyhfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fYnV0dG9uU3BhY2luZyA9IF8sIHRoaXMpIDogdGhpcy5fYnV0dG9uU3BhY2luZztcclxuICAgIH1cclxuXHJcbiAgICByZWNvcmRzUGVyUGFnZVNlbGVjdGlvbnMoXykge1xyXG4gICAgICAgIHJldHVybiBhcmd1bWVudHMubGVuZ3RoID8gKHRoaXMuX3JlY29yZHNQZXJQYWdlU2VsZWN0aW9ucyA9IF8sIHRoaXMpIDogdGhpcy5fcmVjb3Jkc1BlclBhZ2VTZWxlY3Rpb25zO1xyXG4gICAgfVxyXG5cclxuICAgIHJlY29yZHNQZXJQYWdlKF8pIHtcclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZWNvcmRzUGVyUGFnZSA9IF87XHJcbiAgICAgICAgICAgIHRoaXMuX3RvdGFsUGFnZXMgPSBNYXRoLmNlaWwodGhpcy5fcmVjb3JkQ291bnQgLyB0aGlzLl9yZWNvcmRzUGVyUGFnZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRlQ3VycmVudFBhZ2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlY29yZHNQZXJQYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIHJlY29yZENvdW50KF8pIHtcclxuICAgICAgICBpZiAoYXJndW1lbnRzLmxlbmd0aCkge1xyXG4gICAgICAgICAgICB0aGlzLl9yZWNvcmRDb3VudCA9IF87XHJcbiAgICAgICAgICAgIHRoaXMuX3RvdGFsUGFnZXMgPSBNYXRoLmNlaWwodGhpcy5fcmVjb3JkQ291bnQgLyB0aGlzLl9yZWNvcmRzUGVyUGFnZSk7XHJcbiAgICAgICAgICAgIHRoaXMuX3ZhbGlkYXRlQ3VycmVudFBhZ2UoKTtcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXM7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2VcclxuICAgICAgICAgICAgcmV0dXJuIHRoaXMuX3JlY29yZENvdW50O1xyXG4gICAgfVxyXG5cclxuICAgIG9uUGFnZU51bWJlckNoYW5nZShfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fb25QYWdlTnVtYmVyQ2hhbmdlID0gXywgdGhpcykgOiB0aGlzLl9vblBhZ2VOdW1iZXJDaGFuZ2U7XHJcbiAgICB9XHJcblxyXG4gICAgb25SZWNvcmRzUGVyUGFnZUNoYW5nZShfKSB7XHJcbiAgICAgICAgcmV0dXJuIGFyZ3VtZW50cy5sZW5ndGggPyAodGhpcy5fb25SZWNvcmRzUGVyUGFnZUNoYW5nZSA9IF8sIHRoaXMpIDogdGhpcy5fb25SZWNvcmRzUGVyUGFnZUNoYW5nZTtcclxuICAgIH1cclxuXHJcbiAgICBpbml0KHJlY29yZHNQZXJQYWdlLCByZWNvcmRDb3VudCkge1xyXG4gICAgICAgIHRoaXMuX3JlY29yZHNQZXJQYWdlID0gcmVjb3Jkc1BlclBhZ2U7XHJcbiAgICAgICAgdGhpcy5fcmVjb3JkQ291bnQgPSByZWNvcmRDb3VudDtcclxuICAgICAgICB0aGlzLl90b3RhbFBhZ2VzID0gTWF0aC5jZWlsKHRoaXMuX3JlY29yZENvdW50IC8gdGhpcy5fcmVjb3Jkc1BlclBhZ2UpO1xyXG4gICAgICAgIHRoaXMuX3Jlc2V0Qm91bmRhcnkoKTtcclxuICAgICAgICByZXR1cm4gdGhpcztcclxuICAgIH1cclxuXHJcbiAgICByZW5kZXIoKSB7XHJcbiAgICAgICAgdGhpcy5fcHJlcGFyZSgpO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZUNvbnRhaW5lcnMoKTtcclxuICAgICAgICB0aGlzLl9yZW5kZXJQYWdpbmF0b3IoKTtcclxuICAgICAgICBpZiAodGhpcy5fY29udHJvbHMucmVjb3Jkc1BlclBhZ2VTZWxlY3Rvcikge1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJSZWNvcmRzUGVyUGFnZVNlbGVjdG9yKCk7XHJcbiAgICAgICAgfVxyXG5cclxuICAgICAgICB0aGlzLl90YWJsZS5nLmFwcGVuZCgoKSA9PiB0aGlzLl9jb250YWluZXJUYWJsZS5ub2RlKCkpO1xyXG4gICAgICAgIHJldHVybiB0aGlzO1xyXG4gICAgfVxyXG5cclxuICAgIF9wcmVwYXJlKCkge1xyXG4gICAgICAgIGNvbnN0IHMgPSB0aGlzLl90YWJsZS5zaXplKCk7XHJcbiAgICAgICAgdGhpcy5fdGFibGVXaWR0aCA9IHNbMF07XHJcbiAgICAgICAgdGhpcy5fdGFibGVIZWlnaHQgPSBzWzFdO1xyXG4gICAgfVxyXG5cclxuICAgIF9jcmVhdGVDb250YWluZXJzKCkge1xyXG4gICAgICAgIGNvbnN0IGMgPSBkMy5jcmVhdGUoXCJzdmc6Z1wiKTtcclxuICAgICAgICBpZiAodGhpcy5fb3B0aW9ucy5wb3NpdGlvbiA9PT0gXCJ0b3BcIilcclxuICAgICAgICAgICAgYy5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHt0aGlzLl9sZWZ0fSwke3RoaXMuX3RvcH0pYCk7XHJcbiAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICBjLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3RoaXMuX2xlZnR9LCR7dGhpcy5fdG9wfSlgKTtcclxuXHJcbiAgICAgICAgdGhpcy5fY29udGFpbmVyVGFibGUgPSBjO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZVNlbGVjdG9yQ2VsbCgpO1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZVBhZ2luYXRvckNlbGwoKTtcclxuICAgIH1cclxuXHJcbiAgICBfY3JlYXRlU2VsZWN0b3JDZWxsKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9zZWxlY3RvckNlbGwpIHRoaXMuX3NlbGVjdG9yQ2VsbC5yZW1vdmUoKTtcclxuICAgICAgICB0aGlzLl9zZWxlY3RvckNlbGwgPSB0aGlzLl9jb250YWluZXJUYWJsZS5hcHBlbmQoXCJnXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIF9jcmVhdGVQYWdpbmF0b3JDZWxsKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9wYWdpbmF0b3JDZWxsKSB0aGlzLl9wYWdpbmF0b3JDZWxsLnJlbW92ZSgpO1xyXG4gICAgICAgIHRoaXMuX3BhZ2luYXRvckNlbGwgPSB0aGlzLl9jb250YWluZXJUYWJsZS5hcHBlbmQoXCJnXCIpO1xyXG4gICAgfVxyXG5cclxuICAgIF9yZW5kZXJQYWdpbmF0b3IocG51bSkge1xyXG4gICAgICAgIHRoaXMuX2NyZWF0ZVBhZ2luYXRvckNlbGwoKTtcclxuXHJcbiAgICAgICAgLy9pZiAodGhpcy5fY29udHJvbHMuZ290b0lucHV0KSB0aGlzLl9hZGRHb3RvSW5wdXQocG51bSk7XHJcbiAgICAgICAgdmFyIHR4ID0gMDtcclxuICAgICAgICB0eCArPSB0aGlzLl9hZGRQYWdlQnV0dG9uKDEsIHR4KTtcclxuICAgICAgICBpZiAodGhpcy5fY3VyckZsb29yID09PSAxICYmIHRoaXMuX2N1cnJlbnRQYWdlIDwgNSkge1xyXG4gICAgICAgICAgICBmb3IgKGxldCBpID0gMjsgaSA8PSB0aGlzLl9jdXJyQ2VpbGluZzsgaSsrKVxyXG4gICAgICAgICAgICAgICAgdHggKz0gdGhpcy5fYWRkUGFnZUJ1dHRvbihpLCB0eCk7XHJcbiAgICAgICAgfVxyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgZmxvb3I7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl90b3RhbFBhZ2VzID09PSA1KSB7XHJcbiAgICAgICAgICAgICAgICBmbG9vciA9IDI7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZSB7XHJcbiAgICAgICAgICAgICAgICBmbG9vciA9IHRoaXMuX2N1cnJGbG9vcjtcclxuICAgICAgICAgICAgICAgIHR4ICs9IHRoaXMuX2FkZFNlcGVyYXRvcih0eCk7XHJcbiAgICAgICAgICAgIH1cclxuXHJcbiAgICAgICAgICAgIGZvciAobGV0IGkgPSBmbG9vcjsgaSA8PSB0aGlzLl9jdXJyQ2VpbGluZzsgaSsrKSB7XHJcbiAgICAgICAgICAgICAgICB0eCArPSB0aGlzLl9hZGRQYWdlQnV0dG9uKGksIHR4KTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX2N1cnJDZWlsaW5nIDwgdGhpcy5fdG90YWxQYWdlcykge1xyXG4gICAgICAgICAgICB0eCArPSB0aGlzLl9hZGRTZXBlcmF0b3IodHgpO1xyXG4gICAgICAgICAgICB0eCArPSB0aGlzLl9hZGRQYWdlQnV0dG9uKHRoaXMuX3RvdGFsUGFnZXMsIHR4KTtcclxuICAgICAgICB9XHJcblxyXG4gICAgICAgIHRoaXMuX3B3ID0gdHg7XHJcbiAgICAgICAgdGhpcy5fYWRqdXN0KCk7XHJcbiAgICB9XHJcblxyXG4gICAgX3JlbmRlclJlY29yZHNQZXJQYWdlU2VsZWN0b3IoKSB7XHJcbiAgICAgICAgdGhpcy5fY3JlYXRlU2VsZWN0b3JDZWxsKCk7XHJcbiAgICAgICAgdmFyIHR4ID0gMDtcclxuICAgICAgICB0aGlzLl9yZWNvcmRzUGVyUGFnZVNlbGVjdGlvbnMuZm9yRWFjaChkID0+IHtcclxuICAgICAgICAgICAgdHggKz0gdGhpcy5fYWRkU2VsZWN0b3JCdXR0b24oZCwgdHgpO1xyXG4gICAgICAgIH0pO1xyXG4gICAgICAgIHRoaXMuX3N3ID0gdHg7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0b3JDZWxsLmF0dHIoXCJ0cmFuc2Zvcm1cIiwgYHRyYW5zbGF0ZSgke3RoaXMuX3RhYmxlV2lkdGggLSB0eH0sMClgKTtcclxuICAgIH1cclxuXHJcbiAgICBfYWRqdXN0KCkge1xyXG4gICAgICAgIGNvbnN0IGxlZnQgPSB0aGlzLl9zZWxlY3RvckNlbGwgJiYgdGhpcy5fcHcgPiB0aGlzLl90YWJsZVdpZHRoIC0gdGhpcy5fc3cgPyB0aGlzLl9wdyArIDMwIDogdGhpcy5fdGFibGVXaWR0aCAtIHRoaXMuX3N3O1xyXG4gICAgICAgIHRoaXMuX3NlbGVjdG9yQ2VsbC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHtsZWZ0fSwwKWApO1xyXG4gICAgfVxyXG5cclxuICAgIF9hZGRTZWxlY3RvckJ1dHRvbihudW0sIHR4KSB7XHJcbiAgICAgICAgdHggKz0gdGhpcy5fYnV0dG9uU3BhY2luZztcclxuICAgICAgICBjb25zdCBzID0gbnVtLnRvU3RyaW5nKCk7XHJcbiAgICAgICAgY29uc3QgYiA9IHRoaXMuX2dldEJCb3gocyk7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0b3JDZWxsLmFwcGVuZCgoKSA9PlxyXG4gICAgICAgICAgICB0aGlzLl9hZGRCdXR0b24ocywgXCJzZWxCdG5cIiwgdHJ1ZSwgYi53aWR0aCwgYi5oZWlnaHQsIHR4LCBudW0gPT09IHRoaXMuX3JlY29yZHNQZXJQYWdlKVxyXG4gICAgICAgICAgICAgICAgLmF0dHIoXCJudW1cIiwgbnVtKVxyXG4gICAgICAgICAgICAgICAgLm9uKFwiY2xpY2tcIiwgZSA9PiB0aGlzLl9jbGlja1NlbGVjdG9yTnVtYmVyKGUpKVxyXG4gICAgICAgICAgICAgICAgLm5vZGUoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIGIud2lkdGggKyB0aGlzLl9idXR0b25QYWRkaW5nICsgdGhpcy5fYnV0dG9uU3BhY2luZztcclxuICAgIH1cclxuXHJcbiAgICBfYWRkUGFnZUJ1dHRvbihwYWdlTnVtLCB0eCkge1xyXG4gICAgICAgIHR4ICs9IHRoaXMuX2J1dHRvblNwYWNpbmc7XHJcbiAgICAgICAgY29uc3QgcyA9IHBhZ2VOdW0udG9TdHJpbmcoKTtcclxuICAgICAgICBjb25zdCBiID0gdGhpcy5fZ2V0QkJveChzKTtcclxuICAgICAgICB0aGlzLl9wYWdpbmF0b3JDZWxsLmFwcGVuZCgoKSA9PlxyXG4gICAgICAgICAgICB0aGlzLl9hZGRCdXR0b24ocywgXCJwYWdlQnRuXCIsIHRydWUsIGIud2lkdGgsIGIuaGVpZ2h0LCB0eCwgcGFnZU51bSA9PT0gdGhpcy5fY3VycmVudFBhZ2UpXHJcbiAgICAgICAgICAgICAgICAuYXR0cihcInBhZ2VOdW1cIiwgcGFnZU51bSlcclxuICAgICAgICAgICAgICAgIC5vbihcImNsaWNrXCIsIGUgPT4gdGhpcy5fY2xpY2tQYWdlTnVtYmVyKGUpKVxyXG4gICAgICAgICAgICAgICAgLm5vZGUoKVxyXG4gICAgICAgICk7XHJcbiAgICAgICAgcmV0dXJuIGIud2lkdGggKyB0aGlzLl9idXR0b25QYWRkaW5nICsgdGhpcy5fYnV0dG9uU3BhY2luZztcclxuICAgIH1cclxuXHJcbiAgICBfYWRkU2VwZXJhdG9yKHR4KSB7XHJcbiAgICAgICAgdHggKz0gdGhpcy5fYnV0dG9uU3BhY2luZztcclxuICAgICAgICBjb25zdCBzID0gXCIuLi5cIjtcclxuICAgICAgICBjb25zdCBiID0gdGhpcy5fZ2V0QkJveChzKTtcclxuICAgICAgICB0aGlzLl9wYWdpbmF0b3JDZWxsLmFwcGVuZCgoKSA9PiB0aGlzLl9hZGRCdXR0b24ocywgXCJzZXBlcmF0b3JcIiwgZmFsc2UsIGIud2lkdGgsIGIuaGVpZ2h0LCB0eCkubm9kZSgpKTtcclxuICAgICAgICByZXR1cm4gYi53aWR0aCArIHRoaXMuX2J1dHRvblBhZGRpbmcgKyB0aGlzLl9idXR0b25TcGFjaW5nO1xyXG4gICAgfVxyXG5cclxuICAgIF9hZGRCdXR0b24oY2FwdGlvbiwgY2xhc3NOYW1lLCByZWN0LCB3LCBoLCB0eCwgc2VsZWN0ZWQpIHtcclxuICAgICAgICBjb25zdCBydyA9IHcgKyB0aGlzLl9idXR0b25QYWRkaW5nLFxyXG4gICAgICAgICAgICByaCA9IGggKyB0aGlzLl9idXR0b25QYWRkaW5nIC8gMjtcclxuXHJcbiAgICAgICAgcmV0dXJuIGQzLmNyZWF0ZShcInN2ZzpnXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwiY2xhc3NcIiwgY2xhc3NOYW1lKVxyXG4gICAgICAgICAgICAuYXR0cihcInRleHQtYW5jaG9yXCIsIFwibWlkZGxlXCIpXHJcbiAgICAgICAgICAgIC5hdHRyKFwidHJhbnNmb3JtXCIsIGB0cmFuc2xhdGUoJHt0eH0sMClgKVxyXG4gICAgICAgICAgICAuY2FsbChnID0+IHtcclxuICAgICAgICAgICAgICAgIGlmIChyZWN0KVxyXG4gICAgICAgICAgICAgICAgICAgIGcuYXBwZW5kKFwicmVjdFwiKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcInJ4XCIsIDQpLmF0dHIoXCJyeVwiLCA0KVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIndpZHRoXCIsIHJ3KS5hdHRyKFwiaGVpZ2h0XCIsIHJoKVxyXG4gICAgICAgICAgICAgICAgICAgICAgICAuYXR0cihcIm9wYWNpdHlcIiwgc2VsZWN0ZWQgPyAxIDogMClcclxuICAgICAgICAgICAgICAgICAgICAgICAgLmF0dHIoXCJmaWxsXCIsIHRoaXMuX29wdGlvbnMuYnV0dG9uQ29sb3IpXHJcbiAgICAgICAgICAgIH0pXHJcbiAgICAgICAgICAgIC5jYWxsKGcgPT4gZy5hcHBlbmQoXCJ0ZXh0XCIpXHJcbiAgICAgICAgICAgICAgICAuYXR0cihcInRyYW5zZm9ybVwiLCBgdHJhbnNsYXRlKCR7cncgLyAyfSwke3JoIC8gMiArIGggLyA0fSlgKVxyXG4gICAgICAgICAgICAgICAgLnRleHQoY2FwdGlvbikpO1xyXG4gICAgfVxyXG5cclxuICAgIF9nZXRCQm94KHN0cikge1xyXG4gICAgICAgIGNvbnN0IHN2ZyA9IHRoaXMuX3RhYmxlLnN2ZztcclxuICAgICAgICBpZiAoIXN2ZykgcmV0dXJuIHsgd2lkdGg6IDAsIGhlaWdodDogMCB9O1xyXG4gICAgICAgIGVsc2Uge1xyXG4gICAgICAgICAgICB2YXIgdDtcclxuICAgICAgICAgICAgdHJ5IHtcclxuICAgICAgICAgICAgICAgIHQgPSBzdmcuYXBwZW5kKFwidGV4dFwiKS50ZXh0KHN0cik7XHJcbiAgICAgICAgICAgICAgICByZXR1cm4gdC5ub2RlKCkuZ2V0QkJveCgpO1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGZpbmFsbHkge1xyXG4gICAgICAgICAgICAgICAgdC5yZW1vdmUoKTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZ290b1BhZ2UocG51bSkge1xyXG4gICAgICAgIGlmIChwbnVtIDwgMSlcclxuICAgICAgICAgICAgcG51bSA9IDE7XHJcbiAgICAgICAgZWxzZSBpZiAocG51bSA+IHRoaXMuX3RvdGFsUGFnZXMpXHJcbiAgICAgICAgICAgIHBudW0gPSB0aGlzLl90b3RhbFBhZ2VzO1xyXG5cclxuICAgICAgICBpZiAocG51bSA8PSB0aGlzLl90b3RhbFBhZ2VzKSB7XHJcbiAgICAgICAgICAgIGlmIChwbnVtID49IDEgJiYgcG51bSA8PSA0KSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyRmxvb3IgPSAxO1xyXG4gICAgICAgICAgICAgICAgaWYgKHRoaXMuX3RvdGFsUGFnZXMgPD0gNSlcclxuICAgICAgICAgICAgICAgICAgICB0aGlzLl9jdXJyQ2VpbGluZyA9IHRoaXMuX3RvdGFsUGFnZXM7XHJcbiAgICAgICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICAgICAgdGhpcy5fY3VyckNlaWxpbmcgPSA1O1xyXG4gICAgICAgICAgICB9XHJcbiAgICAgICAgICAgIGVsc2UgaWYgKHBudW0gPj0gdGhpcy5fdG90YWxQYWdlcyAtIDQgJiYgcG51bSA8PSB0aGlzLl90b3RhbFBhZ2VzKSB7XHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyRmxvb3IgPSB0aGlzLl90b3RhbFBhZ2VzIC0gNDtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJDZWlsaW5nID0gdGhpcy5fdG90YWxQYWdlcztcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgICAgIHRoaXMuX2N1cnJGbG9vciA9IHBudW0gLSAyO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VyckNlaWxpbmcgPSBwbnVtICsgMTtcclxuICAgICAgICAgICAgfVxyXG4gICAgICAgIH1cclxuICAgICAgICB0aGlzLl9jdXJyZW50UGFnZSA9IHBudW07XHJcbiAgICAgICAgcmV0dXJuIHRoaXMuX2N1cnJlbnRQYWdlO1xyXG4gICAgfVxyXG5cclxuICAgIF9jbGlja1BhZ2VOdW1iZXIoZSkge1xyXG4gICAgICAgIHZhciBidG4gPSBlLmN1cnJlbnRUYXJnZXQ7XHJcbiAgICAgICAgdmFyIHBudW0gPSArYnRuLmF0dHJpYnV0ZXNbXCJwYWdlTnVtXCJdLnZhbHVlO1xyXG5cclxuICAgICAgICB0aGlzLl9jdXJyZW50UGFnZSA9IHBudW07XHJcbiAgICAgICAgaWYgKHBudW0gPT0gdGhpcy5fY3VyckNlaWxpbmcgJiYgcG51bSAhPSB0aGlzLl90b3RhbFBhZ2VzKSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJDZWlsaW5nKys7XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyQ2VpbGluZyArIDIgPj0gdGhpcy5fdG90YWxQYWdlcykge1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VyckNlaWxpbmcgPSB0aGlzLl90b3RhbFBhZ2VzO1xyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VyckZsb29yID0gdGhpcy5fdG90YWxQYWdlcyAtIDQ7XHJcbiAgICAgICAgICAgIH1cclxuICAgICAgICAgICAgZWxzZVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fY3VyckZsb29yID0gdGhpcy5fY3VyckNlaWxpbmcgLSAzO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJQYWdpbmF0b3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocG51bSA9PSB0aGlzLl9jdXJyRmxvb3IpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VyckZsb29yLS07XHJcbiAgICAgICAgICAgIGlmICh0aGlzLl9jdXJyRmxvb3IgPCAzKVxyXG4gICAgICAgICAgICAgICAgdGhpcy5fcmVzZXRCb3VuZGFyeSgpO1xyXG4gICAgICAgICAgICBlbHNlXHJcbiAgICAgICAgICAgICAgICB0aGlzLl9jdXJyQ2VpbGluZyA9IHRoaXMuX2N1cnJGbG9vciArIDM7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclBhZ2luYXRvcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIGlmIChwbnVtID09IDEpIHtcclxuICAgICAgICAgICAgdGhpcy5fcmVzZXRCb3VuZGFyeSgpO1xyXG4gICAgICAgICAgICB0aGlzLl9yZW5kZXJQYWdpbmF0b3IoKTtcclxuICAgICAgICB9XHJcbiAgICAgICAgZWxzZSBpZiAocG51bSA9PSB0aGlzLl90b3RhbFBhZ2VzICYmIHRoaXMuX3RvdGFsUGFnZXMgPiA1KSB7XHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJDZWlsaW5nID0gdGhpcy5fdG90YWxQYWdlcztcclxuICAgICAgICAgICAgdGhpcy5fY3VyckZsb29yID0gdGhpcy5fdG90YWxQYWdlcyAtIDQ7XHJcbiAgICAgICAgICAgIHRoaXMuX3JlbmRlclBhZ2luYXRvcigpO1xyXG4gICAgICAgIH1cclxuICAgICAgICBlbHNlIHtcclxuICAgICAgICAgICAgdGhpcy5fcGFnaW5hdG9yQ2VsbFxyXG4gICAgICAgICAgICAgICAgLnNlbGVjdEFsbChcInJlY3RcIilcclxuICAgICAgICAgICAgICAgIC5ub2RlcygpLmZvckVhY2gobm9kZSA9PiB7XHJcbiAgICAgICAgICAgICAgICAgICAgY29uc3QgbnVtID0gK25vZGUucGFyZW50RWxlbWVudC5hdHRyaWJ1dGVzW1wicGFnZU51bVwiXS52YWx1ZTtcclxuICAgICAgICAgICAgICAgICAgICBub2RlLnNldEF0dHJpYnV0ZShcIm9wYWNpdHlcIiwgbnVtID09PSB0aGlzLl9jdXJyZW50UGFnZSA/IDEgOiAwKTtcclxuICAgICAgICAgICAgICAgIH0pO1xyXG4gICAgICAgIH1cclxuXHJcbiAgICAgICAgaWYgKHRoaXMuX29uUGFnZU51bWJlckNoYW5nZSkge1xyXG4gICAgICAgICAgICB2YXIgciA9IHRoaXMuX2dldFJhbmdlKHBudW0pO1xyXG4gICAgICAgICAgICB0aGlzLl9vblBhZ2VOdW1iZXJDaGFuZ2UocG51bSwgci5iZWdpbiwgci5lbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfY2xpY2tTZWxlY3Rvck51bWJlcihlKSB7XHJcbiAgICAgICAgdmFyIGJ0biA9IGUuY3VycmVudFRhcmdldDtcclxuICAgICAgICB2YXIgbnVtID0gK2J0bi5hdHRyaWJ1dGVzW1wibnVtXCJdLnZhbHVlO1xyXG5cclxuICAgICAgICB0aGlzLnJlY29yZHNQZXJQYWdlKG51bSk7XHJcbiAgICAgICAgdGhpcy5fc2VsZWN0b3JDZWxsXHJcbiAgICAgICAgICAgIC5zZWxlY3RBbGwoXCJyZWN0XCIpXHJcbiAgICAgICAgICAgIC5ub2RlcygpLmZvckVhY2gobm9kZSA9PiB7XHJcbiAgICAgICAgICAgICAgICBjb25zdCBuID0gK25vZGUucGFyZW50RWxlbWVudC5hdHRyaWJ1dGVzW1wibnVtXCJdLnZhbHVlO1xyXG4gICAgICAgICAgICAgICAgbm9kZS5zZXRBdHRyaWJ1dGUoXCJvcGFjaXR5XCIsIG51bSA9PT0gbiA/IDEgOiAwKTtcclxuICAgICAgICAgICAgfSk7XHJcblxyXG4gICAgICAgIHRoaXMuX2dvdG9QYWdlKHRoaXMuX2N1cnJlbnRQYWdlKTtcclxuXHJcbiAgICAgICAgdGhpcy5fcmVuZGVyUGFnaW5hdG9yKCk7XHJcblxyXG4gICAgICAgIGlmICh0aGlzLl9vblJlY29yZHNQZXJQYWdlQ2hhbmdlKSB7XHJcbiAgICAgICAgICAgIHZhciByID0gdGhpcy5fZ2V0UmFuZ2UodGhpcy5fY3VycmVudFBhZ2UpO1xyXG4gICAgICAgICAgICB0aGlzLl9vblJlY29yZHNQZXJQYWdlQ2hhbmdlKHRoaXMuX3JlY29yZHNQZXJQYWdlLCB0aGlzLl9jdXJyZW50UGFnZSwgci5iZWdpbiwgci5lbmQpO1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfZ2V0UmFuZ2UocG51bSkge1xyXG4gICAgICAgIHZhciBiZWdpbiA9IChwbnVtIC0gMSkgKiB0aGlzLl9yZWNvcmRzUGVyUGFnZTtcclxuICAgICAgICB2YXIgZW5kID0gYmVnaW4gKyB0aGlzLl9yZWNvcmRzUGVyUGFnZSAtIDE7XHJcbiAgICAgICAgcmV0dXJuIHsgYmVnaW46IGJlZ2luLCBlbmQ6IGVuZCB9O1xyXG4gICAgfVxyXG5cclxuICAgIF92YWxpZGF0ZUN1cnJlbnRQYWdlKCkge1xyXG4gICAgICAgIGlmICh0aGlzLl9jdXJyZW50UGFnZSA+IHRoaXMuX3RvdGFsUGFnZXMpIHtcclxuICAgICAgICAgICAgdGhpcy5fY3VycmVudFBhZ2UgPSB0aGlzLl90b3RhbFBhZ2VzO1xyXG4gICAgICAgICAgICB0aGlzLl9jdXJyQ2VpbGluZyA9IHRoaXMuX3RvdGFsUGFnZXM7XHJcbiAgICAgICAgICAgIHRoaXMuX2N1cnJGbG9vciA9IHRoaXMuX3RvdGFsUGFnZXMgLSA0O1xyXG4gICAgICAgIH1cclxuICAgIH1cclxuXHJcbiAgICBfcmVzZXRCb3VuZGFyeSgpIHtcclxuICAgICAgICB0aGlzLl9jdXJyRmxvb3IgPSAxO1xyXG4gICAgICAgIHRoaXMuX2N1cnJDZWlsaW5nID0gdGhpcy5fdG90YWxQYWdlcyA8PSA1ID8gdGhpcy5fdG90YWxQYWdlcyA6IDU7XHJcbiAgICB9XHJcbn1cclxuIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwcm9wX2luZCcpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdjaG9yb19pbmQnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgndGlsZXMnKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnaycpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdwcm9wX2luZDInKSJ9LHsibWV0aG9kTmFtZSI6ImludGVycHJldFF1aWV0Iiwic291cmNlIjoic2hpbnlJbnB1dCgnY2hvcm9faW5kMicpIn0seyJtZXRob2ROYW1lIjoiaW50ZXJwcmV0UXVpZXQiLCJzb3VyY2UiOiJzaGlueUlucHV0KCdrMicpIn1dfQ==
</script>
<script type="module">
if (window.location.protocol === "file:") { alert("The OJS runtime does not work with file:// URLs. Please use a web server to view this document."); }
window._ojs.paths.runtimeToDoc = "../..";
window._ojs.paths.runtimeToRoot = "../..";
window._ojs.paths.docToRoot = "";
window._ojs.selfContained = false;
window._ojs.runtime.interpretFromScriptTags();
</script>
<script id="quarto-html-after-body" type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (event) {
  const toggleBodyColorMode = (bsSheetEl) => {
    const mode = bsSheetEl.getAttribute("data-mode");
    const bodyEl = window.document.querySelector("body");
    if (mode === "dark") {
      bodyEl.classList.add("quarto-dark");
      bodyEl.classList.remove("quarto-light");
    } else {
      bodyEl.classList.add("quarto-light");
      bodyEl.classList.remove("quarto-dark");
    }
  }
  const toggleBodyColorPrimary = () => {
    const bsSheetEl = window.document.querySelector("link#quarto-bootstrap");
    if (bsSheetEl) {
      toggleBodyColorMode(bsSheetEl);
    }
  }
  toggleBodyColorPrimary();  
  const icon = "î§‹";
  const anchorJS = new window.AnchorJS();
  anchorJS.options = {
    placement: 'right',
    icon: icon
  };
  anchorJS.add('.anchored');
  const isCodeAnnotation = (el) => {
    for (const clz of el.classList) {
      if (clz.startsWith('code-annotation-')) {                     
        return true;
      }
    }
    return false;
  }
  const onCopySuccess = function(e) {
    // button target
    const button = e.trigger;
    // don't keep focus
    button.blur();
    // flash "checked"
    button.classList.add('code-copy-button-checked');
    var currentTitle = button.getAttribute("title");
    button.setAttribute("title", "Copied!");
    let tooltip;
    if (window.bootstrap) {
      button.setAttribute("data-bs-toggle", "tooltip");
      button.setAttribute("data-bs-placement", "left");
      button.setAttribute("data-bs-title", "Copied!");
      tooltip = new bootstrap.Tooltip(button, 
        { trigger: "manual", 
          customClass: "code-copy-button-tooltip",
          offset: [0, -8]});
      tooltip.show();    
    }
    setTimeout(function() {
      if (tooltip) {
        tooltip.hide();
        button.removeAttribute("data-bs-title");
        button.removeAttribute("data-bs-toggle");
        button.removeAttribute("data-bs-placement");
      }
      button.setAttribute("title", currentTitle);
      button.classList.remove('code-copy-button-checked');
    }, 1000);
    // clear code selection
    e.clearSelection();
  }
  const getTextToCopy = function(trigger) {
      const codeEl = trigger.previousElementSibling.cloneNode(true);
      for (const childEl of codeEl.children) {
        if (isCodeAnnotation(childEl)) {
          childEl.remove();
        }
      }
      return codeEl.innerText;
  }
  const clipboard = new window.ClipboardJS('.code-copy-button:not([data-in-quarto-modal])', {
    text: getTextToCopy
  });
  clipboard.on('success', onCopySuccess);
  if (window.document.getElementById('quarto-embedded-source-code-modal')) {
    // For code content inside modals, clipBoardJS needs to be initialized with a container option
    // TODO: Check when it could be a function (https://github.com/zenorocha/clipboard.js/issues/860)
    const clipboardModal = new window.ClipboardJS('.code-copy-button[data-in-quarto-modal]', {
      text: getTextToCopy,
      container: window.document.getElementById('quarto-embedded-source-code-modal')
    });
    clipboardModal.on('success', onCopySuccess);
  }
    var localhostRegex = new RegExp(/^(?:http|https):\/\/localhost\:?[0-9]*\//);
    var mailtoRegex = new RegExp(/^mailto:/);
      var filterRegex = new RegExp('/' + window.location.host + '/');
    var isInternal = (href) => {
        return filterRegex.test(href) || localhostRegex.test(href) || mailtoRegex.test(href);
    }
    // Inspect non-navigation links and adorn them if external
 	var links = window.document.querySelectorAll('a[href]:not(.nav-link):not(.navbar-brand):not(.toc-action):not(.sidebar-link):not(.sidebar-item-toggle):not(.pagination-link):not(.no-external):not([aria-hidden]):not(.dropdown-item):not(.quarto-navigation-tool):not(.about-link)');
    for (var i=0; i<links.length; i++) {
      const link = links[i];
      if (!isInternal(link.href)) {
        // undo the damage that might have been done by quarto-nav.js in the case of
        // links that we want to consider external
        if (link.dataset.originalHref !== undefined) {
          link.href = link.dataset.originalHref;
        }
      }
    }
  function tippyHover(el, contentFn, onTriggerFn, onUntriggerFn) {
    const config = {
      allowHTML: true,
      maxWidth: 500,
      delay: 100,
      arrow: false,
      appendTo: function(el) {
          return el.parentElement;
      },
      interactive: true,
      interactiveBorder: 10,
      theme: 'quarto',
      placement: 'bottom-start',
    };
    if (contentFn) {
      config.content = contentFn;
    }
    if (onTriggerFn) {
      config.onTrigger = onTriggerFn;
    }
    if (onUntriggerFn) {
      config.onUntrigger = onUntriggerFn;
    }
    window.tippy(el, config); 
  }
  const noterefs = window.document.querySelectorAll('a[role="doc-noteref"]');
  for (var i=0; i<noterefs.length; i++) {
    const ref = noterefs[i];
    tippyHover(ref, function() {
      // use id or data attribute instead here
      let href = ref.getAttribute('data-footnote-href') || ref.getAttribute('href');
      try { href = new URL(href).hash; } catch {}
      const id = href.replace(/^#\/?/, "");
      const note = window.document.getElementById(id);
      if (note) {
        return note.innerHTML;
      } else {
        return "";
      }
    });
  }
  const xrefs = window.document.querySelectorAll('a.quarto-xref');
  const processXRef = (id, note) => {
    // Strip column container classes
    const stripColumnClz = (el) => {
      el.classList.remove("page-full", "page-columns");
      if (el.children) {
        for (const child of el.children) {
          stripColumnClz(child);
        }
      }
    }
    stripColumnClz(note)
    if (id === null || id.startsWith('sec-')) {
      // Special case sections, only their first couple elements
      const container = document.createElement("div");
      if (note.children && note.children.length > 2) {
        container.appendChild(note.children[0].cloneNode(true));
        for (let i = 1; i < note.children.length; i++) {
          const child = note.children[i];
          if (child.tagName === "P" && child.innerText === "") {
            continue;
          } else {
            container.appendChild(child.cloneNode(true));
            break;
          }
        }
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(container);
        }
        return container.innerHTML
      } else {
        if (window.Quarto?.typesetMath) {
          window.Quarto.typesetMath(note);
        }
        return note.innerHTML;
      }
    } else {
      // Remove any anchor links if they are present
      const anchorLink = note.querySelector('a.anchorjs-link');
      if (anchorLink) {
        anchorLink.remove();
      }
      if (window.Quarto?.typesetMath) {
        window.Quarto.typesetMath(note);
      }
      // TODO in 1.5, we should make sure this works without a callout special case
      if (note.classList.contains("callout")) {
        return note.outerHTML;
      } else {
        return note.innerHTML;
      }
    }
  }
  for (var i=0; i<xrefs.length; i++) {
    const xref = xrefs[i];
    tippyHover(xref, undefined, function(instance) {
      instance.disable();
      let url = xref.getAttribute('href');
      let hash = undefined; 
      if (url.startsWith('#')) {
        hash = url;
      } else {
        try { hash = new URL(url).hash; } catch {}
      }
      if (hash) {
        const id = hash.replace(/^#\/?/, "");
        const note = window.document.getElementById(id);
        if (note !== null) {
          try {
            const html = processXRef(id, note.cloneNode(true));
            instance.setContent(html);
          } finally {
            instance.enable();
            instance.show();
          }
        } else {
          // See if we can fetch this
          fetch(url.split('#')[0])
          .then(res => res.text())
          .then(html => {
            const parser = new DOMParser();
            const htmlDoc = parser.parseFromString(html, "text/html");
            const note = htmlDoc.getElementById(id);
            if (note !== null) {
              const html = processXRef(id, note);
              instance.setContent(html);
            } 
          }).finally(() => {
            instance.enable();
            instance.show();
          });
        }
      } else {
        // See if we can fetch a full url (with no hash to target)
        // This is a special case and we should probably do some content thinning / targeting
        fetch(url)
        .then(res => res.text())
        .then(html => {
          const parser = new DOMParser();
          const htmlDoc = parser.parseFromString(html, "text/html");
          const note = htmlDoc.querySelector('main.content');
          if (note !== null) {
            // This should only happen for chapter cross references
            // (since there is no id in the URL)
            // remove the first header
            if (note.children.length > 0 && note.children[0].tagName === "HEADER") {
              note.children[0].remove();
            }
            const html = processXRef(null, note);
            instance.setContent(html);
          } 
        }).finally(() => {
          instance.enable();
          instance.show();
        });
      }
    }, function(instance) {
    });
  }
      let selectedAnnoteEl;
      const selectorForAnnotation = ( cell, annotation) => {
        let cellAttr = 'data-code-cell="' + cell + '"';
        let lineAttr = 'data-code-annotation="' +  annotation + '"';
        const selector = 'span[' + cellAttr + '][' + lineAttr + ']';
        return selector;
      }
      const selectCodeLines = (annoteEl) => {
        const doc = window.document;
        const targetCell = annoteEl.getAttribute("data-target-cell");
        const targetAnnotation = annoteEl.getAttribute("data-target-annotation");
        const annoteSpan = window.document.querySelector(selectorForAnnotation(targetCell, targetAnnotation));
        const lines = annoteSpan.getAttribute("data-code-lines").split(",");
        const lineIds = lines.map((line) => {
          return targetCell + "-" + line;
        })
        let top = null;
        let height = null;
        let parent = null;
        if (lineIds.length > 0) {
            //compute the position of the single el (top and bottom and make a div)
            const el = window.document.getElementById(lineIds[0]);
            top = el.offsetTop;
            height = el.offsetHeight;
            parent = el.parentElement.parentElement;
          if (lineIds.length > 1) {
            const lastEl = window.document.getElementById(lineIds[lineIds.length - 1]);
            const bottom = lastEl.offsetTop + lastEl.offsetHeight;
            height = bottom - top;
          }
          if (top !== null && height !== null && parent !== null) {
            // cook up a div (if necessary) and position it 
            let div = window.document.getElementById("code-annotation-line-highlight");
            if (div === null) {
              div = window.document.createElement("div");
              div.setAttribute("id", "code-annotation-line-highlight");
              div.style.position = 'absolute';
              parent.appendChild(div);
            }
            div.style.top = top - 2 + "px";
            div.style.height = height + 4 + "px";
            div.style.left = 0;
            let gutterDiv = window.document.getElementById("code-annotation-line-highlight-gutter");
            if (gutterDiv === null) {
              gutterDiv = window.document.createElement("div");
              gutterDiv.setAttribute("id", "code-annotation-line-highlight-gutter");
              gutterDiv.style.position = 'absolute';
              const codeCell = window.document.getElementById(targetCell);
              const gutter = codeCell.querySelector('.code-annotation-gutter');
              gutter.appendChild(gutterDiv);
            }
            gutterDiv.style.top = top - 2 + "px";
            gutterDiv.style.height = height + 4 + "px";
          }
          selectedAnnoteEl = annoteEl;
        }
      };
      const unselectCodeLines = () => {
        const elementsIds = ["code-annotation-line-highlight", "code-annotation-line-highlight-gutter"];
        elementsIds.forEach((elId) => {
          const div = window.document.getElementById(elId);
          if (div) {
            div.remove();
          }
        });
        selectedAnnoteEl = undefined;
      };
        // Handle positioning of the toggle
    window.addEventListener(
      "resize",
      throttle(() => {
        elRect = undefined;
        if (selectedAnnoteEl) {
          selectCodeLines(selectedAnnoteEl);
        }
      }, 10)
    );
    function throttle(fn, ms) {
    let throttle = false;
    let timer;
      return (...args) => {
        if(!throttle) { // first call gets through
            fn.apply(this, args);
            throttle = true;
        } else { // all the others get throttled
            if(timer) clearTimeout(timer); // cancel #2
            timer = setTimeout(() => {
              fn.apply(this, args);
              timer = throttle = false;
            }, ms);
        }
      };
    }
      // Attach click handler to the DT
      const annoteDls = window.document.querySelectorAll('dt[data-target-cell]');
      for (const annoteDlNode of annoteDls) {
        annoteDlNode.addEventListener('click', (event) => {
          const clickedEl = event.target;
          if (clickedEl !== selectedAnnoteEl) {
            unselectCodeLines();
            const activeEl = window.document.querySelector('dt[data-target-cell].code-annotation-active');
            if (activeEl) {
              activeEl.classList.remove('code-annotation-active');
            }
            selectCodeLines(clickedEl);
            clickedEl.classList.add('code-annotation-active');
          } else {
            // Unselect the line
            unselectCodeLines();
            clickedEl.classList.remove('code-annotation-active');
          }
        });
      }
  const findCites = (el) => {
    const parentEl = el.parentElement;
    if (parentEl) {
      const cites = parentEl.dataset.cites;
      if (cites) {
        return {
          el,
          cites: cites.split(' ')
        };
      } else {
        return findCites(el.parentElement)
      }
    } else {
      return undefined;
    }
  };
  var bibliorefs = window.document.querySelectorAll('a[role="doc-biblioref"]');
  for (var i=0; i<bibliorefs.length; i++) {
    const ref = bibliorefs[i];
    const citeInfo = findCites(ref);
    if (citeInfo) {
      tippyHover(citeInfo.el, function() {
        var popup = window.document.createElement('div');
        citeInfo.cites.forEach(function(cite) {
          var citeDiv = window.document.createElement('div');
          citeDiv.classList.add('hanging-indent');
          citeDiv.classList.add('csl-entry');
          var biblioDiv = window.document.getElementById('ref-' + cite);
          if (biblioDiv) {
            citeDiv.innerHTML = biblioDiv.innerHTML;
          }
          popup.appendChild(citeDiv);
        });
        return popup.innerHTML;
      });
    }
  }
});
</script>
</div> <!-- /content -->

<script type="application/javascript">
window.document.addEventListener("DOMContentLoaded", function (_event) {
  if (window.bslib.Card) {
    window.bslib.Card.initializeAllCards();
  }
}); 
</script>
  



</body></html>